import{Q as I}from"./QTooltip.e2fb5008.js";import{s as _,B as r,C,D as a,E as e,J as F,K as N,I as o,P as D,aa as A,aW as U,Q as p,R as k,aU as O,aV as R,aZ as J,H as m,aX as H,ap as W,L as X,M as $,O as Z,o as z,S as G}from"./index.787a7a18.js";import{u as ee,b as B,Q as ae,j as M,k as S,l as q,c as L,a as le,m as P}from"./use-dialog-plugin-component.b63599de.js";import{Q as Y,a as x}from"./date.4e4f8697.js";import{api_web as T}from"./axios.e256af8f.js";import{Q as te,a as oe,C as se}from"./ClosePopup.e30e77df.js";const ne=o("div",{class:"text-h6"},"Create Order",-1),ie={style:{border:"1px black solid","border-radius":"10px"}},de=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),ue={class:"row"},re={class:"col"},ce={class:"col q-pl-md"},me={class:"row items-center justify-end"},pe={class:"row"},_e={class:"col"},fe={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},ve=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Detail Items")],-1),Ce={class:"row"},ge={class:"col text-right"},be={__name:"serviceCreateOrder",setup(E){const{dialogRef:w,onDialogHide:v,onDialogOK:g,onDialogCancel:b}=ee(),h=B(),i=_({SRVH_DOCNO:"",SRVH_ISSDT:"",SRVH_CUSCD:""}),d=_([]),y=(l,t,n,f)=>{t(async()=>{f==="cust"&&await Q(l),f==="item"&&await u(l)})},Q=async l=>{loading.value=!0,await T.post("customer/searchAPI",{searchValue:l}).then(t=>{loading.value=!1,listCustomers.value=t.data.data}).catch(()=>{loading.value=!1})},u=async l=>{loading.value=!0,await T.post("item/searchAPI",{searchValue:l}).then(t=>{loading.value=!1,d.value=t.data.data}).catch(()=>{loading.value=!1})},c=()=>{d.value.push({TSRVD_ITMCD:"",TSRVD_LINE:d.value.length+1})},s=l=>{h.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${l+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{d.value.splice(l,1)})};return(l,t)=>(r(),C(Z,{ref_key:"dialogRef",ref:w,onHide:$(v),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[e(F,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(N,null,{default:a(()=>[ne]),_:1}),e(N,{class:"q-pa-sm"},{default:a(()=>[o("fieldset",ie,[de,o("div",ue,[o("div",re,[e(D,{label:"SPK No",readonly:"",dense:"",modelValue:i.value.SRVH_DOCNO,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value.SRVH_DOCNO=n),filled:""},null,8,["modelValue"])]),o("div",ce,[e(D,{filled:"",modelValue:i.value.SRVH_ISSDT,"onUpdate:modelValue":t[2]||(t[2]=n=>i.value.SRVH_ISSDT=n),dense:"",label:"Issue Date",loading:l.loading,onClick:t[3]||(t[3]=n=>l.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:a(()=>[e(A,{name:"event",class:"cursor-pointer"},{default:a(()=>[e(te,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(oe,{modelValue:i.value.SRVH_ISSDT,"onUpdate:modelValue":t[1]||(t[1]=n=>i.value.SRVH_ISSDT=n),mask:"YYYY-MM-DD"},{default:a(()=>[o("div",me,[U(e(p,{label:"Close",color:"primary",flat:""},null,512),[[se]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),o("div",pe,[o("div",_e,[e(D,{label:"Customer Choose",dense:"",modelValue:i.value.SRVH_CUSCD,"onUpdate:modelValue":t[4]||(t[4]=n=>i.value.SRVH_CUSCD=n),filled:""},null,8,["modelValue"])])])]),o("fieldset",fe,[ve,o("div",Ce,[o("div",ge,[e(p,{flat:"",icon:"add",color:"blue",onClick:t[5]||(t[5]=n=>c())})])]),e(ae,{bordered:"",dense:""},{default:a(()=>[d.value.length>0?(r(!0),k(O,{key:0},R(d.value,(n,f)=>(r(),C(M,{key:f,class:"q-my-sm",dense:""},{default:a(()=>[e(S,{avatar:""},{default:a(()=>[e(J,{"text-color":"blue"},{default:a(()=>[m(H(f+1),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:a(()=>[e(q,null,{default:a(()=>[e(L,{dense:"",filled:"",label:"Item Name",modelValue:n.item,"onUpdate:modelValue":V=>n.item=V,"use-input":"","input-debounce":"500",options:d.value,onFilter:t[6]||(t[6]=(V,K,j)=>y(V,K,j,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:l.loading},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),e(S,{side:""},{default:a(()=>[e(p,{icon:"delete",color:"red",flat:"",onClick:V=>s(f)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)):U((r(),C(M,{key:1,class:"q-my-sm",clickable:""},{default:a(()=>[e(S,null,{default:a(()=>[e(q,null,{default:a(()=>[m(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[W]])]),_:1})])]),_:1}),e(X,{align:"right"},{default:a(()=>[e(p,{label:"OK",color:"primary",onClick:t[7]||(t[7]=n=>l.onSubmitData()),disable:l.stateSubmit},null,8,["disable"]),e(p,{flat:"",label:"Cancel",color:"red",onClick:$(b)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const he={class:"q-pa-md"},Ve={class:"row q-pb-md"},Se=o("div",{class:"col"},[o("span",{class:"text-h4"},"Receive Order ")],-1),De={class:"col text-right"},ke={class:"row q-pt-md"},we={class:"col"},Te={__name:"serviceView",setup(E){const w=B(),v=_("SRVH_DOCNO"),g=_(""),b=_([]),h=_([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"SRVH_CUSCD",label:"Cust",field:"SRVH_CUSCD",sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left"}]),i=_(!1);z(()=>{d()});const d=async()=>{i.value=!0,await T.post("service/search",{searchBy:v.value,searchValue:g.value}).then(u=>{i.value=!1,b.value=u.data.data}).catch(u=>{i.value=!1})},y=()=>{w.dialog({component:be}).onOk(async u=>{d()})},Q=u=>{window.open("https://joss.jatpowerindo.co.id/PDF/quotation/"+btoa(u),"_blank").focus()};return(u,c)=>(r(),k("div",he,[o("div",Ve,[Se,o("div",De,[e(p,{icon:"add",color:"blue",onClick:y},{default:a(()=>[e(I,null,{default:a(()=>[m("Create New Order")]),_:1})]),_:1})])]),e(G),o("div",ke,[o("div",we,[e(le,{title:"Created Order",rows:b.value,columns:h.value,"row-key":"name",loading:i.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":a(()=>[e(L,{outlined:"",modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=s=>v.value=s),options:h.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(D,{borderless:"",dense:"",modelValue:g.value,"onUpdate:modelValue":[c[1]||(c[1]=s=>g.value=s),c[2]||(c[2]=s=>u.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:a(()=>[e(A,{name:"search"})]),_:1},8,["modelValue"])]),header:a(s=>[e(Y,{props:s},{default:a(()=>[(r(!0),k(O,null,R(s.cols,l=>(r(),C(P,{key:l.name,props:s},{default:a(()=>[m(H(l.label),1)]),_:2},1032,["props"]))),128)),e(P,{"auto-width":""},{default:a(()=>[m("Action")]),_:1})]),_:2},1032,["props"])]),body:a(s=>[e(Y,{props:s},{default:a(()=>[(r(!0),k(O,null,R(s.cols,l=>(r(),C(x,{key:l.name,props:s},{default:a(()=>[m(H(l.value),1)]),_:2},1032,["props"]))),128)),e(x,{"auto-width":""},{default:a(()=>[e(p,{flat:"",color:"orange",icon:"edit",onClick:l=>u.onClickEdit(s.row.TQUO_QUOCD),dense:""},{default:a(()=>[e(I,null,{default:a(()=>[m("Edit this quotation")]),_:1})]),_:2},1032,["onClick"]),e(p,{flat:"",color:"indigo",icon:"print",onClick:l=>Q(s.row.TQUO_QUOCD),dense:""},{default:a(()=>[e(I,null,{default:a(()=>[m("Print this order")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Te as default};
