import{o as P,s as m,B as _,C as y,D as l,E as e,J as $,K as v,I as n,R as M,Q as f,aY as A,aW as H,H as u,ap as N,aU as Y,aV as B,aZ as K,aX as d,P as E,L as j,M as U,O as J,aa as le,S as ae}from"./index.0d4c2dcb.js";import{u as W,b as F,Q as X,j as x,k as c,l as k,c as te,a as oe}from"./use-dialog-plugin-component.c1586ea7.js";import{d as Z}from"./date.e9635b98.js";import{api_web as z}from"./axios.d9864174.js";import{Q as L}from"./QTooltip.7d7eaafa.js";import{Q as se}from"./QBadge.8edc360b.js";const ne={class:"row"},ie=n("div",{class:"col"},[n("div",{class:"text-h6"},"Update Used Item")],-1),de={key:0,class:"col text-right"},re={__name:"serviceOprItemAdd",props:{mode:String,dataItem:Array},setup(O){const{dialogRef:w,onDialogHide:h,onDialogOK:S,onDialogCancel:p}=W(),D=F(),i=O;P(()=>{i.dataItem.listFixDet&&(s.value=i.dataItem.listFixDet)});const t=m([]),s=m([]),a=m(!1),o=()=>{s.value.push({TSRVD_ID:i.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},b=(C,g,V,T)=>{g(async()=>{T==="item"&&await r(C)})},r=async C=>{a.value=!0,await z.post("item/searchAPITBL",{searchValue:C}).then(g=>{a.value=!1,t.value=g.data.data}).catch(()=>{a.value=!1})},I=()=>{q.dialog({title:"Confirmation",message:"Are you sure want to save this items ?",cancel:!0,persistent:!0}).onOk(async()=>{S(s.value)})},Q=C=>{D.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${C+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{s.value.splice(C,1)})};return(C,g)=>(_(),y(J,{ref_key:"dialogRef",ref:w,onHide:U(h),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(v,null,{default:l(()=>[n("div",ne,[ie,i.mode!=="view"?(_(),M("div",de,[e(f,{icon:"add",outline:"",color:"blue",onClick:o})])):A("",!0)])]),_:1}),e(v,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:l(()=>[e(X,{bordered:""},{default:l(()=>[s.value.length===0?H((_(),y(x,{key:0,class:"q-my-sm",clickable:""},{default:l(()=>[e(c,null,{default:l(()=>[u(" No items added ")]),_:1})]),_:1})),[[N]]):A("",!0),(_(!0),M(Y,null,B(s.value,(V,T)=>H((_(),y(x,{key:T,class:"q-my-sm",clickable:""},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(K,{color:"primary","text-color":"white"},{default:l(()=>[u(d(T+1),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(k,null,{default:l(()=>[e(te,{dense:"",filled:"",label:"Item Name",modelValue:V.TSRVF_ITMCD,"onUpdate:modelValue":R=>V.TSRVF_ITMCD=R,"use-input":"","input-debounce":"500",options:t.value,onFilter:g[0]||(g[0]=(R,G,ee)=>b(R,G,ee,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:a.value,readonly:i.mode==="view"},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"])]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(E,{label:"Price",modelValue:V.TSRVF_PRC,"onUpdate:modelValue":R=>V.TSRVF_PRC=R,filled:"",dense:"",readonly:i.mode==="view"},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024),e(c,{side:""},{default:l(()=>[e(f,{icon:"delete",flat:"",color:"red",onClick:R=>Q(T)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)),[[N]])),128))]),_:1})]),_:1}),e(j,{align:"right"},{default:l(()=>[e(f,{label:"OK",color:"primary",onClick:g[1]||(g[1]=V=>I()),disable:a.value,loading:a.value},null,8,["disable","loading"]),e(f,{flat:"",label:"Cancel",color:"red",onClick:U(p),loading:a.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},ue={class:"text-h6"},ce={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(O){const{dialogRef:w,onDialogHide:h,onDialogOK:S,onDialogCancel:p}=W(),D=F(),i=O,t=m({SRVH_DOCNO:"",SRVH_ISSDT:Z.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),s=m([]);P(async()=>{i.header&&(t.value=i.header,s.value=i.detail)});const a=(o,b="add")=>{D.dialog({component:re,componentProps:{mode:b,dataItem:o}}).onOk(async r=>{s.value[o].listFixDet=r})};return(o,b)=>(_(),y(J,{ref_key:"dialogRef",ref:w,onHide:U(h),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(v,null,{default:l(()=>[n("div",ue,"Update Order "+d(t.value.SRVH_DOCNO),1)]),_:1}),e(v,{class:"q-pa-sm"},{default:l(()=>[e(X,{bordered:""},{default:l(()=>[(_(!0),M(Y,null,B(s.value,(r,I)=>H((_(),y(x,{key:I,class:"q-my-sm",clickable:""},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(K,{color:"primary","text-color":"white"},{default:l(()=>[u(d(r.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(k,null,{default:l(()=>[u(d(r.TSRVD_ITMCD),1)]),_:2},1024),e(k,{caption:"",lines:"1"},{default:l(()=>[u("Item")]),_:1})]),_:2},1024),e(c,null,{default:l(()=>[e(k,null,{default:l(()=>[u(d(r.TSRVD_CUSTRMK),1)]),_:2},1024),e(k,{caption:"",lines:"1"},{default:l(()=>[u("Customer Remarks")]),_:1})]),_:2},1024),e(c,{side:""},{default:l(()=>[e(f,{icon:"construction",color:"green",flat:"",onClick:Q=>a(I,"add")},{default:l(()=>[e(L,null,{default:l(()=>[u("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(c,{side:""},{default:l(()=>[e(f,{icon:"visibility",color:"cyan",flat:"",onClick:Q=>a(I,"view"),disable:!r.listFixDet},{default:l(()=>[e(L,null,{default:l(()=>[u("View Added Item")]),_:1}),e(se,{color:"red",floating:""},{default:l(()=>[u(d(r.listFixDet.length),1)]),_:2},1024)]),_:2},1032,["onClick","disable"])]),_:2},1024)]),_:2},1024)),[[N]])),128))]),_:1})]),_:1}),e(j,{align:"right"},{default:l(()=>[e(f,{label:"OK",color:"primary",onClick:b[0]||(b[0]=r=>o.onSubmitData()),disable:o.loading,loading:o.loading},null,8,["disable","loading"]),e(f,{flat:"",label:"Cancel",color:"red",onClick:U(p),loading:o.loading},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},_e={class:"q-pa-md"},me={class:"row"},fe={class:"col"},pe={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ge={class:"text-h5 text-bold"},ve={class:"text-h6 text-bold"},Se={class:"text-subtitle2"},Ce={class:"text-h6 text-bold"},he=n("div",{class:"text-subtitle2"},"Resolved Items",-1),De={class:"row"},be={class:"col"},Ve=n("div",{class:"col text-right"},null,-1),Oe={__name:"serviceOprView",setup(O){const w=F();m([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:t=>t.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:t=>t.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const h=m([]),S=m(""),p=m(!1);P(()=>{D()});const D=async()=>{p.value=!0,await z.post("servicesOPR/search",{searchBy:"",searchValue:S.value}).then(t=>{p.value=!1,h.value=t.data.data}).catch(t=>{p.value=!1})},i=t=>{const s={SRVH_DOCNO:t.SRVH_DOCNO,SRVH_ISSDT:Z.formatDate(t.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:t.MCUS_CUSCD};let a=[];t.detail.map(o=>{a.push({TSRVD_ITMCD:o.TSRVD_ITMCD,TSRVD_LINE:o.TSRVD_LINE,TSRVD_QTY:o.TSRVD_QTY,TSRVD_CUSTRMK:o.TSRVD_CUSTRMK})}),w.dialog({component:ce,componentProps:{header:s,detail:a}}).onOk(async o=>{D()})};return(t,s)=>(_(),M("div",_e,[n("div",me,[n("div",fe,[e(oe,{grid:"",flat:"",bordered:"","card-container-class":t.cardContainerClass,title:"Outstanding Order",rows:h.value,columns:t.columns,"row-key":"name",filter:S.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":t.rowsPerPageOptions,loading:p.value},{"top-right":l(()=>[e(E,{borderless:"",dense:"",debounce:"300",modelValue:S.value,"onUpdate:modelValue":s[0]||(s[0]=a=>S.value=a),placeholder:"Search"},{append:l(()=>[e(le,{name:"search"})]),_:1},8,["modelValue"])]),item:l(a=>[n("div",pe,[e($,{flat:"",bordered:""},{default:l(()=>[e(v,{class:"text-center bg-secondary text-white"},{default:l(()=>[n("div",ge,d(a.row.SRVH_DOCNO),1)]),_:2},1024),e(ae),e(v,null,{default:l(()=>[n("div",ve,d(a.row.MCUS_CUSNM),1),n("div",Se,d(a.row.SRVH_ISSDT),1)]),_:2},1024),e(v,null,{default:l(()=>[n("div",Ce,d(a.row.resolve.length)+" of "+d(a.row.unresolve.length),1),he]),_:2},1024),e(v,null,{default:l(()=>[n("div",De,[n("div",be,[e(f,{label:"Resolve",color:"primary",outline:"",onClick:o=>i(a.row)},null,8,["onClick"])]),Ve])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{Oe as default};
