import{Q}from"./QTooltip.55590de6.js";import{s as V,o as Se,B as F,C as N,D as i,E as t,L as he,M as ne,I as p,Z as L,W as Ce,Q as q,X,Y as _e,av as Ke,c as Le,aw as Ge,a as O,h as k,ay as We,g as be,aO as Ee,ab as ze,ag as Xe,ah as Ze,aj as Je,bd as el,p as ll,be as tl,w as al,j as ol,bf as nl,aW as il,aV as sl,bg as Ue,am as De,aU as ul,T as Ie,H as $,P as oe,a$ as G,R as fe,S as pe,U as rl,O as ae,V as dl,aX as cl}from"./index.04c3c2e9.js";import{u as re,k as se,t as ml,w as Fe,Q as _l,a as Oe,b as W,c as qe,j as vl,l as xe,x as fl}from"./QTable.8c28e42b.js";import{Q as Ne,a as $e}from"./QTd.00ebf5f1.js";import{d as me}from"./date.8d492542.js";import{api_web as Y}from"./axios.5b6b8c94.js";import{Q as pl,a as gl,C as Sl}from"./ClosePopup.c5865eac.js";import{u as ue,g as hl}from"./use-dialog-plugin-component.dbdaf2c5.js";import{_ as Cl}from"./serviceOprUpdateOrder.57ff399b.js";import"./use-cache.b0833c75.js";import"./QBtnGroup.fe98a371.js";import"./QBadge.fa3a9652.js";import"./serviceOprItemAdd.c46a86e0.js";const bl=p("div",{class:"text-h6"},"Create Item Master",-1),Dl={class:"row"},Tl={class:"col"},Ml={class:"col q-pl-md"},yl={class:"row q-pt-md"},Vl={class:"col"},wl={class:"col q-pl-md"},kl={class:"row q-pt-md"},Rl={class:"col"},Ul={class:"col q-pl-md"},Il={class:"row q-pt-md"},Fl={class:"col"},Ol={__name:"itemCreate",props:{ItemCat:String},setup(a){const{dialogRef:D,onDialogHide:v,onDialogOK:c,onDialogCancel:f}=ue(),h=re(),n=V({MITM_ITMCD:"",MITM_ITMNM:"",MITM_STKUOM:"",MITM_ITMTYPE:1,MITM_BRAND:"",MITM_MODEL:"",MITM_SPEC:"",MITM_ITMCAT:"",MITM_COACD:"",MITM_ITMCAT:""}),C=V(!1),U=V([]),I=V([]),g=a;Se(()=>{w(),n.value.MITM_ITMCAT=g.ItemCat});const b=(e,m,o,_)=>{m(async()=>{await Y.post("item/getListCoasAPI",{search:e}).then(l=>{I.value=l.data})})},x=()=>{h.dialog({title:"Confirmation",message:"Do you want to save this item ?",cancel:!0,persistent:!0}).onOk(async()=>{await Y.post("item",n.value).then(e=>{c(e.data.data.value)})})},w=async()=>{C.value=!0,await Y.get("item/formAPI").then(e=>{C.value=!1,U.value=e.data.uoms,I.value=e.data.coas}).catch(()=>{C.value=!1})};return(e,m)=>(F(),N(_e,{ref_key:"dialogRef",ref:D,onHide:X(v),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:i(()=>[t(he,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:i(()=>[t(ne,null,{default:i(()=>[bl]),_:1}),t(ne,{class:"q-pa-sm"},{default:i(()=>[p("div",Dl,[p("div",Tl,[t(L,{label:"Item Code",dense:"",modelValue:n.value.MITM_ITMCD,"onUpdate:modelValue":m[0]||(m[0]=o=>n.value.MITM_ITMCD=o),filled:""},null,8,["modelValue"])]),p("div",Ml,[t(L,{label:"Item Name",dense:"",modelValue:n.value.MITM_ITMNM,"onUpdate:modelValue":m[1]||(m[1]=o=>n.value.MITM_ITMNM=o),filled:""},null,8,["modelValue"])])]),p("div",yl,[p("div",Vl,[t(se,{dense:"",filled:"",label:"UOM",modelValue:n.value.MITM_STKUOM,"onUpdate:modelValue":m[2]||(m[2]=o=>n.value.MITM_STKUOM=o),options:U.value,behavior:"dialog","option-label":"MUOM_UOMNM","option-value":"MUOM_UOMCD","emit-value":"","map-options":"",loading:C.value},null,8,["modelValue","options","loading"])]),p("div",wl,[t(L,{label:"Item Brand",dense:"",modelValue:n.value.MITM_BRAND,"onUpdate:modelValue":m[3]||(m[3]=o=>n.value.MITM_BRAND=o),filled:""},null,8,["modelValue"])])]),p("div",kl,[p("div",Rl,[t(L,{label:"Item Model",dense:"",modelValue:n.value.MITM_MODEL,"onUpdate:modelValue":m[4]||(m[4]=o=>n.value.MITM_MODEL=o),filled:""},null,8,["modelValue"])]),p("div",Ul,[t(L,{label:"Item Specification",dense:"",modelValue:n.value.MITM_SPEC,"onUpdate:modelValue":m[5]||(m[5]=o=>n.value.MITM_SPEC=o),filled:""},null,8,["modelValue"])])]),p("div",Il,[p("div",Fl,[t(se,{dense:"",filled:"",label:"COA",modelValue:n.value.MITM_COACD,"onUpdate:modelValue":m[6]||(m[6]=o=>n.value.MITM_COACD=o),options:I.value,"use-input":"",behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD",onFilter:m[7]||(m[7]=(o,_,l)=>b(o,_,l)),"emit-value":"","map-options":"",loading:C.value},null,8,["modelValue","options","loading"])])])]),_:1}),t(Ce,{align:"right"},{default:i(()=>[t(q,{label:"OK",color:"primary",onClick:m[8]||(m[8]=o=>x())}),t(q,{flat:"",label:"Cancel",color:"red",onClick:X(f)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},ql=p("div",{class:"text-h6"},"Create New Customer Data",-1),xl={class:"row q-pb-md"},Nl={class:"col"},$l={class:"row q-pb-md"},Al={class:"col"},Pl={class:"col q-pl-md"},Ll={class:"row"},El={class:"col"},zl={__name:"customerView",setup(a){const{dialogRef:D,onDialogHide:v,onDialogOK:c,onDialogCancel:f}=ue(),h=re(),n=V({MCUS_CUSCD:"",MCUS_CUSNM:"",MCUS_CURCD:"IDR",MCUS_TAXREG:"-",MCUS_ADDR1:"",MCUS_TELNO:"",MCUS_PIC_NAME:"-",MCUS_PIC_TELNO:"-",MCUS_TYPE:1,MCUS_GROUP:"SERVICE",MCUS_EMAIL:""}),C=V(!1),U=()=>{h.dialog({title:"Confirmation",message:"Do you want to save this customer ?",cancel:!0,persistent:!0}).onOk(async()=>{C.value=!0,await Y.post("customer",n.value).then(I=>{C.value=!1,c(I.data)}).catch(I=>{C.value=!1})})};return(I,g)=>(F(),N(_e,{ref_key:"dialogRef",ref:D,onHide:X(v),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:i(()=>[t(he,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:i(()=>[t(ne,null,{default:i(()=>[ql]),_:1}),t(ne,{class:"q-pa-sm"},{default:i(()=>[p("div",xl,[p("div",Nl,[t(L,{label:"Customer Name",dense:"",modelValue:n.value.MCUS_CUSNM,"onUpdate:modelValue":g[0]||(g[0]=b=>n.value.MCUS_CUSNM=b),filled:""},null,8,["modelValue"])])]),p("div",$l,[p("div",Al,[t(L,{label:"Customer Email",dense:"",modelValue:n.value.MCUS_EMAIL,"onUpdate:modelValue":g[1]||(g[1]=b=>n.value.MCUS_EMAIL=b),filled:""},null,8,["modelValue"])]),p("div",Pl,[t(L,{label:"Customer Phone",dense:"",modelValue:n.value.MCUS_TELNO,"onUpdate:modelValue":g[2]||(g[2]=b=>n.value.MCUS_TELNO=b),filled:"",mask:"####-####-####"},null,8,["modelValue"])])]),p("div",Ll,[p("div",El,[t(L,{label:"Customer Address",dense:"",modelValue:n.value.MCUS_ADDR1,"onUpdate:modelValue":g[3]||(g[3]=b=>n.value.MCUS_ADDR1=b),filled:"",type:"textarea"},null,8,["modelValue"])])])]),_:1}),t(Ce,{align:"right"},{default:i(()=>[t(q,{label:"OK",color:"primary",onClick:g[4]||(g[4]=b=>U()),loading:C.value},null,8,["loading"]),t(q,{flat:"",label:"Cancel",color:"red",onClick:X(f),loading:C.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Hl={...Ke,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:a=>a>=0&&a<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},ge=50,He=2*ge,Qe=He*Math.PI,Ql=Math.round(Qe*1e3)/1e3;var Bl=Le({name:"QCircularProgress",props:{...Hl,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(a,{slots:D}){const{proxy:{$q:v}}=be(),c=Ge(a),f=O(()=>{const w=(v.lang.rtl===!0?-1:1)*a.angle;return{transform:a.reverse!==(v.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-w}deg)`:`rotate3d(0, 0, 1, ${w-90}deg)`}}),h=O(()=>a.instantFeedback!==!0&&a.indeterminate!==!0?{transition:`stroke-dashoffset ${a.animationSpeed}ms ease 0s, stroke ${a.animationSpeed}ms ease`}:""),n=O(()=>He/(1-a.thickness/2)),C=O(()=>`${n.value/2} ${n.value/2} ${n.value} ${n.value}`),U=O(()=>ml(a.value,a.min,a.max)),I=O(()=>a.max-a.min),g=O(()=>a.thickness/2*n.value),b=O(()=>{const w=(a.max-U.value)/I.value,e=a.rounded===!0&&U.value<a.max&&w<.25?g.value/2*(1-w/.25):0;return Qe*w+e});function x({thickness:w,offset:e,color:m,cls:o,rounded:_}){return k("circle",{class:"q-circular-progress__"+o+(m!==void 0?` text-${m}`:""),style:h.value,fill:"transparent",stroke:"currentColor","stroke-width":w,"stroke-dasharray":Ql,"stroke-dashoffset":e,"stroke-linecap":_,cx:n.value,cy:n.value,r:ge})}return()=>{const w=[];a.centerColor!==void 0&&a.centerColor!=="transparent"&&w.push(k("circle",{class:`q-circular-progress__center text-${a.centerColor}`,fill:"currentColor",r:ge-g.value/2,cx:n.value,cy:n.value})),a.trackColor!==void 0&&a.trackColor!=="transparent"&&w.push(x({cls:"track",thickness:g.value,offset:0,color:a.trackColor})),w.push(x({cls:"circle",thickness:g.value,offset:b.value,color:a.color,rounded:a.rounded===!0?"round":void 0}));const e=[k("svg",{class:"q-circular-progress__svg",style:f.value,viewBox:C.value,"aria-hidden":"true"},w)];return a.showValue===!0&&e.push(k("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:a.fontSize}},D.default!==void 0?D.default():[k("div",U.value)])),k("div",{class:`q-circular-progress q-circular-progress--${a.indeterminate===!0?"in":""}determinate`,style:c.value,role:"progressbar","aria-valuemin":a.min,"aria-valuemax":a.max,"aria-valuenow":a.indeterminate===!0?void 0:U.value},We(D.internal,e))}}});function te(a,D,v,c){const f=[];return a.forEach(h=>{c(h)===!0?f.push(h):D.push({failedPropValidation:v,file:h})}),f}function ce(a){a&&a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),ze(a)}const Yl={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},jl=["rejected"];function Kl({editable:a,dnd:D,getFileInput:v,addFilesToQueue:c}){const{props:f,emit:h,proxy:n}=be(),C=V(null),U=O(()=>f.accept!==void 0?f.accept.split(",").map(l=>(l=l.trim(),l==="*"?"*/":(l.endsWith("/*")&&(l=l.slice(0,l.length-1)),l.toUpperCase()))):null),I=O(()=>parseInt(f.maxFiles,10)),g=O(()=>parseInt(f.maxTotalSize,10));function b(l){if(a.value)if(l!==Object(l)&&(l={target:null}),l.target!==null&&l.target.matches('input[type="file"]')===!0)l.clientX===0&&l.clientY===0&&Ee(l);else{const s=v();s&&s!==l.target&&s.click(l)}}function x(l){a.value&&l&&c(null,l)}function w(l,s,E,z){let r=Array.from(s||l.target.files);const d=[],T=()=>{d.length!==0&&h("rejected",d)};if(f.accept!==void 0&&U.value.indexOf("*/")===-1&&(r=te(r,d,"accept",S=>U.value.some(M=>S.type.toUpperCase().startsWith(M)||S.name.toUpperCase().endsWith(M))),r.length===0))return T();if(f.maxFileSize!==void 0){const S=parseInt(f.maxFileSize,10);if(r=te(r,d,"max-file-size",M=>M.size<=S),r.length===0)return T()}if(f.multiple!==!0&&r.length!==0&&(r=[r[0]]),r.forEach(S=>{S.__key=S.webkitRelativePath+S.lastModified+S.name+S.size}),z===!0){const S=E.map(M=>M.__key);r=te(r,d,"duplicate",M=>S.includes(M.__key)===!1)}if(r.length===0)return T();if(f.maxTotalSize!==void 0){let S=z===!0?E.reduce((M,H)=>M+H.size,0):0;if(r=te(r,d,"max-total-size",M=>(S+=M.size,S<=g.value)),r.length===0)return T()}if(typeof f.filter=="function"){const S=f.filter(r);r=te(r,d,"filter",M=>S.includes(M))}if(f.maxFiles!==void 0){let S=z===!0?E.length:0;if(r=te(r,d,"max-files",()=>(S++,S<=I.value)),r.length===0)return T()}if(T(),r.length!==0)return r}function e(l){ce(l),D.value!==!0&&(D.value=!0)}function m(l){ze(l),(l.relatedTarget!==null||Xe.is.safari!==!0?l.relatedTarget!==C.value:document.elementsFromPoint(l.clientX,l.clientY).includes(C.value)===!1)===!0&&(D.value=!1)}function o(l){ce(l);const s=l.dataTransfer.files;s.length!==0&&c(null,s),D.value=!1}function _(l){if(D.value===!0)return k("div",{ref:C,class:`q-${l}__dnd absolute-full`,onDragenter:ce,onDragover:ce,onDragleave:m,onDrop:o})}return Object.assign(n,{pickFiles:b,addFiles:x}),{pickFiles:b,addFiles:x,onDragover:e,onDragleave:m,processFiles:w,getDndNode:_,maxFilesNumber:I,maxTotalSizeNumber:g}}function Ae(a){return(a*100).toFixed(2)+"%"}const Gl={...Ze,...Yl,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Be=[...jl,"start","finish","added","removed"];function Wl(a,D){const v=be(),{props:c,slots:f,emit:h,proxy:n}=v,{$q:C}=n,U=Je(c,C);function I(u,R,A){if(u.__status=R,R==="idle"){u.__uploaded=0,u.__progress=0,u.__sizeLabel=Fe(u.size),u.__progressLabel="0.00%";return}if(R==="failed"){n.$forceUpdate();return}u.__uploaded=R==="uploaded"?u.size:A,u.__progress=R==="uploaded"?1:Math.min(.9999,u.__uploaded/u.size),u.__progressLabel=Ae(u.__progress),n.$forceUpdate()}const g=O(()=>c.disable!==!0&&c.readonly!==!0),b=V(!1),x=V(null),w=V(null),e={files:V([]),queuedFiles:V([]),uploadedFiles:V([]),uploadedSize:V(0),updateFileStatus:I,isAlive:()=>el(v)===!1},{pickFiles:m,addFiles:o,onDragover:_,onDragleave:l,processFiles:s,getDndNode:E,maxFilesNumber:z,maxTotalSizeNumber:r}=Kl({editable:g,dnd:b,getFileInput:ye,addFilesToQueue:Ve});Object.assign(e,a({props:c,slots:f,emit:h,helpers:e,exposeApi:u=>{Object.assign(e,u)}})),e.isBusy===void 0&&(e.isBusy=V(!1));const d=V(0),T=O(()=>d.value===0?0:e.uploadedSize.value/d.value),S=O(()=>Ae(T.value)),M=O(()=>Fe(d.value)),H=O(()=>g.value===!0&&e.isUploading.value!==!0&&(c.multiple===!0||e.queuedFiles.value.length===0)&&(c.maxFiles===void 0||e.files.value.length<z.value)&&(c.maxTotalSize===void 0||d.value<r.value)),y=O(()=>g.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);ll(tl,ke);const Z=O(()=>"q-uploader column no-wrap"+(U.value===!0?" q-uploader--dark q-dark":"")+(c.bordered===!0?" q-uploader--bordered":"")+(c.square===!0?" q-uploader--square no-border-radius":"")+(c.flat===!0?" q-uploader--flat no-shadow":"")+(c.disable===!0?" disabled q-uploader--disable":"")+(b.value===!0?" q-uploader--dnd":"")),J=O(()=>"q-uploader__header"+(c.color!==void 0?` bg-${c.color}`:"")+(c.textColor!==void 0?` text-${c.textColor}`:""));al(e.isUploading,(u,R)=>{R===!1&&u===!0?h("start"):R===!0&&u===!1&&h("finish")});function ee(){c.disable===!1&&(e.abort(),e.uploadedSize.value=0,d.value=0,Me(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function B(){c.disable===!1&&Te(["uploaded"],()=>{e.uploadedFiles.value=[]})}function de(){Te(["idle","failed"],({size:u})=>{d.value-=u,e.queuedFiles.value=[]})}function Te(u,R){if(c.disable===!0)return;const A={files:[],size:0},j=e.files.value.filter(P=>u.indexOf(P.__status)===-1?!0:(A.size+=P.size,A.files.push(P),P.__img!==void 0&&window.URL.revokeObjectURL(P.__img.src),!1));A.files.length!==0&&(e.files.value=j,R(A),h("removed",A.files))}function ve(u){c.disable||(u.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(R=>R.__key!==u.__key):u.__status==="uploading"?u.__abort():d.value-=u.size,e.files.value=e.files.value.filter(R=>R.__key!==u.__key?!0:(R.__img!==void 0&&window.URL.revokeObjectURL(R.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(R=>R.__key!==u.__key),h("removed",[u]))}function Me(){e.files.value.forEach(u=>{u.__img!==void 0&&window.URL.revokeObjectURL(u.__img.src)})}function ye(){return w.value||x.value.getElementsByClassName("q-uploader__input")[0]}function Ve(u,R){const A=s(u,R,e.files.value,!0),j=ye();j!=null&&(j.value=""),A!==void 0&&(A.forEach(P=>{if(e.updateFileStatus(P,"idle"),d.value+=P.size,c.noThumbnails!==!0&&P.type.toUpperCase().startsWith("IMAGE")){const Re=new Image;Re.src=window.URL.createObjectURL(P),P.__img=Re}}),e.files.value=e.files.value.concat(A),e.queuedFiles.value=e.queuedFiles.value.concat(A),h("added",A),c.autoUpload===!0&&e.upload())}function we(){y.value===!0&&e.upload()}function ie(u,R,A){if(u===!0){const j={type:"a",key:R,icon:C.iconSet.uploader[R],flat:!0,dense:!0};let P;return R==="add"?(j.onClick=m,P=ke):j.onClick=A,k(q,j,P)}}function ke(){return k("input",{ref:w,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:c.accept,multiple:c.multiple===!0?"multiple":void 0,capture:c.capture,onMousedown:Ee,onClick:m,onChange:Ve})}function Ye(){return f.header!==void 0?f.header(le):[k("div",{class:"q-uploader__header-content column"},[k("div",{class:"flex flex-center no-wrap q-gutter-xs"},[ie(e.queuedFiles.value.length!==0,"removeQueue",de),ie(e.uploadedFiles.value.length!==0,"removeUploaded",B),e.isUploading.value===!0?k(Ue,{class:"q-uploader__spinner"}):null,k("div",{class:"col column justify-center"},[c.label!==void 0?k("div",{class:"q-uploader__title"},[c.label]):null,k("div",{class:"q-uploader__subtitle"},[M.value+" / "+S.value])]),ie(H.value,"add"),ie(c.hideUploadBtn===!1&&y.value===!0,"upload",e.upload),ie(e.isUploading.value,"clear",e.abort)])])]}function je(){return f.list!==void 0?f.list(le):e.files.value.map(u=>k("div",{key:u.__key,class:"q-uploader__file relative-position"+(c.noThumbnails!==!0&&u.__img!==void 0?" q-uploader__file--img":"")+(u.__status==="failed"?" q-uploader__file--failed":u.__status==="uploaded"?" q-uploader__file--uploaded":""),style:c.noThumbnails!==!0&&u.__img!==void 0?{backgroundImage:'url("'+u.__img.src+'")'}:null},[k("div",{class:"q-uploader__file-header row flex-center no-wrap"},[u.__status==="failed"?k(De,{class:"q-uploader__file-status",name:C.iconSet.type.negative,color:"negative"}):null,k("div",{class:"q-uploader__file-header-content col"},[k("div",{class:"q-uploader__title"},[u.name]),k("div",{class:"q-uploader__subtitle row items-center no-wrap"},[u.__sizeLabel+" / "+u.__progressLabel])]),u.__status==="uploading"?k(Bl,{value:u.__progress,min:0,max:1,indeterminate:u.__progress===0}):k(q,{round:!0,dense:!0,flat:!0,icon:C.iconSet.uploader[u.__status==="uploaded"?"done":"clear"],onClick:()=>{ve(u)}})])]))}ol(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&Me()});const le={};for(const u in e)nl(e[u])===!0?il(le,u,()=>e[u].value):le[u]=e[u];return Object.assign(le,{upload:we,reset:ee,removeUploadedFiles:B,removeQueuedFiles:de,removeFile:ve,pickFiles:m,addFiles:o}),sl(le,{canAddFiles:()=>H.value,canUpload:()=>y.value,uploadSizeLabel:()=>M.value,uploadProgressLabel:()=>S.value}),D({...e,upload:we,reset:ee,removeUploadedFiles:B,removeQueuedFiles:de,removeFile:ve,pickFiles:m,addFiles:o,canAddFiles:H,canUpload:y,uploadSizeLabel:M,uploadProgressLabel:S}),()=>{const u=[k("div",{class:J.value},Ye()),k("div",{class:"q-uploader__list scroll"},je()),E("uploader")];e.isBusy.value===!0&&u.push(k("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[k(Ue)]));const R={ref:x,class:Z.value};return H.value===!0&&Object.assign(R,{onDragover:_,onDragleave:l}),k("div",R,u)}}const Xl=hl(Be);var Zl=({name:a,props:D,emits:v,injectPlugin:c})=>Le({name:a,props:{...Gl,...D},emits:ul(v)===!0?{...Xl,...v}:[...Be,...v],setup(f,{expose:h}){return Wl(c,h)}});function K(a){return typeof a=="function"?a:()=>a}const Jl={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>a=>a.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},et=["factoryFailed","uploaded","failed","uploading"];function lt({props:a,emit:D,helpers:v}){const c=V([]),f=V([]),h=V(0),n=O(()=>({url:K(a.url),method:K(a.method),headers:K(a.headers),formFields:K(a.formFields),fieldName:K(a.fieldName),withCredentials:K(a.withCredentials),sendRaw:K(a.sendRaw),batch:K(a.batch)})),C=O(()=>h.value>0),U=O(()=>f.value.length!==0);let I;function g(){c.value.forEach(e=>{e.abort()}),f.value.length!==0&&(I=!0)}function b(){const e=v.queuedFiles.value.slice(0);v.queuedFiles.value=[],n.value.batch(e)?x(e):e.forEach(m=>{x([m])})}function x(e){if(h.value++,typeof a.factory!="function"){w(e,{});return}const m=a.factory(e);if(!m)D("factoryFailed",new Error("QUploader: factory() does not return properly"),e),h.value--;else if(typeof m.catch=="function"&&typeof m.then=="function"){f.value.push(m);const o=_=>{v.isAlive()===!0&&(f.value=f.value.filter(l=>l!==m),f.value.length===0&&(I=!1),v.queuedFiles.value=v.queuedFiles.value.concat(e),e.forEach(l=>{v.updateFileStatus(l,"failed")}),D("factoryFailed",_,e),h.value--)};m.then(_=>{I===!0?o(new Error("Aborted")):v.isAlive()===!0&&(f.value=f.value.filter(l=>l!==m),w(e,_))}).catch(o)}else w(e,m||{})}function w(e,m){const o=new FormData,_=new XMLHttpRequest,l=(y,Z)=>m[y]!==void 0?K(m[y])(Z):n.value[y](Z),s=l("url",e);if(!s){console.error("q-uploader: invalid or no URL specified"),h.value--;return}const E=l("formFields",e);E!==void 0&&E.forEach(y=>{o.append(y.name,y.value)});let z=0,r=0,d=0,T=0,S;_.upload.addEventListener("progress",y=>{if(S===!0)return;const Z=Math.min(T,y.loaded);v.uploadedSize.value+=Z-d,d=Z;let J=d-r;for(let ee=z;J>0&&ee<e.length;ee++){const B=e[ee];if(J>B.size)J-=B.size,z++,r+=B.size,v.updateFileStatus(B,"uploading",B.size);else{v.updateFileStatus(B,"uploading",J);return}}},!1),_.onreadystatechange=()=>{_.readyState<4||(_.status&&_.status<400?(v.uploadedFiles.value=v.uploadedFiles.value.concat(e),e.forEach(y=>{v.updateFileStatus(y,"uploaded")}),D("uploaded",{files:e,xhr:_})):(S=!0,v.uploadedSize.value-=d,v.queuedFiles.value=v.queuedFiles.value.concat(e),e.forEach(y=>{v.updateFileStatus(y,"failed")}),D("failed",{files:e,xhr:_})),h.value--,c.value=c.value.filter(y=>y!==_))},_.open(l("method",e),s),l("withCredentials",e)===!0&&(_.withCredentials=!0);const M=l("headers",e);M!==void 0&&M.forEach(y=>{_.setRequestHeader(y.name,y.value)});const H=l("sendRaw",e);e.forEach(y=>{v.updateFileStatus(y,"uploading",0),H!==!0&&o.append(l("fieldName",y),y,y.name),y.xhr=_,y.__abort=()=>{_.abort()},T+=y.size}),D("uploading",{files:e,xhr:_}),c.value.push(_),H===!0?_.send(new Blob(e)):_.send(o)}return{isUploading:C,isBusy:U,abort:g,upload:b}}var tt={name:"QUploader",props:Jl,emits:et,injectPlugin:lt},at=Zl(tt);const ot={class:"bg-white"},nt={class:"row",style:{height:"50vh"}},it={class:"col"},st={__name:"uploadPhoto",emits:[...ue.emits],setup(a){re(),V("");const{dialogRef:D,onDialogHide:v,onDialogOK:c,onDialogCancel:f}=ue();return(h,n)=>(F(),N(_e,{ref_key:"dialogRef",ref:D,onHide:X(v)},{default:i(()=>[p("div",ot,[p("div",nt,[p("div",it,[t(at,{class:"full-height",url:X(c),label:"Upload Photo",color:"amber","text-color":"black",accept:"image/*",style:{"min-width":"500px"},"max-files":1,"auto-upload":"","send-raw":""},null,8,["url"])])])])]),_:1},8,["onHide"]))}},ut=p("div",{class:"text-h6"},"Create Order",-1),rt={style:{border:"1px black solid","border-radius":"10px"}},dt=p("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[p("b",null,"Header")],-1),ct={class:"row"},mt={class:"col"},_t={class:"col q-pl-md"},vt={class:"row items-center justify-end"},ft={class:"row"},pt={class:"col"},gt={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},St=p("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[p("b",null,"Detail Items")],-1),ht={key:0,class:"row q-pb-sm"},Ct={class:"col text-right"},Pe={__name:"serviceCreateOrder",props:{header:Array,detail:Array,mode:String},setup(a){const{dialogRef:D,onDialogHide:v,onDialogOK:c,onDialogCancel:f}=ue(),h=re(),n=a;Se(async()=>{n.header&&(await w(),await e(),C.value=n.header,g.value=n.detail)});const C=V({SRVH_DOCNO:"",SRVH_ISSDT:me.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),U=V([]),I=V([]),g=V([]),b=V(!1),x=(r,d,T,S)=>{d(async()=>{S==="cust"&&await w(r),S==="item"&&await e(r)})},w=async r=>{b.value=!0,await Y.post("customer/searchAPI",{searchValue:r}).then(d=>{b.value=!1,I.value=d.data.data}).catch(()=>{b.value=!1})},e=async r=>{b.value=!0,await Y.post("item/searchAPI",{searchValue:r}).then(d=>{b.value=!1,U.value=d.data.data}).catch(()=>{b.value=!1})},m=()=>{g.value.push({TSRVD_ITMCD:"",TSRVD_LINE:g.value.length+1,TSRVD_QTY:1,TSRVD_CUSTRMK:""})},o=r=>{h.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${r+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{g.value.splice(r,1)})},_=r=>{h.dialog({component:Ol,componentProps:{ItemCat:"SERVICE_ITEMM"}}).onOk(async d=>{await e(""),g.value[r].TSRVD_ITMCD=d.MITM_ITMNM})},l=()=>{h.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{b.value=!0,await Y.post("servicesAdmin",{header:C.value,detail:g.value}).then(r=>{b.value=!1,c()})})},s=()=>{h.dialog({component:zl}).onOk(async r=>{console.log(r),await w(""),g.value[idx].SRVH_CUSCD=r.MCUS_CUSCD})},E=r=>{h.dialog({component:st}).onOk(async d=>{console.log(z(d[0])),g.value[r].TSRVD_PHOTO=d})},z=r=>{var d=new FileReader;d.readAsDataURL(r),d.onload=function(){console.log(d.result)},d.onerror=function(T){console.log("Error: ",T)}};return(r,d)=>(F(),N(_e,{ref_key:"dialogRef",ref:D,onHide:X(v),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:i(()=>[t(he,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:i(()=>[t(ne,null,{default:i(()=>[ut]),_:1}),t(ne,{class:"q-pa-sm"},{default:i(()=>[p("fieldset",rt,[dt,p("div",ct,[p("div",mt,[t(L,{label:"SPK No",readonly:"",dense:"",modelValue:C.value.SRVH_DOCNO,"onUpdate:modelValue":d[0]||(d[0]=T=>C.value.SRVH_DOCNO=T),filled:""},null,8,["modelValue"])]),p("div",_t,[t(L,{filled:"",modelValue:C.value.SRVH_ISSDT,"onUpdate:modelValue":d[2]||(d[2]=T=>C.value.SRVH_ISSDT=T),dense:"",label:"Issue Date",loading:b.value,onClick:d[3]||(d[3]=T=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD",readonly:n.mode==="view"},{append:i(()=>[t(De,{name:"event",class:"cursor-pointer",disable:n.mode==="view"},{default:i(()=>[t(pl,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:i(()=>[t(gl,{modelValue:C.value.SRVH_ISSDT,"onUpdate:modelValue":d[1]||(d[1]=T=>C.value.SRVH_ISSDT=T),mask:"YYYY-MM-DD"},{default:i(()=>[p("div",vt,[Ie(t(q,{label:"Close",color:"primary",flat:""},null,512),[[Sl]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["disable"])]),_:1},8,["modelValue","loading","readonly"])])]),p("div",ft,[p("div",pt,[t(se,{dense:"",filled:"",label:"Customer Choose",modelValue:C.value.SRVH_CUSCD,"onUpdate:modelValue":d[5]||(d[5]=T=>C.value.SRVH_CUSCD=T),"use-input":"","input-debounce":"500",options:I.value,onFilter:d[6]||(d[6]=(T,S,M)=>x(T,S,M,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:b.value,readonly:n.mode==="view"},{after:i(()=>[t(q,{round:"",dense:"",flat:"",icon:"person_add",onClick:d[4]||(d[4]=T=>s()),color:"cyan"},{default:i(()=>[t(Q,null,{default:i(()=>[$("Add new customer")]),_:1})]),_:1})]),_:1},8,["modelValue","options","loading","readonly"])])])]),p("fieldset",gt,[St,n.mode!=="view"?(F(),oe("div",ht,[p("div",Ct,[t(q,{flat:"",icon:"add",color:"blue",onClick:d[7]||(d[7]=T=>m())},{default:i(()=>[t(Q,null,{default:i(()=>[$("Add lines")]),_:1})]),_:1})])])):G("",!0),t(_l,{bordered:"",dense:""},{default:i(()=>[g.value.length>0?(F(!0),oe(fe,{key:0},pe(g.value,(T,S)=>(F(),N(Oe,{key:S,class:"q-my-sm",dense:""},{default:i(()=>[t(W,{avatar:""},{default:i(()=>[t(rl,{"text-color":"blue"},{default:i(()=>[$(ae(S+1),1)]),_:2},1024)]),_:2},1024),t(W,null,{default:i(()=>[t(qe,null,{default:i(()=>[t(se,{dense:"",filled:"",label:"Item Name",modelValue:T.TSRVD_ITMCD,"onUpdate:modelValue":M=>T.TSRVD_ITMCD=M,"use-input":"","input-debounce":"500",options:U.value,onFilter:d[8]||(d[8]=(M,H,y)=>x(M,H,y,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:b.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),t(W,null,{default:i(()=>[t(L,{label:"Qty",filled:"",dense:"",modelValue:T.TSRVD_QTY,"onUpdate:modelValue":M=>T.TSRVD_QTY=M},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(W,null,{default:i(()=>[t(L,{label:"Problem",filled:"",dense:"",modelValue:T.TSRVD_CUSTRMK,"onUpdate:modelValue":M=>T.TSRVD_CUSTRMK=M},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),n.mode!=="view"?(F(),N(W,{key:0,side:""},{default:i(()=>[t(q,{icon:"delete",color:"red",flat:"",onClick:M=>o(S),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$("Delete line")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):G("",!0),n.mode!=="view"?(F(),N(W,{key:1,side:""},{default:i(()=>[t(q,{icon:"library_add",color:"indigo",flat:"",onClick:M=>_(S),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$("Add new item")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):G("",!0),n.mode!=="view"?(F(),N(W,{key:2,side:""},{default:i(()=>[t(q,{icon:"photo",color:"orange",flat:"",onClick:M=>E(S),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$("Add photo")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):G("",!0)]),_:2},1024))),128)):Ie((F(),N(Oe,{key:1,class:"q-my-sm",clickable:""},{default:i(()=>[t(W,null,{default:i(()=>[t(qe,null,{default:i(()=>[$(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[dl]])]),_:1})])]),_:1}),t(Ce,{align:"right"},{default:i(()=>[t(q,{label:"OK",color:"primary",onClick:d[9]||(d[9]=T=>l()),disable:b.value,loading:b.value},null,8,["disable","loading"]),t(q,{flat:"",label:"Cancel",color:"red",onClick:X(f),loading:b.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const bt={class:"q-pa-md"},Dt={class:"row q-pb-md"},Tt=p("div",{class:"col"},[p("span",{class:"text-h4"},"Receive Order ")],-1),Mt={class:"col text-right"},yt={class:"row q-pt-md"},Vt={class:"col"},wt={key:1},Et={__name:"serviceView",setup(a){const D=re(),v=V("SRVH_DOCNO"),c=V(""),f=V([]),h=V([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Cust",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"STAT",label:"Status",field:o=>m(o),sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left",format:o=>me.formatDate(new Date(o),"DD MMM YYYY")}]),n=V(!1),C=V(null);Se(()=>{U(),C.value=setInterval(()=>{U()},1e4)});const U=async()=>{n.value=!0,await Y.post("servicesAdmins/search",{searchBy:v.value,searchValue:c.value}).then(o=>{n.value=!1,f.value=o.data.data}).catch(o=>{n.value=!1})},I=()=>{D.dialog({component:Pe}).onOk(async o=>{U()})},g=o=>{const _={SRVH_DOCNO:o.SRVH_DOCNO,SRVH_ISSDT:me.formatDate(o.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:o.MCUS_CUSCD};let l=[];o.detail.map(s=>{l.push({id:s.id,TSRVD_ITMCD:s.TSRVD_ITMCD,TSRVD_LINE:s.TSRVD_LINE,TSRVD_QTY:s.TSRVD_QTY,TSRVD_CUSTRMK:s.TSRVD_CUSTRMK,TSRVD_REMARK:s.TSRVD_REMARK,TSRVD_FLGSTS:s.TSRVD_FLGSTS,listFixDet:s.list_fix_det})}),D.dialog({component:Cl,componentProps:{header:_,detail:l,mode:o.detail.filter(s=>s.TSRVD_FLGSTS===1).length===o.detail.length?"approvecust":"view"}}).onOk(async s=>{U()})},b=o=>{window.open("http://tribin.test/servicesAdmins/printInvoice/"+btoa(o),"_blank").focus()},x=o=>{const _={SRVH_DOCNO:o.SRVH_DOCNO,SRVH_ISSDT:me.formatDate(o.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:o.MCUS_CUSCD};let l=[];o.detail.map(s=>{l.push({TSRVD_ITMCD:s.TSRVD_ITMCD,TSRVD_LINE:s.TSRVD_LINE,TSRVD_QTY:s.TSRVD_QTY,TSRVD_CUSTRMK:s.TSRVD_CUSTRMK})}),D.dialog({component:Pe,componentProps:{header:_,detail:l}}).onOk(async s=>{U()})},w=o=>{D.dialog({title:"Confirmation",message:"Do you want to proceed to service ?",cancel:!0,persistent:!0}).onOk(async()=>{n.value=!0,await Y.put(`servicesAdmin/${btoa(o.SRVH_DOCNO)}`,{TSRVD_FLGSTS:2}).then(_=>{n.value=!1}).catch(_=>{n.value=!1})})},e=o=>{D.dialog({title:"Confirmation",message:"Are you sure want to delete this order ?",cancel:!0,persistent:!0}).onOk(async()=>{n.value=!0,await Y.delete(`servicesAdmin/${btoa(o.SRVH_DOCNO)}`).then(_=>{n.value=!1}).catch(_=>{n.value=!1})})},m=o=>{const _=o.detail.filter(r=>r.TSRVD_FLGSTS==0),l=o.detail.filter(r=>r.TSRVD_FLGSTS==1),s=o.detail.filter(r=>r.TSRVD_FLGSTS==2),E=o.detail.filter(r=>r.TSRVD_FLGSTS==3),z=o.detail.filter(r=>r.TSRVD_FLGSTS==5);if(_.length==o.detail.length)return{color:"red",label:"No Price Added yet !",icon:"edit"};if(l.length>0&&l.length<o.detail.length)return{color:"warning",label:"Please Add item & price",icon:"payments"};if(z.length>0&&z.length==o.detail.length)return{color:"indigo",label:"Added Price Done, Waiting Manager Confirmation",icon:"price_check"};if(l.length>0&&l.length==o.detail.length)return{color:"green",label:"Manager has been approve, Waiting Cust. Confirmation",icon:"price_check"};if(s.length>0&&s.length>=o.detail.length)return{color:"cyan",label:"Cust. has been approved, continue to fix.",icon:"engineering"};if(E.length>0&&E.length===o.detail.length)return{color:"primary",label:"Fix has been done",icon:"fact_check"}};return(o,_)=>(F(),oe("div",bt,[p("div",Dt,[Tt,p("div",Mt,[t(q,{icon:"add",color:"blue",onClick:I},{default:i(()=>[t(Q,null,{default:i(()=>[$("Create New Order")]),_:1})]),_:1})])]),t(cl),p("div",yt,[p("div",Vt,[t(vl,{title:"Created Order",rows:f.value,columns:h.value,"row-key":"name",loading:n.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":i(()=>[t(se,{outlined:"",modelValue:v.value,"onUpdate:modelValue":_[0]||(_[0]=l=>v.value=l),options:h.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),t(L,{borderless:"",dense:"",modelValue:c.value,"onUpdate:modelValue":[_[1]||(_[1]=l=>c.value=l),_[2]||(_[2]=l=>o.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:i(()=>[t(De,{name:"search"})]),_:1},8,["modelValue"])]),header:i(l=>[t(Ne,{props:l},{default:i(()=>[(F(!0),oe(fe,null,pe(l.cols,s=>(F(),N(xe,{key:s.name,props:l},{default:i(()=>[$(ae(s.label),1)]),_:2},1032,["props"]))),128)),t(xe,{"auto-width":""},{default:i(()=>[$("Action")]),_:1})]),_:2},1032,["props"])]),body:i(l=>[t(Ne,{props:l},{default:i(()=>[(F(!0),oe(fe,null,pe(l.cols,s=>(F(),N($e,{key:s.name,props:l},{default:i(()=>[s.name==="STAT"?(F(),N(fl,{key:0,clickable:"",color:s.value.color,"text-color":"white",icon:s.value.icon},{default:i(()=>[$(ae(s.value.label),1)]),_:2},1032,["color","icon"])):(F(),oe("span",wt,ae(s.value),1))]),_:2},1032,["props"]))),128)),t($e,{"auto-width":""},{default:i(()=>[l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length===0?(F(),N(q,{key:0,flat:"",color:"orange",icon:"edit",onClick:s=>x(l.row),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$("Edit this Order")]),_:1})]),_:2},1032,["onClick"])):G("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length===l.row.detail.length?(F(),N(q,{key:1,flat:"",color:"indigo",icon:"print",onClick:s=>b(l.row.SRVH_DOCNO),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$("Print this order")]),_:1})]),_:2},1032,["onClick"])):G("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length===0?(F(),N(q,{key:2,flat:"",color:"red",icon:"delete",onClick:s=>e(l.row.SRVH_DOCNO),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$(ae(l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length>0?"Cannot delete processed order":"Delete this Order"),1)]),_:2},1024)]),_:2},1032,["onClick"])):G("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length>0?(F(),N(q,{key:3,flat:"",color:"cyan",icon:"visibility",onClick:s=>g(l.row),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$("View this Order")]),_:1})]),_:2},1032,["onClick"])):G("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS==1).length===l.row.detail.length?(F(),N(q,{key:4,flat:"",color:"indigo",icon:"check",onClick:s=>w(l.row),dense:""},{default:i(()=>[t(Q,null,{default:i(()=>[$(ae(l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length!==l.row.detail.length?"Please wait until all item checked":"Proceed all item to service"),1)]),_:2},1024)]),_:2},1032,["onClick"])):G("",!0)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Et as default};
