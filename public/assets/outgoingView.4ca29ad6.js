import{Q as A}from"./QTooltip.10185433.js";import{t as d,o as B,C as f,D as T,E as l,F as e,M as G,O as N,J as o,$ as y,av as K,R,S as I,T as $,I as D,P as M,X as J,Q as g,Y as H,Z as W,U as j,V as de,W as ue,aI as ie}from"./index.283df284.js";import{Q as Y}from"./QSelect.dd214b48.js";import{Q as X,a as E}from"./QTable.0b3d543f.js";import{Q as q,a as x}from"./QTd.4d0e9f34.js";import{api_web as U}from"./axios.adb4aacd.js";import{u as F}from"./use-quasar.50c8a90b.js";import{Q as re,a as ce}from"./QInnerLoading.70d53be8.js";import{Q as me,a as pe,C as _e}from"./ClosePopup.3a6dd28c.js";import{Q as z,a as k,b as Q}from"./QItemLabel.c39164f1.js";import{Q as fe}from"./QList.f3bcee64.js";import{u as Z}from"./use-dialog-plugin-component.8027b9a0.js";import"./format.f5483033.js";import"./use-render-cache.3aae9b27.js";import"./date.ff9170da.js";const ve=o("div",{class:"text-h6"},"Sales Order Choose",-1),De={class:"row"},Ce={class:"col"},ge={__name:"salesOrderChoose",setup(P){F();const V=d([]),r=d([{name:"TSLO_SLOCD",label:"Sales Ord Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_PLAN_DLVDT",label:"DLV Plan Date",field:"TSLO_PLAN_DLVDT",sortable:!0,align:"left"}]),n=d(!1),p=d(""),S=d("");B(()=>{b()});const b=async()=>{n.value=!0,await U.post("delivery/outstanding-warehouse-api",{searchBy:p.value,searchValue:S.value}).then(a=>{n.value=!1,V.value=a.data.data}).catch(a=>{n.value=!1})},v=a=>{_(a)},{dialogRef:C,onDialogHide:h,onDialogOK:_,onDialogCancel:u}=Z();return(a,c)=>(f(),T(W,{ref_key:"dialogRef",ref:C,onHide:H(h),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(G,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(N,null,{default:l(()=>[ve]),_:1}),e(N,{class:"q-pa-sm"},{default:l(()=>[o("div",De,[o("div",Ce,[e(X,{title:"Outgoing List",rows:V.value,columns:r.value,"row-key":"TDLVORD_DLVCD",loading:n.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(Y,{outlined:"",modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=m=>p.value=m),options:r.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(y,{borderless:"",dense:"",modelValue:S.value,"onUpdate:modelValue":[c[1]||(c[1]=m=>S.value=m),c[2]||(c[2]=m=>a.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(K,{name:"search"})]),_:1},8,["modelValue"])]),header:l(m=>[e(q,{props:m},{default:l(()=>[(f(!0),R(I,null,$(m.cols,L=>(f(),T(E,{key:L.name,props:m},{default:l(()=>[D(M(L.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(m=>[e(q,{props:m,onClick:L=>v(m.row)},{default:l(()=>[(f(!0),R(I,null,$(m.cols,L=>(f(),T(x,{key:L.name,props:m},{default:l(()=>[D(M(L.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns","loading"])])])]),_:1}),e(J,{align:"right"},{default:l(()=>[e(g,{flat:"",label:"Cancel",color:"red",onClick:H(u)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Ve=o("div",{class:"text-h6"},"Create Outgoing Delivery",-1),Se={style:{border:"1px black solid","border-radius":"10px"}},be=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),he={class:"row"},Le={class:"col"},Oe={class:"col q-pl-md"},ye={class:"row items-center justify-end"},Te={class:"row q-pt-md"},we={class:"col"},ke={class:"col q-pl-md"},Re={class:"row q-pt-md"},Ue={class:"col"},Me={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Qe=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"List Of Items")],-1),Ie={__name:"outgoingCreate",props:{dataHeader:Array},setup(P){const V=F(),r=P;B(async()=>{await m(r.dataHeader.TDLVORD_CUSCD),Object.values(r.dataHeader).length>0&&(console.log(r.dataHeader),p.value=r.dataHeader.TDLVORD_DLVCD,S.value=r.dataHeader.TDLVORD_INVCD,b.value=r.dataHeader.TDLVORD_CUSCD,v.value=r.dataHeader.TDLVORD_ISSUDT,C.value=r.dataHeader.TDLVORDDETA_SLOCD,h.value=r.dataHeader.MCUS_CUSNM,_.value=r.dataHeader.TDLVORD_REMARK,u.value=r.dataHeader.listItems)});const n=d(!1),p=d(""),S=d(""),b=d(""),v=d(""),C=d(""),h=d(""),_=d(""),u=d([]),a=d([]),c=(i,t,s,O)=>{t(async()=>{O==="cust"&&m(i),O==="item"&&await getItem(i)})},m=async(i,t="MCUS_CUSNM")=>{n.value=!0,await U.post("customer/searchAPI",{searchValue:i,searchCol:t}).then(s=>{n.value=!1,a.value=s.data.data}).catch(()=>{n.value=!1})},L=()=>{V.dialog({title:"Confirmation",message:"Are you sure want to save this outgoing ?",cancel:!0,persistent:!0}).onOk(async()=>{n.value=!0,await U.post("delivery",{TDLVORD_DLVCD:p.value,TDLVORD_CUSCD:b.value,TDLVORD_ISSUDT:v.value,TDLVORDDETA_SLOCD:C.value,TDLVORD_REMARK:_.value,SO_DET:u.value}).then(i=>{n.value=!1,se()}).catch(i=>{n.value=!1})})},ee=()=>{V.dialog({component:ge}).onOk(async i=>{C.value=i.TSLO_SLOCD,h.value=i.MCUS_CUSNM,b.value=i.TSLO_CUSCD,le(i.TSLO_SLOCD)})},le=async i=>{n.value=!0,await U.get(`delivery/outstanding-warehouse/${btoa(i)}`).then(t=>{n.value=!1,u.value=t.data.data}).catch(t=>{n.value=!1})},ae=i=>{V.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${i+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{u.value.splice(i,1)})},{dialogRef:te,onDialogHide:oe,onDialogOK:se,onDialogCancel:ne}=Z();return(i,t)=>(f(),T(W,{ref_key:"dialogRef",ref:te,onHide:H(oe),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(G,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(N,null,{default:l(()=>[Ve]),_:1}),e(N,{class:"q-pa-sm"},{default:l(()=>[o("fieldset",Se,[be,e(re,{showing:n.value,dark:""},{default:l(()=>[e(ce,{size:"50px",color:"primary"})]),_:1},8,["showing"]),o("div",he,[o("div",Le,[e(y,{label:"Code",readonly:"",dense:"",filled:"",modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s)},null,8,["modelValue"])]),o("div",Oe,[e(y,{filled:"",modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=s=>v.value=s),dense:"",label:"Issue Date"},{append:l(()=>[e(K,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(me,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(pe,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",ye,[j(e(g,{label:"Close",color:"primary",flat:""},null,512),[[_e]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),o("div",Te,[o("div",we,[e(y,{modelValue:C.value,"onUpdate:modelValue":t[3]||(t[3]=s=>C.value=s),label:"Sales Order",dense:"",readonly:""},{append:l(()=>[e(g,{round:"",dense:"",flat:"",icon:"search",onClick:ee})]),_:1},8,["modelValue"])]),o("div",ke,[e(Y,{dense:"",filled:"",label:"Customer Choose",modelValue:h.value,"onUpdate:modelValue":t[5]||(t[5]=s=>h.value=s),"use-input":"","input-debounce":"500",options:a.value,onFilter:t[6]||(t[6]=(s,O,w)=>c(s,O,w,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:n.value,readonly:C.value!=""},{after:l(()=>[e(g,{round:"",dense:"",flat:"",icon:"person_add",onClick:t[4]||(t[4]=s=>i.onAddCustClick()),color:"cyan"},{default:l(()=>[e(A,null,{default:l(()=>[D("Add new customer")]),_:1})]),_:1})]),_:1},8,["modelValue","options","loading","readonly"])])]),o("div",Re,[o("div",Ue,[e(y,{modelValue:_.value,"onUpdate:modelValue":t[7]||(t[7]=s=>_.value=s),label:"Remarks",dense:""},null,8,["modelValue"])])])]),o("fieldset",Me,[Qe,e(fe,{bordered:"",dense:""},{default:l(()=>[u.value.length>0?(f(!0),R(I,{key:0},$(u.value,(s,O)=>(f(),T(z,{key:O,class:"q-my-sm",dense:"",loading:n.value},{default:l(()=>[e(k,{avatar:""},{default:l(()=>[e(de,{"text-color":"blue"},{default:l(()=>[D(M(O+1),1)]),_:2},1024)]),_:2},1024),e(k,null,{default:l(()=>[e(Q,null,{default:l(()=>[e(y,{dense:"",label:"Item Name",filled:"",modelValue:s.MITM_ITMNM,"onUpdate:modelValue":w=>s.MITM_ITMNM=w,readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(k,null,{default:l(()=>[e(Q,null,{default:l(()=>[e(y,{dense:"",label:"Qty",filled:"",modelValue:s.BALQT,"onUpdate:modelValue":w=>s.BALQT=w},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(k,null,{default:l(()=>[e(Q,null,{default:l(()=>[D(" Rp. "+M(s.TSLODETA_PRC.toLocaleString()),1)]),_:2},1024),e(Q,{caption:""},{default:l(()=>[D(" Price ")]),_:1})]),_:2},1024),e(k,{side:""},{default:l(()=>[e(g,{icon:"delete",color:"red",flat:"",onClick:w=>ae(O)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["loading"]))),128)):j((f(),T(z,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(k,null,{default:l(()=>[e(Q,null,{default:l(()=>[D(" Choose sales order first to access item list ")]),_:1})]),_:1})]),_:1})),[[ue]])]),_:1})])]),_:1}),e(J,{align:"right"},{default:l(()=>[e(g,{label:"OK",color:"primary",onClick:t[8]||(t[8]=s=>L()),loading:n.value},null,8,["loading"]),e(g,{flat:"",label:"Cancel",color:"red",onClick:H(ne)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},$e={class:"q-pa-md"},Ae={class:"row q-pb-md"},Ne=o("div",{class:"col"},[o("span",{class:"text-h4"},"Outgoing")],-1),He={class:"col text-right"},qe={class:"row q-pt-md"},Pe={class:"col"},al={__name:"outgoingView",setup(P){const V=F(),r=d([]),n=d([{name:"TDLVORD_DLVCD",label:"Delivery ID",field:"TDLVORD_DLVCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TDLVORD_ISSUDT",label:"Issue Date",field:"TDLVORD_ISSUDT",sortable:!0,align:"left"},{name:"TDLVORD_REMARK",label:"Remark",field:"TDLVORD_REMARK",sortable:!0,align:"left"}]),p=d(!1),S=d(""),b=d("");B(()=>{v()});const v=async()=>{p.value=!0,await U.post("delivery/searchAPI",{searchBy:S.value,searchValue:b.value}).then(_=>{p.value=!1,r.value=_.data.data}).catch(_=>{p.value=!1})},C=(_=[])=>{V.dialog({component:Ie,componentProps:{dataHeader:_}}).onOk(async u=>{v()})},h=_=>{V.dialog({title:"Confirmation",message:"Are you sure want to delete this data ?",cancel:!0,persistent:!0}).onOk(async()=>{p.value=!0,await U.delete(`delivery/${btoa(_)}`).then(u=>{p.value=!1,v()})})};return(_,u)=>(f(),R("div",$e,[o("div",Ae,[Ne,o("div",He,[e(g,{icon:"add",color:"blue",onClick:u[0]||(u[0]=a=>C([]))},{default:l(()=>[e(A,null,{default:l(()=>[D("Create New Delivery")]),_:1})]),_:1})])]),e(ie),o("div",qe,[o("div",Pe,[e(X,{title:"Outgoing List",rows:r.value,columns:n.value,"row-key":"TDLVORD_DLVCD",loading:p.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(Y,{outlined:"",modelValue:S.value,"onUpdate:modelValue":u[1]||(u[1]=a=>S.value=a),options:n.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(y,{borderless:"",dense:"",modelValue:b.value,"onUpdate:modelValue":[u[2]||(u[2]=a=>b.value=a),u[3]||(u[3]=a=>v())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(K,{name:"search"})]),_:1},8,["modelValue"])]),header:l(a=>[e(q,{props:a},{default:l(()=>[(f(!0),R(I,null,$(a.cols,c=>(f(),T(E,{key:c.name,props:a},{default:l(()=>[D(M(c.label),1)]),_:2},1032,["props"]))),128)),e(E,{"auto-width":""},{default:l(()=>[D("Action")]),_:1})]),_:2},1032,["props"])]),body:l(a=>[e(q,{props:a},{default:l(()=>[(f(!0),R(I,null,$(a.cols,c=>(f(),T(x,{key:c.name,props:a},{default:l(()=>[D(M(c.value),1)]),_:2},1032,["props"]))),128)),e(x,{"auto-width":""},{default:l(()=>[e(g,{flat:"",color:"orange",icon:"edit",onClick:c=>C(a.row),dense:""},{default:l(()=>[e(A,null,{default:l(()=>[D("Edit Data")]),_:1})]),_:2},1032,["onClick"]),e(g,{flat:"",color:"red",icon:"delete",onClick:c=>h(a.row.TDLVORD_DLVCD),dense:""},{default:l(()=>[e(A,null,{default:l(()=>[D("Edit Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{al as default};
