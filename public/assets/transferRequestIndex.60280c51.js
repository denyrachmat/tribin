import{t as m,o as S,C as f,D as E,E as n,F as e,M as H,O as q,J as o,$ as D,R as T,S as P,T as k,a0 as K,aZ as W,X as Z,Q as y,Y as A,Z as z,aI as G,av as J,I as R,P as h}from"./index.2f1b7971.js";import{Q as w}from"./QSelect.f5c00ed7.js";import{Q as X,a as M}from"./QTable.0a26f586.js";import{Q as N,a as B}from"./QTd.8a03b594.js";import{Q as F}from"./QTooltip.2e5bd2ca.js";import{api_web as V}from"./axios.3a678633.js";import{u as x}from"./use-quasar.0f7ce327.js";import{Q as j,a as ee}from"./QInnerLoading.958120d3.js";import{u as ae}from"./use-dialog-plugin-component.ec4c76b3.js";import"./QItemLabel.aeb6122c.js";import"./format.b80f222e.js";import"./QList.49b82c06.js";const le=o("div",{class:"text-h6"},"Request Part",-1),oe={style:{border:"1px black solid","border-radius":"10px"}},te=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),ne={class:"row q-col-gutter-md"},se={class:"col-12"},ie={class:"row q-col-gutter-md q-pt-md"},re={class:"col-12 col-sm-6"},de={class:"col-12 col-sm-6"},ue={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},ce=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"List Of Items")],-1),me={class:"col-12 col-sm-6"},pe={class:"col-12 col-sm-3"},ve={class:"col-12 col-sm-3"},fe={__name:"transferRequestPreview",props:{dataHeader:Array,dataDet:Array,qtyOnly:Boolean},setup(I){const b=x(),g=I,c=m({TLOCREQ_DOCNO:"",TLOCREQ_FRLOC:"",TLOCREQ_TOLOC:""}),d=m([]),_=m([]),C=m([]),s=m(!1);S(async()=>{console.log(g),await Q(""),await i(""),c.value=g.dataHeader,C.value=g.dataDet});const L=(O,t,l,v)=>{t(async()=>{v==="loc"&&await Q(O),v==="item"&&await i(O)})},Q=async(O,t="MSUP_SUPNM")=>{s.value=!0,await V.post("location/searchAPI",{searchBy:t,searchValue:O}).then(l=>{s.value=!1,_.value=l.data.data}).catch(l=>{s.value=!1})},i=async O=>{s.value=!0,await V.post("item/searchAPITBL",{searchValue:O}).then(t=>{s.value=!1,d.value=t.data.data}).catch(()=>{s.value=!1})},r=()=>{b.dialog({title:"Confirmation",message:"Are you sure want to send this request ?",cancel:!0,persistent:!0}).onOk(async()=>{s.value=!0})},{dialogRef:a,onDialogHide:p,onDialogOK:Le,onDialogCancel:U}=ae();return(O,t)=>(f(),E(z,{ref_key:"dialogRef",ref:a,onHide:A(p),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:n(()=>[e(H,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:n(()=>[e(q,null,{default:n(()=>[le]),_:1}),e(q,{class:"q-pa-sm"},{default:n(()=>[o("fieldset",oe,[te,e(j,{showing:s.value,dark:""},{default:n(()=>[e(ee,{size:"50px",color:"primary"})]),_:1},8,["showing"]),o("div",ne,[o("div",se,[e(D,{label:"Doc No",dense:"",filled:"",modelValue:c.value.TLOCREQ_DOCNO,"onUpdate:modelValue":t[0]||(t[0]=l=>c.value.TLOCREQ_DOCNO=l),readonly:!0},null,8,["modelValue"])])]),o("div",ie,[o("div",re,[e(w,{dense:"",filled:"",label:"Transfer From",modelValue:c.value.TLOCREQ_FRLOC,"onUpdate:modelValue":t[1]||(t[1]=l=>c.value.TLOCREQ_FRLOC=l),"use-input":"","input-debounce":"500",options:_.value,onFilter:t[2]||(t[2]=(l,v,u)=>L(l,v,u,"loc")),behavior:"dialog","option-label":"MLOC_LOCNM","option-value":"MLOC_LOCCD","emit-value":"","map-options":"",loading:s.value,readonly:!0},null,8,["modelValue","options","loading"])]),o("div",de,[e(w,{dense:"",filled:"",label:"Transfer To",modelValue:c.value.TLOCREQ_TOLOC,"onUpdate:modelValue":t[3]||(t[3]=l=>c.value.TLOCREQ_TOLOC=l),"use-input":"","input-debounce":"500",options:_.value,onFilter:t[4]||(t[4]=(l,v,u)=>L(l,v,u,"loc")),behavior:"dialog","option-label":"MLOC_LOCNM","option-value":"MLOC_LOCCD","emit-value":"","map-options":"",loading:s.value,readonly:!0},null,8,["modelValue","options","loading"])])])]),o("fieldset",ue,[ce,C.value.length>0?(f(!0),T(P,{key:0},k(C.value,(l,v)=>(f(),T("div",{class:"row q-col-gutter-md q-pt-md",key:v},[o("div",me,[e(w,{dense:"",filled:"",label:"Item Name",modelValue:l.TLOCREQ_ITMCD,"onUpdate:modelValue":u=>l.TLOCREQ_ITMCD=u,"use-input":"","input-debounce":"500",options:d.value,onFilter:t[5]||(t[5]=(u,$,Y)=>L(u,$,Y,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:s.value,readonly:!0},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),o("div",pe,[e(D,{label:"Qty",dense:"",filled:"",modelValue:l.TLOCREQ_QTY,"onUpdate:modelValue":u=>l.TLOCREQ_QTY=u},null,8,["modelValue","onUpdate:modelValue"])]),o("div",ve,[e(K,{modelValue:l.TLOCREQ_ISREP,"onUpdate:modelValue":u=>l.TLOCREQ_ISREP=u,label:"Is replacement ?",color:"teal","true-value":1,"false-value":0,disable:s.value,readonly:!0},null,8,["modelValue","onUpdate:modelValue","disable"])])]))),128)):W("",!0)])]),_:1}),e(Z,{align:"right"},{default:n(()=>[e(y,{label:"approve",color:"primary",onClick:t[6]||(t[6]=l=>r()),loading:s.value},null,8,["loading"]),e(y,{flat:"",label:"Cancel",color:"red",onClick:A(U)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},_e={class:"q-pa-md"},Ce=o("div",{class:"row q-pb-md"},[o("div",{class:"col"},[o("span",{class:"text-h4"},"Transfer Request")]),o("div",{class:"col text-right"})],-1),Oe={class:"row q-pt-md"},ge={class:"col"},Ie={__name:"transferRequestIndex",setup(I){const b=x(),g=m([]),c=m([{name:"TLOCREQ_DOCNO",label:"Doc Np",field:"TLOCREQ_DOCNO",sortable:!0,align:"left"},{name:"TLOCREQ_FRLOC",label:"From Location",field:"TLOCREQ_FRLOC",sortable:!0,align:"left"},{name:"TLOCREQ_TOLOC",label:"To Location",field:"TLOCREQ_TOLOC",sortable:!0,align:"left"},{name:"TLOCREQ_ISREP",label:"Is Replacement ?",field:"TLOCREQ_ISREP",sortable:!0,format:i=>`${i==1?"Yes":"No"}`,align:"left"}]),d=m(!1),_=m(""),C=m("");S(()=>{s()});const s=async()=>{d.value=!0,await V.post("inventory/transferRequest/searchAPI",{searchBy:_.value,searchValue:C.value}).then(i=>{d.value=!1,g.value=i.data.data}).catch(i=>{d.value=!1})},L=i=>{b.dialog({component:fe,componentProps:{dataHeader:i,dataDet:i.detail}}).onOk(async r=>{d.value=!1,onDialogOK()})},Q=i=>{b.dialog({title:"Confirmation",message:"Are you sure want to print this transfer ?",cancel:!0,persistent:!0}).onOk(async()=>{d.value=!0,await V.post("inventory/printHandoverPDF",{data:btoa(i)}).then(r=>{d.value=!1,window.open("").document.write("<iframe width='100%' height='100%' src='data:application/pdf;base64, "+encodeURI(r.data)+"'></iframe>")}).catch(r=>{d.value=!1})})};return(i,r)=>(f(),T("div",_e,[Ce,e(G),o("div",Oe,[o("div",ge,[e(X,{title:"Transfer Request List",rows:g.value,columns:c.value,"row-key":"TDLVORD_DLVCD",loading:d.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":n(()=>[e(w,{outlined:"",modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=a=>_.value=a),options:c.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(D,{borderless:"",dense:"",modelValue:C.value,"onUpdate:modelValue":[r[1]||(r[1]=a=>C.value=a),r[2]||(r[2]=a=>i.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:n(()=>[e(J,{name:"search"})]),_:1},8,["modelValue"])]),header:n(a=>[e(N,{props:a},{default:n(()=>[(f(!0),T(P,null,k(a.cols,p=>(f(),E(M,{key:p.name,props:a},{default:n(()=>[R(h(p.label),1)]),_:2},1032,["props"]))),128)),e(M,{"auto-width":""},{default:n(()=>[R("Action")]),_:1})]),_:2},1032,["props"])]),body:n(a=>[e(N,{props:a},{default:n(()=>[(f(!0),T(P,null,k(a.cols,p=>(f(),E(B,{key:p.name,props:a},{default:n(()=>[R(h(p.value),1)]),_:2},1032,["props"]))),128)),e(B,{"auto-width":""},{default:n(()=>[e(y,{flat:"",color:a.row.TLOCREQ_APPRVBY!==null?"grey":"indigo",icon:"done_all",onClick:p=>L(a.row),dense:"",disable:a.row.TLOCREQ_APPRVBY!==null},{default:n(()=>[e(F,null,{default:n(()=>[R(h(a.row.TLOCREQ_APPRVBY!==null?"Request has been approved":"Approve All Data"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(y,{flat:"",color:a.row.TLOCREQ_APPRVBY!==null?"cyan":"grey",icon:"print",onClick:p=>Q(a.row.TLOCREQ_DOCNO),dense:"",disable:a.row.TLOCREQ_APPRVBY===null},{default:n(()=>[e(F,null,{default:n(()=>[R(h(a.row.TLOCREQ_APPRVBY===null?"Please Aprove first":"Print handover request"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Ie as default};
