import{Q as w}from"./QTooltip.e827c73b.js";import{t as p,o as H,C as v,D as y,E as o,F as a,M as ae,O as N,J as i,$ as h,an as x,U as L,Q as D,R as g,S as Q,T as k,V as oe,I as V,P as M,W as te,X as se,Z as ne,aY as ie}from"./index.ba07ce6d.js";import{a as B,l as S,Q as de,b as A,c as R,d as P,k as ue,m as q}from"./QTable.847a4ea5.js";import{Q as $,a as E}from"./QTd.1b3fee39.js";import{api_web as O}from"./axios.16f72141.js";import{Q as re,a as ce}from"./QInnerLoading.e8b00807.js";import{Q as pe,a as me,C as ve}from"./ClosePopup.5d680dfd.js";import{Q as _e}from"./QBtnToggle.6bbf7519.js";import"./use-render-cache.3aae9b27.js";import"./date.05fee2ea.js";import"./QBtnGroup.9bf7447c.js";const Ce=i("div",{class:"text-h6"},"Create Incoming",-1),Ve={style:{border:"1px black solid","border-radius":"10px"}},fe=i("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[i("b",null,"Header")],-1),De={class:"row q-col-gutter-md"},ge={class:"col-12 col-sm-6"},Te={class:"col-12 col-sm-6"},be={class:"row items-center justify-end"},Re={class:"row q-col-gutter-md q-pt-md"},he={key:0,class:"col-12 col-sm-6"},Se={key:1,class:"col-12 col-sm-6"},Oe={key:2,class:"col-12 col-sm-6"},Pe={key:3,class:"col-12 col-sm-6"},ye={class:"row q-col-gutter-md q-pt-md"},Ue={class:"col"},Ie={class:"row q-py-md"},we={class:"col"},Qe={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},ke=i("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[i("b",null,"List Of Items")],-1),Me={class:"row q-pb-sm"},Ne={class:"col text-right"},Le={__name:"incomingCreate",props:{dataHeader:Array},setup(F){const I=B(),n=p({TRCV_RCVCD:"",TRCV_SUPCD:"",TRCV_ISSUDT:"",INV_NO:"",PO_NO:"",TRCV_DOCNO:""}),f=p(1),c=p([]),t=p(!1),T=p([]),U=p([]),b=p([]),_=p([]),m=p([]);H(()=>{C("")});const d=(s,l,e,u)=>{l(async()=>{u==="supp"&&await Y(s),u==="cust"&&await J(s),u==="item"&&await C(s),u==="po"&&await j(s),u==="inv"&&await K(s)})},C=async s=>{t.value=!0,await O.post("item/searchAPI",{searchValue:s,isITMCD:1}).then(l=>{t.value=!1,_.value=l.data.data}).catch(()=>{t.value=!1})},Y=async(s,l="MSUP_SUPNM")=>{t.value=!0,await O.post("supplier/searchAPI",{searchValue:s,searchCol:l}).then(e=>{t.value=!1,T.value=e.data.data}).catch(()=>{t.value=!1})},J=async(s,l="MCUS_CUSNM")=>{t.value=!0,await O.post("customer/searchAPI",{searchValue:s,searchCol:l}).then(e=>{t.value=!1,U.value=e.data.data}).catch(()=>{t.value=!1})},j=async(s,l="TPCHORD_PCHCD")=>{t.value=!0,await O.post("purchase-order/searchApprovedPO",{searchValue:s,searchCol:l}).then(e=>{t.value=!1,b.value=e.data.data}).catch(()=>{t.value=!1})},z=s=>{I.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${s+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{c.value.splice(s,1)})},G=()=>{c.value.push({item_code:"",quantity:"",unit_price:""})},K=async(s,l="TDLVORD_DLVCD")=>{t.value=!0,await O.post("invoices/search",{searchBy:l,searchValue:s}).then(e=>{t.value=!1,m.value=e.data.data}).catch(e=>{t.value=!1})},W=s=>{let l=b.value.filter(e=>e.TPCHORD_PCHCD==s);c.value=[],l.length>0&&l[0].det.map(e=>{c.value.push({item_code:e.TPCHORDDETA_ITMCD,quantity:e.TPCHORDDETA_ITMQT,unit_price:e.TPCHORDDETA_ITMPRC_PER})})},X=s=>{let l=m.value.filter(e=>e.TDLVORD_DLVCD==s);c.value=[],l.length>0&&(l[0].dlvacc.map(e=>{c.value.push({item_code:e.TDLVACCESSORY_ITMCD,quantity:e.TDLVACCESSORY_ITMQT,unit_price:0})}),l[0].dlvdet.map(e=>{c.value.push({item_code:e.TDLVORDDETA_ITMCD,quantity:e.TDLVORDDETA_ITMQT,unit_price:e.TDLVORDDETA_PRC})}))},Z=()=>{};return(s,l)=>(v(),y(ne,{ref:"dialogRef",onHide:s.onDialogHide,"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:o(()=>[a(ae,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:o(()=>[a(N,null,{default:o(()=>[Ce]),_:1}),a(N,{class:"q-pa-sm"},{default:o(()=>[i("fieldset",Ve,[fe,a(re,{showing:t.value,dark:""},{default:o(()=>[a(ce,{size:"50px",color:"primary"})]),_:1},8,["showing"]),i("div",De,[i("div",ge,[a(h,{label:"Code",readonly:"",dense:"",filled:"",modelValue:n.value.TRCV_RCVCD,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value.TRCV_RCVCD=e)},null,8,["modelValue"])]),i("div",Te,[a(h,{filled:"",modelValue:n.value.TRCV_ISSUDT,"onUpdate:modelValue":l[2]||(l[2]=e=>n.value.TRCV_ISSUDT=e),dense:"",label:"Receive Date"},{append:o(()=>[a(x,{name:"event",class:"cursor-pointer"},{default:o(()=>[a(pe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(me,{modelValue:n.value.TRCV_ISSUDT,"onUpdate:modelValue":l[1]||(l[1]=e=>n.value.TRCV_ISSUDT=e),mask:"YYYY-MM-DD"},{default:o(()=>[i("div",be,[L(a(D,{label:"Close",color:"primary",flat:""},null,512),[[ve]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),i("div",Re,[f.value==1?(v(),g("div",he,[a(S,{dense:"",filled:"",label:"Supplier Name",modelValue:n.value.TRCV_SUPCD,"onUpdate:modelValue":l[3]||(l[3]=e=>n.value.TRCV_SUPCD=e),"use-input":"","input-debounce":"500",options:T.value,onFilter:l[4]||(l[4]=(e,u,r)=>d(e,u,r,"supp")),behavior:"dialog","option-label":"MSUP_SUPNM","option-value":"MSUP_SUPCD","emit-value":"","map-options":"",loading:t.value,disable:n.value.TRCV_RCVCD!==""||f.value==1},null,8,["modelValue","options","loading","disable"])])):(v(),g("div",Se,[a(S,{dense:"",filled:"",label:"Customer Name",modelValue:n.value.TRCV_SUPCD,"onUpdate:modelValue":l[5]||(l[5]=e=>n.value.TRCV_SUPCD=e),"use-input":"","input-debounce":"500",options:U.value,onFilter:l[6]||(l[6]=(e,u,r)=>d(e,u,r,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:t.value,disable:n.value.TRCV_RCVCD!==""||f.value==1},null,8,["modelValue","options","loading","disable"])])),f.value==1?(v(),g("div",Oe,[a(S,{dense:"",filled:"",label:"PO Number",modelValue:n.value.PO_NO,"onUpdate:modelValue":[l[7]||(l[7]=e=>n.value.PO_NO=e),l[9]||(l[9]=e=>W(e))],"use-input":"","input-debounce":"500",options:b.value,onFilter:l[8]||(l[8]=(e,u,r)=>d(e,u,r,"po")),behavior:"dialog","option-label":"PO_CUSTDESC","option-value":"TPCHORD_PCHCD","emit-value":"","map-options":"",loading:t.value,disable:n.value.TRCV_RCVCD!==""},null,8,["modelValue","options","loading","disable"])])):(v(),g("div",Pe,[a(S,{dense:"",filled:"",label:"JAT Invoice No",modelValue:n.value.INV_NO,"onUpdate:modelValue":[l[10]||(l[10]=e=>n.value.INV_NO=e),l[12]||(l[12]=e=>X(e))],"use-input":"","input-debounce":"500",options:m.value,onFilter:l[11]||(l[11]=(e,u,r)=>d(e,u,r,"inv")),behavior:"dialog","option-label":"LABEL","option-value":"TDLVORD_DLVCD","emit-value":"","map-options":"",loading:t.value,disable:n.value.TRCV_RCVCD!==""},null,8,["modelValue","options","loading","disable"])]))]),i("div",ye,[i("div",Ue,[a(h,{label:"Doc Supplier No",dense:"",filled:"",modelValue:n.value.TRCV_DOCNO,"onUpdate:modelValue":l[13]||(l[13]=e=>n.value.TRCV_DOCNO=e)},null,8,["modelValue"])])])]),i("div",Ie,[i("div",we,[a(_e,{modelValue:f.value,"onUpdate:modelValue":l[14]||(l[14]=e=>f.value=e),spread:"","no-caps":"","toggle-color":"purple",color:"white","text-color":"black",options:[{label:"From PO",value:1},{label:"Return",value:2}],disable:n.value.TRCV_RCVCD!==""},null,8,["modelValue","disable"])])]),i("fieldset",Qe,[ke,i("div",Me,[i("div",Ne,[a(D,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:G,loading:t.value},null,8,["loading"])])]),a(de,{bordered:"",dense:""},{default:o(()=>[c.value.length>0?(v(!0),g(Q,{key:0},k(c.value,(e,u)=>(v(),y(A,{key:u,class:"q-my-sm",dense:"",loading:t.value},{default:o(()=>[a(R,{avatar:""},{default:o(()=>[a(oe,{"text-color":"blue"},{default:o(()=>[V(M(u+1),1)]),_:2},1024)]),_:2},1024),a(R,null,{default:o(()=>[a(P,null,{default:o(()=>[a(S,{dense:"",filled:"",label:"Item Code",modelValue:e.item_code,"onUpdate:modelValue":r=>e.item_code=r,"use-input":"","input-debounce":"500",options:_.value,onFilter:l[15]||(l[15]=(r,ee,le)=>d(r,ee,le,"item")),behavior:"dialog","option-label":"MITM_ITMNMREAL","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:t.value,disable:n.value.TRCV_RCVCD!==""},null,8,["modelValue","onUpdate:modelValue","options","loading","disable"])]),_:2},1024)]),_:2},1024),a(R,null,{default:o(()=>[a(P,null,{default:o(()=>[a(h,{dense:"",label:"Qty",filled:"",modelValue:e.quantity,"onUpdate:modelValue":r=>e.quantity=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a(R,null,{default:o(()=>[a(P,null,{default:o(()=>[a(h,{dense:"",label:"Price",filled:"",modelValue:e.unit_price,"onUpdate:modelValue":r=>e.unit_price=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(P,{caption:""},{default:o(()=>[V(" Price ")]),_:1})]),_:2},1024),a(R,{side:""},{default:o(()=>[a(D,{icon:"delete",color:"red",flat:"",onClick:r=>z(u)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["loading"]))),128)):L((v(),y(A,{key:1,class:"q-my-sm",clickable:""},{default:o(()=>[a(R,null,{default:o(()=>[a(P,null,{default:o(()=>[V(" Choose sales order first to access item list ")]),_:1})]),_:1})]),_:1})),[[te]])]),_:1})])]),_:1}),a(se,{align:"right"},{default:o(()=>[a(D,{label:"OK",color:"primary",onClick:l[16]||(l[16]=e=>Z()),disable:s.stateSubmit,loading:t.value},null,8,["disable","loading"]),a(D,{flat:"",label:"Cancel",color:"red",onClick:s.onDialogCancel},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Ae={class:"q-pa-md"},qe={class:"row q-pb-md"},$e=i("div",{class:"col"},[i("span",{class:"text-h4"},"Incoming")],-1),Ee={class:"col text-right"},He={class:"row q-pt-md"},xe={class:"col"},el={__name:"incomingIndex",setup(F){const I=B(),n=p([]),f=p([{name:"TRCV_RCVCD",label:"Receive ID",field:"TRCV_RCVCD",sortable:!0,align:"left"},{name:"MSUP_SUPNM",label:"Supplier Name",field:"MSUP_SUPNM",sortable:!0,align:"left"},{name:"TOT_RCV",label:"Total Qty",field:"TOT_RCV",sortable:!0,align:"left"},{name:"TOT_AMT",label:"Total Amount",field:"TOT_AMT",sortable:!0,align:"left"}]),c=p(!1),t=p(""),T=p("");H(()=>{U()});const U=async()=>{c.value=!0,await O.post("receive/searchAPI",{searchBy:t.value,searchValue:T.value}).then(_=>{c.value=!1,n.value=_.data.data}).catch(_=>{c.value=!1})},b=(_=[])=>{I.dialog({component:Le,componentProps:{dataHeader:_}}).onOk(async m=>{getOutgoingData()})};return(_,m)=>(v(),g("div",Ae,[i("div",qe,[$e,i("div",Ee,[a(D,{icon:"add",color:"blue",onClick:m[0]||(m[0]=d=>b())},{default:o(()=>[a(w,null,{default:o(()=>[V("Create New Delivery")]),_:1})]),_:1})])]),a(ie),i("div",He,[i("div",xe,[a(ue,{title:"Outgoing List",rows:n.value,columns:f.value,"row-key":"TDLVORD_DLVCD",loading:c.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":o(()=>[a(S,{outlined:"",modelValue:t.value,"onUpdate:modelValue":m[1]||(m[1]=d=>t.value=d),options:_.columns,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),a(h,{borderless:"",dense:"",modelValue:T.value,"onUpdate:modelValue":[m[2]||(m[2]=d=>T.value=d),m[3]||(m[3]=d=>_.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:o(()=>[a(x,{name:"search"})]),_:1},8,["modelValue"])]),header:o(d=>[a($,{props:d},{default:o(()=>[(v(!0),g(Q,null,k(d.cols,C=>(v(),y(q,{key:C.name,props:d},{default:o(()=>[V(M(C.label),1)]),_:2},1032,["props"]))),128)),a(q,{"auto-width":""},{default:o(()=>[V("Action")]),_:1})]),_:2},1032,["props"])]),body:o(d=>[a($,{props:d},{default:o(()=>[(v(!0),g(Q,null,k(d.cols,C=>(v(),y(E,{key:C.name,props:d},{default:o(()=>[V(M(C.value),1)]),_:2},1032,["props"]))),128)),a(E,{"auto-width":""},{default:o(()=>[a(D,{flat:"",color:"orange",icon:"edit",onClick:C=>b(d.row),dense:""},{default:o(()=>[a(w,null,{default:o(()=>[V("Edit Data")]),_:1})]),_:2},1032,["onClick"]),a(D,{flat:"",color:"red",icon:"delete",onClick:C=>_.onDelete(d.row.TDLVORD_DLVCD),dense:""},{default:o(()=>[a(w,null,{default:o(()=>[V("Edit Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{el as default};
