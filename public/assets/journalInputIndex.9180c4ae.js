import{t as p,o as F,C as v,D as L,E as t,F as e,M as j,O as w,J as l,$ as h,at as U,U as J,Q as T,R as I,S as A,T as V,P as G,X as K,Y as k,Z as X,aM as Z,I as H}from"./index.e4256195.js";import{e as P}from"./QSelect.1cb830e2.js";import{u as z,a as W,b as E}from"./QTable.faac82b8.js";import{Q as M,a as Q}from"./QTd.cc4b8f31.js";import{Q as ee}from"./QTooltip.75235479.js";import{u as $}from"./format.ae98d5c9.js";import{api_web as O}from"./axios.da396732.js";import{Q as le}from"./QBtnToggle.5b7cd966.js";import{Q as ae,a as oe,C as te}from"./ClosePopup.156ce8d7.js";import"./QBtnGroup.eeade0e6.js";import"./use-render-cache.3aae9b27.js";import"./date.2639ddde.js";const se=l("div",{class:"text-h6"},"Closing Period",-1),ne={style:{border:"1px black solid","border-radius":"10px"}},de=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Header")],-1),ie={class:"row q-col-gutter-sm"},ue={class:"col-12"},re={class:"row q-col-gutter-sm q-pt-sm"},ce={class:"col-12 col-sm-6"},me={class:"col-12 col-sm-6"},_e={class:"row items-center justify-end"},pe={style:{border:"1px black solid","border-radius":"10px"}},ve=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Detail")],-1),Ce={class:"row q-col-gutter-sm q-pt-sm"},fe={class:"col-12 col-sm-12 text-right"},Te={class:"col-12 col-sm-3"},ge={class:"col-12 col-sm-2"},he={class:"col-12 col-sm-3"},Ie={class:"col-12 col-sm-3"},Se={class:"col-12 col-sm-1"},be={key:1,class:"row q-col-gutter-sm q-pt-sm"},De={class:"col-12 text-center"},He={__name:"journalInputCreate",props:{header:String},setup(y){const S=$(),a=p({GLHIST_DOC:"",GLHIST_EFFDT:"",MCOA_TYPE:"INC"}),_=p([]),u=p(!1),g=p([]),r=y;F(async()=>{r.header&&r.header!==""&&(console.log(r.header),a.value.GLHIST_DOC=r.header.GLHIST_DOC,a.value.GLHIST_EFFDT=r.header.GLHIST_EFFDT,a.value.MCOA_TYPE=r.header.MCOA_TYPE)});const{dialogRef:b,onDialogHide:D,onDialogOK:c,onDialogCancel:m}=z(),n=(d,s,o,f)=>{s(async()=>{f==="coa"&&await C(d)})},C=async(d,s="MCOA_COACD")=>{u.value=!0,await O.post("coa/searchAPI",{searchValue:d,searchCol:s}).then(o=>{u.value=!1,g.value=o.data.data}).catch(()=>{u.value=!1})},R=()=>{_.value.push({GLHIST_ACC:a.value.GLHIST_ACC,GLHIST_DOC:a.value.GLHIST_DOC,GLHIST_AMT:0,GLHIST_DESC:"",GLHIST_EFFDT:a.value.GLHIST_EFFDT,MCOA_TYPE:a.value.MCOA_TYPE})},q=d=>{S.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${d+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{_.value.splice(d,1)})},x=(d,s)=>{let o=g.value.filter(f=>f.MCOA_COACD===d);o.length>0&&(_.value[s].GLHIST_CURR=o[0].MCOA_CURR)},Y=()=>{S.dialog({title:"Confirmation",message:"Are you sure want to save this journal ?",cancel:!0,persistent:!0}).onOk(async()=>{u.value=!0,await O.post(`acc/journal${a.value.GLHIST_DOC?`/${btoa(a.value.GLHIST_DOC)}`:null}`,{...a.value,det:_.value}).then(d=>{u.value=!1,S.notify({color:"green",message:`${d.data.msg}`}),c()}).catch(d=>{u.value=!1})})};return(d,s)=>(v(),L(X,{ref_key:"dialogRef",ref:b,onHide:k(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:t(()=>[e(j,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:t(()=>[e(w,null,{default:t(()=>[se]),_:1}),e(w,{class:"q-pa-sm"},{default:t(()=>[l("fieldset",ne,[de,l("div",ie,[l("div",ue,[e(le,{modelValue:a.value.MCOA_TYPE,"onUpdate:modelValue":s[0]||(s[0]=o=>a.value.MCOA_TYPE=o),spread:"",class:"my-custom-toggle","no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Income",value:"INC"},{label:"Expense",value:"OUT"}]},null,8,["modelValue"])])]),l("div",re,[l("div",ce,[e(h,{filled:"",label:"Doc Reference",modelValue:a.value.GLHIST_DOC,"onUpdate:modelValue":s[1]||(s[1]=o=>a.value.GLHIST_DOC=o),readonly:"",dense:""},null,8,["modelValue"])]),l("div",me,[e(h,{filled:"",modelValue:a.value.GLHIST_EFFDT,"onUpdate:modelValue":s[3]||(s[3]=o=>a.value.GLHIST_EFFDT=o),label:"Eff Date",dense:""},{prepend:t(()=>[e(U,{name:"event",class:"cursor-pointer"},{default:t(()=>[e(ae,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:t(()=>[e(oe,{modelValue:a.value.GLHIST_EFFDT,"onUpdate:modelValue":s[2]||(s[2]=o=>a.value.GLHIST_EFFDT=o),mask:"YYYY-MM-DD"},{default:t(()=>[l("div",_e,[J(e(T,{label:"Close",color:"primary",flat:""},null,512),[[te]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),l("fieldset",pe,[ve,l("div",Ce,[l("div",fe,[e(T,{flat:"",color:"primary",icon:"add",onClick:R})])]),_.value.length>0?(v(!0),I(A,{key:0},V(_.value,(o,f)=>(v(),I("div",{class:"row q-col-gutter-sm q-pt-sm",key:f},[l("div",Te,[e(P,{filled:"",label:"Account Code",modelValue:o.GLHIST_ACC,"onUpdate:modelValue":[i=>o.GLHIST_ACC=i,i=>x(i,f)],"use-input":"","input-debounce":"500",options:g.value,onFilter:s[4]||(s[4]=(i,B,N)=>n(i,B,N,"coa")),behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD","emit-value":"","map-options":"",loading:u.value,dense:""},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),l("div",ge,[e(h,{filled:"",label:"Valuta",modelValue:o.GLHIST_CURR,"onUpdate:modelValue":i=>o.GLHIST_CURR=i,dense:""},null,8,["modelValue","onUpdate:modelValue"])]),l("div",he,[e(h,{filled:"",label:"Description",modelValue:o.GLHIST_DESC,"onUpdate:modelValue":i=>o.GLHIST_DESC=i,dense:""},null,8,["modelValue","onUpdate:modelValue"])]),l("div",Ie,[e(h,{filled:"",label:"Amount",modelValue:o.GLHIST_AMT,"onUpdate:modelValue":i=>o.GLHIST_AMT=i,dense:""},null,8,["modelValue","onUpdate:modelValue"])]),l("div",Se,[e(T,{icon:"delete",onClick:i=>q(f),flat:"",color:"red"},null,8,["onClick"])])]))),128)):(v(),I("div",be,[l("div",De," Click + button to add "+G(a.value.MCOA_TYPE==="INC"?"Income":"Expense"),1)]))])]),_:1}),e(K,{align:"right"},{default:t(()=>[e(T,{label:"OK",color:"primary",onClick:s[5]||(s[5]=o=>Y()),disable:d.stateSubmit,loading:u.value},null,8,["disable","loading"]),e(T,{flat:"",label:"Cancel",color:"red",onClick:k(m)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Le={class:"q-pa-md"},Ae={class:"row q-pb-md"},Ve=l("div",{class:"col"},[l("span",{class:"text-h4"},"Journal Input")],-1),Ge={class:"col text-right"},Oe={class:"row q-pt-md"},ye={class:"col"},Ye={__name:"journalInputIndex",setup(y){const S=$(),a=p("GLHIST_DOC"),_=p(""),u=p([]),g=p([{name:"GLHIST_DOC",label:"Journal Doc",field:"GLHIST_DOC",sortable:!0,align:"left"},{name:"GLHIST_CURR",label:"Valuta",field:"GLHIST_CURR",sortable:!0,align:"left"},{name:"GLHIST_AMT_DB",label:"Debit",field:"GLHIST_AMT_DB",sortable:!0,format:c=>c.toLocaleString(),align:"left"},{name:"GLHIST_AMT_CR",label:"Credit",field:"GLHIST_AMT_CR",sortable:!0,format:c=>c.toLocaleString(),align:"left"}]),r=p(!1);F(()=>{b()});const b=async()=>{r.value=!0,await O.post("acc/journal/searchAPI",{searchBy:a.value,searchValue:_.value}).then(c=>{r.value=!1,u.value=c.data.data}).catch(c=>{r.value=!1})},D=(c=null)=>{S.dialog({component:He,componentProps:{header:c}}).onOk(async m=>{b()})};return(c,m)=>(v(),I("div",Le,[l("div",Ae,[Ve,l("div",Ge,[e(T,{icon:"add",color:"primary",onClick:m[0]||(m[0]=n=>D())})])]),e(Z),l("div",Oe,[l("div",ye,[e(W,{title:"Journal History",rows:u.value,columns:g.value,"row-key":"name",loading:r.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":t(()=>[e(P,{outlined:"",modelValue:a.value,"onUpdate:modelValue":m[1]||(m[1]=n=>a.value=n),options:g.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(h,{borderless:"",dense:"",modelValue:_.value,"onUpdate:modelValue":[m[2]||(m[2]=n=>_.value=n),m[3]||(m[3]=n=>b())],placeholder:"Search",outlined:"",debounce:"1000"},{append:t(()=>[e(U,{name:"search"})]),_:1},8,["modelValue"])]),header:t(n=>[e(M,{props:n},{default:t(()=>[e(E,{"auto-width":""},{default:t(()=>[H("Action")]),_:1}),(v(!0),I(A,null,V(n.cols,C=>(v(),L(E,{key:C.name,props:n},{default:t(()=>[H(G(C.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:t(n=>[e(M,{props:n},{default:t(()=>[e(Q,{"auto-width":""},{default:t(()=>[e(T,{flat:"",color:"orange",icon:"edit",onClick:C=>D(n.row),dense:""},{default:t(()=>[e(ee,null,{default:t(()=>[H("Journal Edit")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(v(!0),I(A,null,V(n.cols,C=>(v(),L(Q,{key:C.name,props:n},{default:t(()=>[H(G(C.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Ye as default};
