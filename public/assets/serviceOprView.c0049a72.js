import{o as F,s as v,B as m,C as I,D as a,E as e,J as $,K as C,I as s,R as M,Q as g,aY as Q,aW as H,H as _,ap as N,aU as Y,aV as B,aZ as K,aX as u,P as E,L as j,M as U,O as J,aa as ee,S as ae}from"./index.c32b91cf.js";import{u as W,b as q,Q as X,j as P,k as f,l as O,c as le,a as te}from"./use-dialog-plugin-component.2a41e516.js";import{d as Z}from"./date.7a0bbbc2.js";import{api_web as A}from"./axios.ae697e82.js";import{Q as L}from"./QTooltip.7d121585.js";import{Q as oe}from"./QBadge.33f9712c.js";const se={class:"row"},ne=s("div",{class:"col"},[s("div",{class:"text-h6"},"Update Used Item")],-1),ie={key:0,class:"col text-right"},de={__name:"serviceOprItemAdd",props:{mode:String,dataItem:Array},setup(T){const{dialogRef:y,onDialogHide:D,onDialogOK:p,onDialogCancel:S}=W(),h=q(),n=T;F(()=>{n.dataItem.listFixDet&&(o.value=n.dataItem.listFixDet)});const t=v([]),o=v([]),l=v(!1),d=()=>{o.value.push({TSRVD_ID:n.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},x=(r,c,R,k)=>{c(async()=>{k==="item"&&await b(r)})},b=async r=>{l.value=!0,await A.post("item/searchAPITBL",{searchValue:r}).then(c=>{l.value=!1,t.value=c.data.data}).catch(()=>{l.value=!1})},V=()=>{n.mode==="view"?p(o.value):h.dialog({title:"Confirmation",message:"Are you sure want to save this items ?",cancel:!0,persistent:!0}).onOk(async()=>{p(o.value)})},i=r=>{h.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${r+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{o.value.splice(r,1)})};return(r,c)=>(m(),I(J,{ref_key:"dialogRef",ref:y,onHide:U(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(C,null,{default:a(()=>[s("div",se,[ne,n.mode!=="view"?(m(),M("div",ie,[e(g,{icon:"add",outline:"",color:"blue",onClick:d})])):Q("",!0)])]),_:1}),e(C,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:a(()=>[e(X,{bordered:""},{default:a(()=>[o.value.length===0?H((m(),I(P,{key:0,class:"q-my-sm",clickable:""},{default:a(()=>[e(f,null,{default:a(()=>[_(" No items added ")]),_:1})]),_:1})),[[N]]):Q("",!0),(m(!0),M(Y,null,B(o.value,(R,k)=>H((m(),I(P,{key:k,class:"q-my-sm",clickable:""},{default:a(()=>[e(f,{avatar:""},{default:a(()=>[e(K,{color:"primary","text-color":"white"},{default:a(()=>[_(u(k+1),1)]),_:2},1024)]),_:2},1024),e(f,null,{default:a(()=>[e(O,null,{default:a(()=>[e(le,{dense:"",filled:"",label:"Item Name",modelValue:R.TSRVF_ITMCD,"onUpdate:modelValue":w=>R.TSRVF_ITMCD=w,"use-input":"","input-debounce":"500",options:t.value,onFilter:c[0]||(c[0]=(w,z,G)=>x(w,z,G,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:l.value,readonly:n.mode==="view"},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"])]),_:2},1024)]),_:2},1024),e(f,null,{default:a(()=>[e(E,{label:"Price",modelValue:R.TSRVF_PRC,"onUpdate:modelValue":w=>R.TSRVF_PRC=w,filled:"",dense:"",readonly:n.mode==="view"},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024),T.mode!=="view"?(m(),I(f,{key:0,side:""},{default:a(()=>[e(g,{icon:"delete",flat:"",color:"red",onClick:w=>i(k)},null,8,["onClick"])]),_:2},1024)):Q("",!0)]),_:2},1024)),[[N]])),128))]),_:1})]),_:1}),e(j,{align:"right"},{default:a(()=>[e(g,{label:"OK",color:"primary",onClick:c[1]||(c[1]=R=>V()),disable:l.value,loading:l.value},null,8,["disable","loading"]),e(g,{flat:"",label:"Cancel",color:"red",onClick:U(S),loading:l.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},re={class:"text-h6"},ue={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(T){const{dialogRef:y,onDialogHide:D,onDialogOK:p,onDialogCancel:S}=W(),h=q(),n=T,t=v({SRVH_DOCNO:"",SRVH_ISSDT:Z.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),o=v([]),l=v(!1);F(async()=>{n.header&&(t.value=n.header,o.value=n.detail)});const d=(b,V="add")=>{h.dialog({component:de,componentProps:{mode:V,dataItem:o.value[b]}}).onOk(async i=>{o.value[b].listFixDet=i})},x=()=>{h.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{l.value=!0,await A.post("servicesOPR",{data:o.value}).then(b=>{l.value=!1,p()})})};return(b,V)=>(m(),I(J,{ref_key:"dialogRef",ref:y,onHide:U(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(C,null,{default:a(()=>[s("div",re,"Update Order "+u(t.value.SRVH_DOCNO),1)]),_:1}),e(C,{class:"q-pa-sm"},{default:a(()=>[e(X,{bordered:""},{default:a(()=>[(m(!0),M(Y,null,B(o.value,(i,r)=>H((m(),I(P,{key:r,class:"q-my-sm",clickable:""},{default:a(()=>[e(f,{avatar:""},{default:a(()=>[e(K,{color:"primary","text-color":"white"},{default:a(()=>[_(u(i.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),e(f,null,{default:a(()=>[e(O,null,{default:a(()=>[_(u(i.TSRVD_ITMCD),1)]),_:2},1024),e(O,{caption:"",lines:"1"},{default:a(()=>[_("Item")]),_:1})]),_:2},1024),e(f,null,{default:a(()=>[e(O,null,{default:a(()=>[_(u(i.TSRVD_CUSTRMK),1)]),_:2},1024),e(O,{caption:"",lines:"1"},{default:a(()=>[_("Customer Remarks")]),_:1})]),_:2},1024),e(f,{side:""},{default:a(()=>[e(g,{icon:"construction",color:"green",flat:"",onClick:c=>d(r,"add")},{default:a(()=>[e(L,null,{default:a(()=>[_("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(f,{side:""},{default:a(()=>[e(g,{icon:"visibility",color:"cyan",flat:"",onClick:c=>d(r,"view"),disable:!i.listFixDet},{default:a(()=>[e(L,null,{default:a(()=>[_("View Added Item")]),_:1}),e(oe,{color:"red",floating:""},{default:a(()=>[_(u(i.listFixDet.length),1)]),_:2},1024)]),_:2},1032,["onClick","disable"])]),_:2},1024)]),_:2},1024)),[[N]])),128))]),_:1})]),_:1}),e(j,{align:"right"},{default:a(()=>[e(g,{label:"OK",color:"primary",onClick:V[0]||(V[0]=i=>x()),disable:l.value||o.value.filter(i=>i.listFixDet).length===0,loading:l.value},null,8,["disable","loading"]),e(g,{flat:"",label:"Cancel",color:"red",onClick:U(S),loading:l.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},ce={class:"q-pa-md"},_e={class:"row"},me={class:"col"},fe={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ve={class:"text-h5 text-bold"},pe={class:"text-h6 text-bold"},ge={class:"text-subtitle2"},Se={class:"text-h6 text-bold"},he=s("div",{class:"text-subtitle2"},"Resolved Items",-1),Ce={class:"row"},De={class:"col"},be=s("div",{class:"col text-right"},null,-1),ke={__name:"serviceOprView",setup(T){const y=q();v([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:t=>t.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:t=>t.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const D=v([]),p=v(""),S=v(!1);F(()=>{h()});const h=async()=>{S.value=!0,await A.post("servicesOPR/search",{searchBy:"",searchValue:p.value}).then(t=>{S.value=!1,D.value=t.data.data}).catch(t=>{S.value=!1})},n=t=>{const o={SRVH_DOCNO:t.SRVH_DOCNO,SRVH_ISSDT:Z.formatDate(t.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:t.MCUS_CUSCD};let l=[];t.detail.map(d=>{l.push({TSRVD_ITMCD:d.TSRVD_ITMCD,TSRVD_LINE:d.TSRVD_LINE,TSRVD_QTY:d.TSRVD_QTY,TSRVD_CUSTRMK:d.TSRVD_CUSTRMK})}),y.dialog({component:ue,componentProps:{header:o,detail:l}}).onOk(async d=>{h()})};return(t,o)=>(m(),M("div",ce,[s("div",_e,[s("div",me,[e(te,{grid:"",flat:"",bordered:"","card-container-class":t.cardContainerClass,title:"Outstanding Order",rows:D.value,columns:t.columns,"row-key":"name",filter:p.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":t.rowsPerPageOptions,loading:S.value},{"top-right":a(()=>[e(E,{borderless:"",dense:"",debounce:"300",modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=l=>p.value=l),placeholder:"Search"},{append:a(()=>[e(ee,{name:"search"})]),_:1},8,["modelValue"])]),item:a(l=>[s("div",fe,[e($,{flat:"",bordered:""},{default:a(()=>[e(C,{class:"text-center bg-secondary text-white"},{default:a(()=>[s("div",ve,u(l.row.SRVH_DOCNO),1)]),_:2},1024),e(ae),e(C,null,{default:a(()=>[s("div",pe,u(l.row.MCUS_CUSNM),1),s("div",ge,u(l.row.SRVH_ISSDT),1)]),_:2},1024),e(C,null,{default:a(()=>[s("div",Se,u(l.row.resolve.length)+" of "+u(l.row.unresolve.length),1),he]),_:2},1024),e(C,null,{default:a(()=>[s("div",Ce,[s("div",De,[e(g,{label:"Resolve",color:"primary",outline:"",onClick:d=>n(l.row)},null,8,["onClick"])]),be])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{ke as default};
