import{Q as m}from"./QTooltip.ff82f902.js";import{s as c,B as v,C as Q,D as l,E as e,L as K,M as y,I as o,Z as A,am as I,T as h,Q as r,O as i,P as b,R,S as w,U as Z,H as n,V as z,X as J,Y as W,o as ee,aX as le}from"./index.db90c568.js";import{a as B,u as ae,l as G,Q as te,b as k,c as S,d as _,k as oe,m as M}from"./QTable.79437d04.js";import{Q as N,a as $}from"./QTd.8ba9e4b1.js";import{api_web as H,api as ne}from"./axios.e2871045.js";import{Q as Y,a as x,C as F}from"./ClosePopup.d5d8e4f4.js";import"./use-cache.b0833c75.js";import"./date.232f4e07.js";const se=o("div",{class:"text-h6"},"RO Maintenance",-1),de={style:{border:"1px black solid","border-radius":"10px"}},ie=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),ue={class:"row"},re={class:"col"},_e={class:"col q-pl-md"},Te={class:"row items-center justify-end"},ce={class:"col q-pl-md"},De={class:"row items-center justify-end"},Oe={class:"row"},fe={class:"col"},me={class:"col q-pl-md"},Se={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},ve=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Detail Items")],-1),pe={class:"row q-pb-md"},Le={class:"col"},Ce={class:"text-h6"},Ee={class:"col text-right"},Ae={class:"row"},Qe={class:"col"},ge={__name:"salesOrderCreate",setup(q){const U=B(),d=c({TSLO_SLOCD:"",TSLO_ISSUDT:"",TSLO_PLAN_DLVDT:"",TSLO_QUOCD:"",TSLO_POCD:""});c(""),c("");const C=c([]),u=c(!1),E=c(1),D=c([]),g=(T,t,a,L)=>{t(async()=>{L==="quotation"&&await P(T)})},P=async(T="")=>{u.value=!0,await H.post("quotation/search",{searchBy:"MCUS_CUSNM",searchValue:T}).then(t=>{u.value=!1,C.value=t.data.data}).catch(t=>{u.value=!1})},O=()=>E.value===1?"Rental":E.value===2?"Sales":"Service",p=async T=>{console.log(T),u.value=!0,await ne.get(`transaction/quotation/view/${btoa(T)}`).then(t=>{u.value=!1,t.data.data.det.map(a=>{D.value.push({TSLODETA_ITMCD:a.TQUODETA_ITMCD,TSLODETA_ITMQT:a.TQUODETA_ITMQT,TSLODETA_USAGE:a.TQUODETA_USAGE,TSLODETA_PRC:a.TQUODETA_PRC,TSLODETA_PERIOD_FR:a.TQUODETA_PERIOD_FR,TSLODETA_PERIOD_TO:a.TQUODETA_PERIOD_TO})})}).catch(t=>{u.value=!1})},s=()=>{D.value.push({TSLODETA_ITMCD:"",TSLODETA_ITMQT:"",TSLODETA_USAGE:"",TSLODETA_PRC:0,TSLODETA_PERIOD_FR:"",TSLODETA_PERIOD_TO:""})},f=T=>{U.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${T+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{D.value.splice(T,1)})},{dialogRef:j,onDialogHide:X,onDialogOK:we,onDialogCancel:Ve}=ae();return(T,t)=>(v(),Q(W,{ref_key:"dialogRef",ref:j,onHide:J(X),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(K,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(y,null,{default:l(()=>[se]),_:1}),e(y,{class:"q-pa-sm"},{default:l(()=>[o("fieldset",de,[ie,o("div",ue,[o("div",re,[e(A,{label:"RO Code",dense:"",filled:"",modelValue:d.value.TSLO_SLOCD,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value.TSLO_SLOCD=a),disable:"",loading:u.value},null,8,["modelValue","loading"])]),o("div",_e,[e(A,{filled:"",modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value.TSLO_ISSUDT=a),dense:"",label:"Issue Date",loading:u.value,onClick:t[3]||(t[3]=a=>T.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(I,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(x,{modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":t[1]||(t[1]=a=>d.value.TSLO_ISSUDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",Te,[h(e(r,{label:"Close",color:"primary",flat:""},null,512),[[F]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])]),o("div",ce,[e(A,{filled:"",modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":t[5]||(t[5]=a=>d.value.TSLO_PLAN_DLVDT=a),dense:"",label:"Delivery Date",loading:u.value,onClick:t[6]||(t[6]=a=>T.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(I,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(Y,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(x,{modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":t[4]||(t[4]=a=>d.value.TSLO_PLAN_DLVDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",De,[h(e(r,{label:"Close",color:"primary",flat:""},null,512),[[F]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),o("div",Oe,[o("div",fe,[e(G,{dense:"",filled:"",label:"Sales Quotation Code",modelValue:d.value.TSLO_QUOCD,"onUpdate:modelValue":[t[7]||(t[7]=a=>d.value.TSLO_QUOCD=a),p],"use-input":"","input-debounce":"500",options:C.value,onFilter:t[8]||(t[8]=(a,L,V)=>g(a,L,V,"quotation")),behavior:"dialog","option-label":"DESCSEL","option-value":"TQUO_QUOCD","emit-value":"","map-options":"",loading:u.value},null,8,["modelValue","options","loading"])]),o("div",me,[e(A,{label:"PO Number",dense:"",filled:"",modelValue:d.value.TSLO_POCD,"onUpdate:modelValue":t[9]||(t[9]=a=>d.value.TSLO_POCD=a),loading:u.value},null,8,["modelValue","loading"])])])]),o("fieldset",Se,[ve,o("div",pe,[o("div",Le,[o("span",Ce,i(O()),1)]),o("div",Ee,[e(r,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:s,loading:u.value},null,8,["loading"])])]),o("div",Ae,[o("div",Qe,[e(te,{bordered:"",dense:""},{default:l(()=>[D.value.length>0?(v(!0),b(R,{key:0},w(D.value,(a,L)=>(v(),Q(k,{key:L,class:"q-my-sm",dense:""},{default:l(()=>[e(S,{avatar:""},{default:l(()=>[e(Z,{"text-color":"blue"},{default:l(()=>[n(i(L+1),1)]),_:2},1024)]),_:2},1024),e(S,null,{default:l(()=>[e(_,{class:"text-center"},{default:l(()=>[n(i(a.TSLODETA_ITMCD)+" ",1),e(r,{icon:a.TSLODETA_ITMCD?"edit":"add",color:a.TSLODETA_ITMCD?"orange":"blue",dense:"",flat:""},{default:l(()=>[e(m,null,{default:l(()=>[n(i(a.TSLODETA_ITMCD?"Edit Data":"Add Data"),1)]),_:2},1024)]),_:2},1032,["icon","color"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[n(" Item Name ")]),_:1})]),_:2},1024),e(S,null,{default:l(()=>[e(_,null,{default:l(()=>[n(i(a.TSLODETA_ITMQT)+" ",1),e(r,{icon:a.TSLODETA_ITMQT?"edit":"add",color:a.TSLODETA_ITMQT?"orange":"blue",dense:"",flat:""},{default:l(()=>[e(m,null,{default:l(()=>[n(i(a.TSLODETA_ITMQT?"Edit Data":"Add Data"),1)]),_:2},1024)]),_:2},1032,["icon","color"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[n(" Qty ")]),_:1})]),_:2},1024),e(S,null,{default:l(()=>[e(_,null,{default:l(()=>[n(i(a.TSLODETA_USAGE)+" ",1),e(r,{icon:a.TSLODETA_USAGE?"edit":"add",color:a.TSLODETA_USAGE?"orange":"blue",dense:"",flat:""},{default:l(()=>[e(m,null,{default:l(()=>[n(i(a.TSLODETA_USAGE?"Edit Data":"Add Data"),1)]),_:2},1024)]),_:2},1032,["icon","color"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[n(" Usage ")]),_:1})]),_:2},1024),e(S,null,{default:l(()=>[e(_,null,{default:l(()=>[n(i(a.TSLODETA_PRC)+" ",1),e(r,{icon:a.TSLODETA_PRC?"edit":"add",color:a.TSLODETA_PRC?"orange":"blue",dense:"",flat:""},{default:l(()=>[e(m,null,{default:l(()=>[n(i(a.TSLODETA_PRC?"Edit Data":"Add Data"),1)]),_:2},1024)]),_:2},1032,["icon","color"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[n(" Price ")]),_:1})]),_:2},1024),e(S,null,{default:l(()=>[e(_,null,{default:l(()=>[n(i(a.TSLODETA_PERIOD_FR)+" ",1),e(r,{icon:a.TSLODETA_PERIOD_FR?"edit":"add",color:a.TSLODETA_PERIOD_FR?"orange":"blue",dense:"",flat:""},{default:l(()=>[e(m,null,{default:l(()=>[n(i(a.TSLODETA_PERIOD_FR?"Edit Data":"Add Data"),1)]),_:2},1024)]),_:2},1032,["icon","color"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[n(" Period From ")]),_:1})]),_:2},1024),e(S,null,{default:l(()=>[e(_,null,{default:l(()=>[n(i(a.TSLODETA_PERIOD_TO)+" ",1),e(r,{icon:a.TSLODETA_PERIOD_TO?"edit":"add",color:a.TSLODETA_PERIOD_TO?"orange":"blue",dense:"",flat:""},{default:l(()=>[e(m,null,{default:l(()=>[n(i(a.TSLODETA_PERIOD_TO?"Edit Data":"Add Data"),1)]),_:2},1024)]),_:2},1032,["icon","color"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[n(" Period To ")]),_:1})]),_:2},1024),e(S,{side:""},{default:l(()=>[e(r,{icon:"delete",color:"red",flat:"",onClick:V=>f(L)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)):h((v(),Q(k,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(S,null,{default:l(()=>[e(_,null,{default:l(()=>[n(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[z]])]),_:1})])])])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const be={class:"q-pa-md"},Ue={class:"row q-pb-md"},Pe=o("div",{class:"col"},[o("span",{class:"text-h4"},"Sales Order / Receive Order")],-1),he={class:"col text-right"},Ie={class:"row q-pt-md"},Re={class:"col"},Be={__name:"salesOrderView",setup(q){const U=B(),d=c("TQUO_QUOCD"),C=c(""),u=c([]),E=c([{name:"TSLO_SLOCD",label:"RO. Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_ADDRESS_NAME",label:"Customer Addr.",field:"TSLO_ADDRESS_NAME",sortable:!0,align:"left"},{name:"TSLO_CUSCD",label:"Customer Code",field:"TSLO_CUSCD",sortable:!0,align:"left"},{name:"TSLO_ISSUDT",label:"Issue Date",field:"TSLO_ISSUDT",sortable:!0,align:"left"},{name:"TSLO_QUOCD",label:"Quot. Code",field:"TSLO_QUOCD",sortable:!0,align:"left"}]),D=c(!1);ee(()=>{g()});const g=async()=>{D.value=!0,await H.post("receive-order/searchAPI",{searchBy:d.value,searchValue:C.value}).then(O=>{D.value=!1,u.value=O.data.data}).catch(O=>{D.value=!1})},P=()=>{U.dialog({component:ge}).onOk(async O=>{g()})};return(O,p)=>(v(),b("div",be,[o("div",Ue,[Pe,o("div",he,[e(r,{icon:"add",color:"blue",onClick:P},{default:l(()=>[e(m,null,{default:l(()=>[n("Create New RO")]),_:1})]),_:1})])]),e(le),o("div",Ie,[o("div",Re,[e(oe,{title:"Created RO",rows:u.value,columns:E.value,"row-key":"name",loading:D.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(G,{outlined:"",modelValue:d.value,"onUpdate:modelValue":p[0]||(p[0]=s=>d.value=s),options:E.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(A,{borderless:"",dense:"",modelValue:C.value,"onUpdate:modelValue":[p[1]||(p[1]=s=>C.value=s),p[2]||(p[2]=s=>O.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(I,{name:"search"})]),_:1},8,["modelValue"])]),header:l(s=>[e(N,{props:s},{default:l(()=>[e(M,{"auto-width":""},{default:l(()=>[n("Action")]),_:1}),(v(!0),b(R,null,w(s.cols,f=>(v(),Q(M,{key:f.name,props:s},{default:l(()=>[n(i(f.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(s=>[e(N,{props:s},{default:l(()=>[e($,{"auto-width":""},{default:l(()=>[e(r,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"orange",icon:"edit",onClick:f=>O.onClickEdit(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(m,null,{default:l(()=>[n(i(s.row.TQUO_APPRVDT?"Quotation already approved, cannot edit !":"Edit this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(r,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"red",icon:"delete",onClick:f=>O.onClickDelete(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(m,null,{default:l(()=>[n(i(s.row.TQUO_APPRVDT?"Quotation already approved, cannot delete !":"Delete this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(r,{flat:"",color:"indigo",icon:"print",onClick:f=>O.onClickPrint(s.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(m,null,{default:l(()=>[n("Print this quotation")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(v(!0),b(R,null,w(s.cols,f=>(v(),Q($,{key:f.name,props:s},{default:l(()=>[n(i(f.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Be as default};
