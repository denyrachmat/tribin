import{o as F,s as g,B as c,C as I,D as a,E as e,J as $,K as D,I as s,R as U,Q as p,aY as H,aW as N,H as u,ap as x,aU as Y,aV as B,aZ as K,aX as d,P as E,L as j,M as Q,O as J,aa as ee,S as ae}from"./index.547ac40c.js";import{u as W,b as q,Q as X,j as P,k as _,l as M,c as le,a as te}from"./use-dialog-plugin-component.5fcd49a8.js";import{d as Z}from"./date.56f970ac.js";import{api_web as A}from"./axios.48caa64e.js";import{Q as L}from"./QTooltip.56f30ab3.js";import{Q as oe}from"./QBadge.9a95c49d.js";const se={class:"row"},ne=s("div",{class:"col"},[s("div",{class:"text-h6"},"Update Used Item")],-1),ie={key:0,class:"col text-right"},de={__name:"serviceOprItemAdd",props:{mode:String,dataItem:Array},setup(T){const{dialogRef:y,onDialogHide:b,onDialogOK:m,onDialogCancel:S}=W(),h=q(),n=T;F(()=>{n.dataItem.listFixDet&&(o.value=n.dataItem.listFixDet)});const t=g([]),o=g([]),l=g(!1),r=()=>{o.value.push({TSRVD_ID:n.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},f=(v,C,R,O)=>{C(async()=>{O==="item"&&await V(v)})},V=async v=>{l.value=!0,await A.post("item/searchAPITBL",{searchValue:v}).then(C=>{l.value=!1,t.value=C.data.data}).catch(()=>{l.value=!1})},i=()=>{n.mode==="view"?m(o.value):h.dialog({title:"Confirmation",message:"Are you sure want to save this items ?",cancel:!0,persistent:!0}).onOk(async()=>{m(o.value)})},k=v=>{h.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${v+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{o.value.splice(v,1)})};return(v,C)=>(c(),I(J,{ref_key:"dialogRef",ref:y,onHide:Q(b),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(D,null,{default:a(()=>[s("div",se,[ne,n.mode!=="view"?(c(),U("div",ie,[e(p,{icon:"add",outline:"",color:"blue",onClick:r})])):H("",!0)])]),_:1}),e(D,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:a(()=>[e(X,{bordered:""},{default:a(()=>[o.value.length===0?N((c(),I(P,{key:0,class:"q-my-sm",clickable:""},{default:a(()=>[e(_,null,{default:a(()=>[u(" No items added ")]),_:1})]),_:1})),[[x]]):H("",!0),(c(!0),U(Y,null,B(o.value,(R,O)=>N((c(),I(P,{key:O,class:"q-my-sm",clickable:""},{default:a(()=>[e(_,{avatar:""},{default:a(()=>[e(K,{color:"primary","text-color":"white"},{default:a(()=>[u(d(O+1),1)]),_:2},1024)]),_:2},1024),e(_,null,{default:a(()=>[e(M,null,{default:a(()=>[e(le,{dense:"",filled:"",label:"Item Name",modelValue:R.TSRVF_ITMCD,"onUpdate:modelValue":w=>R.TSRVF_ITMCD=w,"use-input":"","input-debounce":"500",options:t.value,onFilter:C[0]||(C[0]=(w,z,G)=>f(w,z,G,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:l.value,readonly:n.mode==="view"},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"])]),_:2},1024)]),_:2},1024),e(_,null,{default:a(()=>[e(E,{label:"Price",modelValue:R.TSRVF_PRC,"onUpdate:modelValue":w=>R.TSRVF_PRC=w,filled:"",dense:"",readonly:n.mode==="view"},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024),T.mode!=="view"?(c(),I(_,{key:0,side:""},{default:a(()=>[e(p,{icon:"delete",flat:"",color:"red",onClick:w=>k(O)},null,8,["onClick"])]),_:2},1024)):H("",!0)]),_:2},1024)),[[x]])),128))]),_:1})]),_:1}),e(j,{align:"right"},{default:a(()=>[e(p,{label:"OK",color:"primary",onClick:C[1]||(C[1]=R=>i()),disable:l.value,loading:l.value},null,8,["disable","loading"]),e(p,{flat:"",label:"Cancel",color:"red",onClick:Q(S),loading:l.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},re={class:"text-h6"},ue={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(T){const{dialogRef:y,onDialogHide:b,onDialogOK:m,onDialogCancel:S}=W(),h=q(),n=T,t=g({SRVH_DOCNO:"",SRVH_ISSDT:Z.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),o=g([]);F(async()=>{n.header&&(t.value=n.header,o.value=n.detail)});const l=(f,V="add")=>{h.dialog({component:de,componentProps:{mode:V,dataItem:o.value[f]}}).onOk(async i=>{o.value[f].listFixDet=i})},r=()=>{h.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{loading.value=!0,await A.post("servicesOPR",{data:o.value}).then(f=>{loading.value=!1,m()})})};return(f,V)=>(c(),I(J,{ref_key:"dialogRef",ref:y,onHide:Q(b),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(D,null,{default:a(()=>[s("div",re,"Update Order "+d(t.value.SRVH_DOCNO),1)]),_:1}),e(D,{class:"q-pa-sm"},{default:a(()=>[e(X,{bordered:""},{default:a(()=>[(c(!0),U(Y,null,B(o.value,(i,k)=>N((c(),I(P,{key:k,class:"q-my-sm",clickable:""},{default:a(()=>[e(_,{avatar:""},{default:a(()=>[e(K,{color:"primary","text-color":"white"},{default:a(()=>[u(d(i.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),e(_,null,{default:a(()=>[e(M,null,{default:a(()=>[u(d(i.TSRVD_ITMCD),1)]),_:2},1024),e(M,{caption:"",lines:"1"},{default:a(()=>[u("Item")]),_:1})]),_:2},1024),e(_,null,{default:a(()=>[e(M,null,{default:a(()=>[u(d(i.TSRVD_CUSTRMK),1)]),_:2},1024),e(M,{caption:"",lines:"1"},{default:a(()=>[u("Customer Remarks")]),_:1})]),_:2},1024),e(_,{side:""},{default:a(()=>[e(p,{icon:"construction",color:"green",flat:"",onClick:v=>l(k,"add")},{default:a(()=>[e(L,null,{default:a(()=>[u("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(_,{side:""},{default:a(()=>[e(p,{icon:"visibility",color:"cyan",flat:"",onClick:v=>l(k,"view"),disable:!i.listFixDet},{default:a(()=>[e(L,null,{default:a(()=>[u("View Added Item")]),_:1}),e(oe,{color:"red",floating:""},{default:a(()=>[u(d(i.listFixDet.length),1)]),_:2},1024)]),_:2},1032,["onClick","disable"])]),_:2},1024)]),_:2},1024)),[[x]])),128))]),_:1})]),_:1}),e(j,{align:"right"},{default:a(()=>[e(p,{label:"OK",color:"primary",onClick:V[0]||(V[0]=i=>r()),disable:f.loading||o.value.filter(i=>i.listFixDet).length===0,loading:f.loading},null,8,["disable","loading"]),e(p,{flat:"",label:"Cancel",color:"red",onClick:Q(S),loading:f.loading},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},ce={class:"q-pa-md"},_e={class:"row"},me={class:"col"},fe={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ve={class:"text-h5 text-bold"},ge={class:"text-h6 text-bold"},pe={class:"text-subtitle2"},Se={class:"text-h6 text-bold"},he=s("div",{class:"text-subtitle2"},"Resolved Items",-1),Ce={class:"row"},De={class:"col"},be=s("div",{class:"col text-right"},null,-1),ke={__name:"serviceOprView",setup(T){const y=q();g([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:t=>t.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:t=>t.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const b=g([]),m=g(""),S=g(!1);F(()=>{h()});const h=async()=>{S.value=!0,await A.post("servicesOPR/search",{searchBy:"",searchValue:m.value}).then(t=>{S.value=!1,b.value=t.data.data}).catch(t=>{S.value=!1})},n=t=>{const o={SRVH_DOCNO:t.SRVH_DOCNO,SRVH_ISSDT:Z.formatDate(t.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:t.MCUS_CUSCD};let l=[];t.detail.map(r=>{l.push({TSRVD_ITMCD:r.TSRVD_ITMCD,TSRVD_LINE:r.TSRVD_LINE,TSRVD_QTY:r.TSRVD_QTY,TSRVD_CUSTRMK:r.TSRVD_CUSTRMK})}),y.dialog({component:ue,componentProps:{header:o,detail:l}}).onOk(async r=>{h()})};return(t,o)=>(c(),U("div",ce,[s("div",_e,[s("div",me,[e(te,{grid:"",flat:"",bordered:"","card-container-class":t.cardContainerClass,title:"Outstanding Order",rows:b.value,columns:t.columns,"row-key":"name",filter:m.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":t.rowsPerPageOptions,loading:S.value},{"top-right":a(()=>[e(E,{borderless:"",dense:"",debounce:"300",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=l=>m.value=l),placeholder:"Search"},{append:a(()=>[e(ee,{name:"search"})]),_:1},8,["modelValue"])]),item:a(l=>[s("div",fe,[e($,{flat:"",bordered:""},{default:a(()=>[e(D,{class:"text-center bg-secondary text-white"},{default:a(()=>[s("div",ve,d(l.row.SRVH_DOCNO),1)]),_:2},1024),e(ae),e(D,null,{default:a(()=>[s("div",ge,d(l.row.MCUS_CUSNM),1),s("div",pe,d(l.row.SRVH_ISSDT),1)]),_:2},1024),e(D,null,{default:a(()=>[s("div",Se,d(l.row.resolve.length)+" of "+d(l.row.unresolve.length),1),he]),_:2},1024),e(D,null,{default:a(()=>[s("div",Ce,[s("div",De,[e(p,{label:"Resolve",color:"primary",outline:"",onClick:r=>n(l.row)},null,8,["onClick"])]),be])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{ke as default};
