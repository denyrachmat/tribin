import{Q as A}from"./QTooltip.0e736cb8.js";import{s as m,B as S,C as b,D as l,E as e,L as K,M as Y,I as t,Z as c,am as g,T as Q,Q as f,O as V,P as k,R,S as M,U as Z,H as u,V as z,X as J,Y as W,o as ee,aX as le}from"./index.8118e393.js";import{a as F,u as ae,l as B,Q as oe,b as $,c as p,d as _,k as te,m as N}from"./QTable.890a5f14.js";import{Q as q,a as x}from"./QTd.1ca5aef5.js";import{api_web as G,api as se}from"./axios.0efd826d.js";import{Q as h,a as P,C as y}from"./ClosePopup.eb31adb4.js";import"./use-cache.b0833c75.js";import"./date.f8e16a52.js";const ne=t("div",{class:"text-h6"},"RO Maintenance",-1),de={style:{border:"1px black solid","border-radius":"10px"}},ie=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Header")],-1),ue={class:"row"},re={class:"col"},_e={class:"col q-pl-md"},me={class:"row items-center justify-end"},ce={class:"col q-pl-md"},Te={class:"row items-center justify-end"},De={class:"row"},Oe={class:"col"},fe={class:"col q-pl-md"},pe={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Se=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Detail Items")],-1),ve={class:"row q-pb-md"},Ce={class:"col"},Le={class:"text-h6"},Ve={class:"col text-right"},Ue={class:"row"},Qe={class:"col"},ge={class:"row items-center justify-end"},be={class:"row items-center justify-end"},Ee={__name:"salesOrderCreate",setup(H){const w=F(),d=m({TSLO_SLOCD:"",TSLO_ISSUDT:"",TSLO_PLAN_DLVDT:"",TSLO_QUOCD:"",TSLO_POCD:""});m(""),m("");const L=m([]),i=m(!1),U=m(1),T=m([]),E=(r,o,a,C)=>{o(async()=>{C==="quotation"&&await I(r)})},I=async(r="")=>{i.value=!0,await G.post("quotation/search",{searchBy:"MCUS_CUSNM",searchValue:r}).then(o=>{i.value=!1,L.value=o.data.data}).catch(o=>{i.value=!1})},D=()=>U.value===1?"Rental":U.value===2?"Sales":"Service",v=async r=>{console.log(r),i.value=!0,await se.get(`transaction/quotation/view/${btoa(r)}`).then(o=>{i.value=!1,o.data.data.det.map(a=>{T.value.push({TSLODETA_ITMCD:a.TQUODETA_ITMCD,TSLODETA_ITMQT:a.TQUODETA_ITMQT,TSLODETA_USAGE:a.TQUODETA_USAGE,TSLODETA_PRC:a.TQUODETA_PRC,TSLODETA_PERIOD_FR:a.TQUODETA_PERIOD_FR,TSLODETA_PERIOD_TO:a.TQUODETA_PERIOD_TO})})}).catch(o=>{i.value=!1})},s=()=>{T.value.push({TSLODETA_ITMCD:"",TSLODETA_ITMQT:"",TSLODETA_USAGE:"",TSLODETA_PRC:0,TSLODETA_PERIOD_FR:"",TSLODETA_PERIOD_TO:""})},O=r=>{w.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${r+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{T.value.splice(r,1)})},{dialogRef:j,onDialogHide:X,onDialogOK:Ie,onDialogCancel:Re}=ae();return(r,o)=>(S(),b(W,{ref_key:"dialogRef",ref:j,onHide:J(X),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(K,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(Y,null,{default:l(()=>[ne]),_:1}),e(Y,{class:"q-pa-sm"},{default:l(()=>[t("fieldset",de,[ie,t("div",ue,[t("div",re,[e(c,{label:"RO Code",dense:"",filled:"",modelValue:d.value.TSLO_SLOCD,"onUpdate:modelValue":o[0]||(o[0]=a=>d.value.TSLO_SLOCD=a),disable:"",loading:i.value},null,8,["modelValue","loading"])]),t("div",_e,[e(c,{filled:"",modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":o[2]||(o[2]=a=>d.value.TSLO_ISSUDT=a),dense:"",label:"Issue Date",loading:i.value,onClick:o[3]||(o[3]=a=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(g,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(P,{modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":o[1]||(o[1]=a=>d.value.TSLO_ISSUDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",me,[Q(e(f,{label:"Close",color:"primary",flat:""},null,512),[[y]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])]),t("div",ce,[e(c,{filled:"",modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":o[5]||(o[5]=a=>d.value.TSLO_PLAN_DLVDT=a),dense:"",label:"Delivery Date",loading:i.value,onClick:o[6]||(o[6]=a=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(g,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(P,{modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":o[4]||(o[4]=a=>d.value.TSLO_PLAN_DLVDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Te,[Q(e(f,{label:"Close",color:"primary",flat:""},null,512),[[y]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),t("div",De,[t("div",Oe,[e(B,{dense:"",filled:"",label:"Sales Quotation Code",modelValue:d.value.TSLO_QUOCD,"onUpdate:modelValue":[o[7]||(o[7]=a=>d.value.TSLO_QUOCD=a),v],"use-input":"","input-debounce":"500",options:L.value,onFilter:o[8]||(o[8]=(a,C,n)=>E(a,C,n,"quotation")),behavior:"dialog","option-label":"DESCSEL","option-value":"TQUO_QUOCD","emit-value":"","map-options":"",loading:i.value},null,8,["modelValue","options","loading"])]),t("div",fe,[e(c,{label:"PO Number",dense:"",filled:"",modelValue:d.value.TSLO_POCD,"onUpdate:modelValue":o[9]||(o[9]=a=>d.value.TSLO_POCD=a),loading:i.value},null,8,["modelValue","loading"])])])]),t("fieldset",pe,[Se,t("div",ve,[t("div",Ce,[t("span",Le,V(D()),1)]),t("div",Ve,[e(f,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:s,loading:i.value},null,8,["loading"])])]),t("div",Ue,[t("div",Qe,[e(oe,{bordered:"",dense:""},{default:l(()=>[T.value.length>0?(S(!0),k(R,{key:0},M(T.value,(a,C)=>(S(),b($,{key:C,class:"q-my-sm",dense:""},{default:l(()=>[e(p,{avatar:""},{default:l(()=>[e(Z,{"text-color":"blue"},{default:l(()=>[u(V(C+1),1)]),_:2},1024)]),_:2},1024),e(p,null,{default:l(()=>[e(_,{class:"text-center"},{default:l(()=>[e(c,{modelValue:a.TSLODETA_ITMCD,"onUpdate:modelValue":n=>a.TSLODETA_ITMCD=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[u(" Item Name ")]),_:1})]),_:2},1024),e(p,null,{default:l(()=>[e(_,null,{default:l(()=>[e(c,{modelValue:a.TSLODETA_ITMQT,"onUpdate:modelValue":n=>a.TSLODETA_ITMQT=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[u(" Qty ")]),_:1})]),_:2},1024),e(p,null,{default:l(()=>[e(_,null,{default:l(()=>[e(c,{modelValue:a.TSLODETA_USAGE,"onUpdate:modelValue":n=>a.TSLODETA_USAGE=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[u(" Usage ")]),_:1})]),_:2},1024),e(p,null,{default:l(()=>[e(_,null,{default:l(()=>[e(c,{modelValue:a.TSLODETA_PRC,"onUpdate:modelValue":n=>a.TSLODETA_PRC=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[u(" Price ")]),_:1})]),_:2},1024),e(p,null,{default:l(()=>[e(_,null,{default:l(()=>[e(c,{filled:"",modelValue:a.TSLODETA_PERIOD_FROM,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_FROM=n,dense:"",label:"Issue Date",loading:i.value,onClick:o[10]||(o[10]=n=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(g,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(P,{modelValue:a.TSLODETA_PERIOD_FROM,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_FROM=n,mask:"YYYY-MM-DD"},{default:l(()=>[t("div",ge,[Q(e(f,{label:"Close",color:"primary",flat:""},null,512),[[y]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","loading"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[u(" Period From ")]),_:1})]),_:2},1024),e(p,null,{default:l(()=>[e(_,null,{default:l(()=>[e(c,{filled:"",modelValue:a.TSLODETA_PERIOD_TO,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_TO=n,dense:"",label:"Issue Date",loading:i.value,onClick:o[11]||(o[11]=n=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(g,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(h,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(P,{modelValue:a.TSLODETA_PERIOD_TO,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_TO=n,mask:"YYYY-MM-DD"},{default:l(()=>[t("div",be,[Q(e(f,{label:"Close",color:"primary",flat:""},null,512),[[y]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","loading"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[u(" Period To ")]),_:1})]),_:2},1024),e(p,{side:""},{default:l(()=>[e(f,{icon:"delete",color:"red",flat:"",onClick:n=>O(C)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)):Q((S(),b($,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(p,null,{default:l(()=>[e(_,null,{default:l(()=>[u(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[z]])]),_:1})])])])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const Ae={class:"q-pa-md"},he={class:"row q-pb-md"},Pe=t("div",{class:"col"},[t("span",{class:"text-h4"},"Sales Order / Receive Order")],-1),ye={class:"col text-right"},ke={class:"row q-pt-md"},we={class:"col"},Ge={__name:"salesOrderView",setup(H){const w=F(),d=m("TQUO_QUOCD"),L=m(""),i=m([]),U=m([{name:"TSLO_SLOCD",label:"RO. Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_ADDRESS_NAME",label:"Customer Addr.",field:"TSLO_ADDRESS_NAME",sortable:!0,align:"left"},{name:"TSLO_CUSCD",label:"Customer Code",field:"TSLO_CUSCD",sortable:!0,align:"left"},{name:"TSLO_ISSUDT",label:"Issue Date",field:"TSLO_ISSUDT",sortable:!0,align:"left"},{name:"TSLO_QUOCD",label:"Quot. Code",field:"TSLO_QUOCD",sortable:!0,align:"left"}]),T=m(!1);ee(()=>{E()});const E=async()=>{T.value=!0,await G.post("receive-order/searchAPI",{searchBy:d.value,searchValue:L.value}).then(D=>{T.value=!1,i.value=D.data.data}).catch(D=>{T.value=!1})},I=()=>{w.dialog({component:Ee}).onOk(async D=>{E()})};return(D,v)=>(S(),k("div",Ae,[t("div",he,[Pe,t("div",ye,[e(f,{icon:"add",color:"blue",onClick:I},{default:l(()=>[e(A,null,{default:l(()=>[u("Create New RO")]),_:1})]),_:1})])]),e(le),t("div",ke,[t("div",we,[e(te,{title:"Created RO",rows:i.value,columns:U.value,"row-key":"name",loading:T.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(B,{outlined:"",modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=s=>d.value=s),options:U.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(c,{borderless:"",dense:"",modelValue:L.value,"onUpdate:modelValue":[v[1]||(v[1]=s=>L.value=s),v[2]||(v[2]=s=>D.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(g,{name:"search"})]),_:1},8,["modelValue"])]),header:l(s=>[e(q,{props:s},{default:l(()=>[e(N,{"auto-width":""},{default:l(()=>[u("Action")]),_:1}),(S(!0),k(R,null,M(s.cols,O=>(S(),b(N,{key:O.name,props:s},{default:l(()=>[u(V(O.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(s=>[e(q,{props:s},{default:l(()=>[e(x,{"auto-width":""},{default:l(()=>[e(f,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"orange",icon:"edit",onClick:O=>D.onClickEdit(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(A,null,{default:l(()=>[u(V(s.row.TQUO_APPRVDT?"Quotation already approved, cannot edit !":"Edit this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(f,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"red",icon:"delete",onClick:O=>D.onClickDelete(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(A,null,{default:l(()=>[u(V(s.row.TQUO_APPRVDT?"Quotation already approved, cannot delete !":"Delete this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(f,{flat:"",color:"indigo",icon:"print",onClick:O=>D.onClickPrint(s.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(A,null,{default:l(()=>[u("Print this quotation")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(S(!0),k(R,null,M(s.cols,O=>(S(),b(x,{key:O.name,props:s},{default:l(()=>[u(V(O.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Ge as default};
