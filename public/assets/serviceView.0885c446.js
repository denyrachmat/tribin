import{Q as j}from"./QTooltip.78a40fdd.js";import{t as w,o as ue,C as I,D as N,E as i,F as o,M as _e,O as J,J as C,$ as Q,aZ as E,X as ge,Q as x,Y as te,Z as pe,a as F,c as Me,a5 as Oe,u as Ze,h as V,ab as Je,d as et,a_ as Ce,w as He,bd as me,g as Se,az as tt,aA as lt,aP as at,aX as Be,ac as Qe,am as ot,ad as nt,af as it,p as st,bg as rt,j as ut,bh as dt,aH as ct,aG as vt,av as De,aF as mt,aI as Ye,I as L,a0 as ft,U as qe,R as ee,S as Te,T as be,V as _t,P as ne,W as gt}from"./index.2948a112.js";import{Q as se,b as pt}from"./QSelect.080c180a.js";import{Q as St,a as Ne}from"./QTable.0001dba0.js";import{Q as $e,a as xe}from"./QTd.a6a67c00.js";import{u as de}from"./use-quasar.a319a1ad.js";import{d as fe}from"./date.a667290b.js";import{api_web as G}from"./axios.f57b322f.js";import{Q as ht,a as Ct,C as Tt}from"./ClosePopup.fb2dda61.js";import{Q as Pe,a as Z,b as Ae}from"./QItemLabel.9a174405.js";import{Q as bt}from"./QList.d2fa7b73.js";import{u as re,g as yt}from"./use-dialog-plugin-component.08f59c92.js";import{i as Mt,j as Le}from"./format.5b506cab.js";import{_ as Dt}from"./serviceOprUpdateOrder.3303315c.js";import"./use-render-cache.3aae9b27.js";import"./QBtnGroup.4be79dcf.js";import"./QBadge.3f880529.js";import"./serviceOprItemAdd.1a19fa86.js";import"./QInnerLoading.631d0e38.js";const wt=C("div",{class:"text-h6"},"Create Item Master",-1),kt={class:"row"},Vt={class:"col"},It={class:"col q-pl-md"},Rt={class:"row q-pt-md"},Ut={class:"col"},Ft={class:"col q-pl-md"},Ot={class:"row q-pt-md"},qt={class:"col"},Nt={class:"col q-pl-md"},$t={class:"row q-pt-md"},xt={class:"col"},Pt={__name:"itemCreate",props:{ItemCat:String,ItemType:String,isAutoCD:Boolean,listOpenField:Array},setup(e){const{dialogRef:M,onDialogHide:f,onDialogOK:v,onDialogCancel:p}=re(),b=de(),n=w({MITM_ITMCD:"",MITM_ITMNM:"",MITM_STKUOM:"",MITM_ITMTYPE:1,MITM_BRAND:"",MITM_MODEL:"",MITM_SPEC:"",MITM_ITMCAT:"",MITM_COACD:"",MITM_ITMCAT:""}),h=w(!1),U=w([]),R=w([]),_=e;ue(()=>{T(),n.value.MITM_ITMCAT=_.ItemCat,n.value.MITM_ITMTYPE=_.ItemType});const S=(g,a,d,l)=>{a(async()=>{await G.post("item/getListCoasAPI",{search:g}).then(s=>{R.value=s.data})})},D=()=>{b.dialog({title:"Confirmation",message:"Do you want to save this item ?",cancel:!0,persistent:!0}).onOk(async()=>{await G.post("item",n.value).then(g=>{v(g.data.data)})})},T=async()=>{h.value=!0,await G.get("item/formAPI").then(g=>{h.value=!1,U.value=g.data.uoms,R.value=g.data.coas}).catch(()=>{h.value=!1})},t=g=>_.listOpenField.length===0||_.listOpenField.includes(g);return(g,a)=>(I(),N(pe,{ref_key:"dialogRef",ref:M,onHide:te(f),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:i(()=>[o(_e,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:i(()=>[o(J,null,{default:i(()=>[wt]),_:1}),o(J,{class:"q-pa-sm"},{default:i(()=>[C("div",kt,[C("div",Vt,[t("MITM_ITMCD")?(I(),N(Q,{key:0,label:"Item Code",dense:"",modelValue:n.value.MITM_ITMCD,"onUpdate:modelValue":a[0]||(a[0]=d=>n.value.MITM_ITMCD=d),filled:"",readonly:_.isAutoCD},null,8,["modelValue","readonly"])):E("",!0)]),C("div",It,[t("MITM_ITMNM")?(I(),N(Q,{key:0,label:"Item Name",dense:"",modelValue:n.value.MITM_ITMNM,"onUpdate:modelValue":a[1]||(a[1]=d=>n.value.MITM_ITMNM=d),filled:""},null,8,["modelValue"])):E("",!0)])]),C("div",Rt,[C("div",Ut,[t("MITM_STKUOM")?(I(),N(se,{key:0,dense:"",filled:"",label:"UOM",modelValue:n.value.MITM_STKUOM,"onUpdate:modelValue":a[2]||(a[2]=d=>n.value.MITM_STKUOM=d),options:U.value,behavior:"dialog","option-label":"MUOM_UOMNM","option-value":"MUOM_UOMCD","emit-value":"","map-options":"",loading:h.value},null,8,["modelValue","options","loading"])):E("",!0)]),C("div",Ft,[t("MITM_BRAND")?(I(),N(Q,{key:0,label:"Item Brand",dense:"",modelValue:n.value.MITM_BRAND,"onUpdate:modelValue":a[3]||(a[3]=d=>n.value.MITM_BRAND=d),filled:""},null,8,["modelValue"])):E("",!0)])]),C("div",Ot,[C("div",qt,[t("MITM_MODEL")?(I(),N(Q,{key:0,label:"Item Model",dense:"",modelValue:n.value.MITM_MODEL,"onUpdate:modelValue":a[4]||(a[4]=d=>n.value.MITM_MODEL=d),filled:""},null,8,["modelValue"])):E("",!0)]),C("div",Nt,[t("MITM_SPEC")?(I(),N(Q,{key:0,label:"Item Specification",dense:"",modelValue:n.value.MITM_SPEC,"onUpdate:modelValue":a[5]||(a[5]=d=>n.value.MITM_SPEC=d),filled:""},null,8,["modelValue"])):E("",!0)])]),C("div",$t,[C("div",xt,[t("MITM_COACD")?(I(),N(se,{key:0,dense:"",filled:"",label:"COA",modelValue:n.value.MITM_COACD,"onUpdate:modelValue":a[6]||(a[6]=d=>n.value.MITM_COACD=d),options:R.value,"use-input":"",behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD",onFilter:a[7]||(a[7]=(d,l,s)=>S(d,l,s)),"emit-value":"","map-options":"",loading:h.value},null,8,["modelValue","options","loading"])):E("",!0)])])]),_:1}),o(ge,{align:"right"},{default:i(()=>[o(x,{label:"OK",color:"primary",onClick:a[8]||(a[8]=d=>D())}),o(x,{flat:"",label:"Cancel",color:"red",onClick:te(p)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},At=C("div",{class:"text-h6"},"Create New Customer Data",-1),Lt={class:"row q-pb-md"},Et={class:"col"},zt={class:"row q-pb-md"},Ht={class:"col"},Bt={class:"col q-pl-md"},Qt={class:"row"},Yt={class:"col"},jt={__name:"customerView",setup(e){const{dialogRef:M,onDialogHide:f,onDialogOK:v,onDialogCancel:p}=re(),b=de(),n=w({MCUS_CUSCD:"",MCUS_CUSNM:"",MCUS_CURCD:"IDR",MCUS_TAXREG:"-",MCUS_ADDR1:"",MCUS_TELNO:"",MCUS_PIC_NAME:"-",MCUS_PIC_TELNO:"-",MCUS_TYPE:1,MCUS_GROUP:"SERVICE",MCUS_EMAIL:""}),h=w(!1),U=()=>{b.dialog({title:"Confirmation",message:"Do you want to save this customer ?",cancel:!0,persistent:!0}).onOk(async()=>{h.value=!0,await G.post("customer",n.value).then(R=>{h.value=!1,v(R.data)}).catch(R=>{h.value=!1})})};return(R,_)=>(I(),N(pe,{ref_key:"dialogRef",ref:M,onHide:te(f),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:i(()=>[o(_e,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:i(()=>[o(J,null,{default:i(()=>[At]),_:1}),o(J,{class:"q-pa-sm"},{default:i(()=>[C("div",Lt,[C("div",Et,[o(Q,{label:"Customer Name",dense:"",modelValue:n.value.MCUS_CUSNM,"onUpdate:modelValue":_[0]||(_[0]=S=>n.value.MCUS_CUSNM=S),filled:""},null,8,["modelValue"])])]),C("div",zt,[C("div",Ht,[o(Q,{label:"Customer Email",dense:"",modelValue:n.value.MCUS_EMAIL,"onUpdate:modelValue":_[1]||(_[1]=S=>n.value.MCUS_EMAIL=S),filled:""},null,8,["modelValue"])]),C("div",Bt,[o(Q,{label:"Customer Phone",dense:"",modelValue:n.value.MCUS_TELNO,"onUpdate:modelValue":_[2]||(_[2]=S=>n.value.MCUS_TELNO=S),filled:"",mask:"####-####-####"},null,8,["modelValue"])])]),C("div",Qt,[C("div",Yt,[o(Q,{label:"Customer Address",dense:"",modelValue:n.value.MCUS_ADDR1,"onUpdate:modelValue":_[3]||(_[3]=S=>n.value.MCUS_ADDR1=S),filled:"",type:"textarea"},null,8,["modelValue"])])])]),_:1}),o(ge,{align:"right"},{default:i(()=>[o(x,{label:"OK",color:"primary",onClick:_[4]||(_[4]=S=>U()),loading:h.value},null,8,["loading"]),o(x,{flat:"",label:"Cancel",color:"red",onClick:te(p),loading:h.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Kt={ratio:[String,Number]};function Gt(e,M){return F(()=>{const f=Number(e.ratio||(M!==void 0?M.value:void 0));return isNaN(f)!==!0&&f>0?{paddingBottom:`${100/f}%`}:null})}const Wt=1.7778;var Xt=Me({name:"QImg",props:{...Kt,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Wt},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:M,emit:f}){const v=w(e.initialRatio),p=Gt(e,v),b=Se(),{registerTimeout:n,removeTimeout:h}=Oe(),{registerTimeout:U,removeTimeout:R}=Oe(),_=F(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),S=F(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),D=[w(null),w(_.value)],T=w(0),t=w(!1),g=w(!1),a=F(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),d=F(()=>({width:e.width,height:e.height})),l=F(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),s=F(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function z(){if(R(),e.loadingShowDelay===0){t.value=!0;return}U(()=>{t.value=!0},e.loadingShowDelay)}function P(){R(),t.value=!1}function y({target:r}){me(b)===!1&&(h(),v.value=r.naturalHeight===0?.5:r.naturalWidth/r.naturalHeight,O(r,1))}function O(r,A){A===1e3||me(b)===!0||(r.complete===!0?k(r):n(()=>{O(r,A+1)},50))}function k(r){me(b)!==!0&&(T.value=T.value^1,D[T.value].value=null,P(),r.getAttribute("__qerror")!=="true"&&(g.value=!1),f("load",r.currentSrc||r.src))}function u(r){h(),P(),g.value=!0,D[T.value].value=S.value,D[T.value^1].value=_.value,f("error",r)}function m(r){const A=D[r].value,Y={key:"img_"+r,class:l.value,style:s.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...A};return T.value===r?Object.assign(Y,{class:Y.class+"current",onLoad:y,onError:u}):Y.class+="loaded",V("div",{class:"q-img__container absolute-full",key:"img"+r},V("img",Y))}function $(){return t.value===!1?V("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},et(M[g.value===!0?"error":"default"])):V("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},M.loading!==void 0?M.loading():e.noSpinner===!0?void 0:[V(Ce,{color:e.spinnerColor,size:e.spinnerSize})])}{let r=function(){He(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,A=>{h(),g.value=!1,A===null?(P(),D[T.value^1].value=_.value):z(),D[T.value].value=A},{immediate:!0})};Ze.value===!0?ue(r):r()}return()=>{const r=[];return p.value!==null&&r.push(V("div",{key:"filler",style:p.value})),D[0].value!==null&&r.push(m(0)),D[1].value!==null&&r.push(m(1)),r.push(V(Je,{name:"q-transition--fade"},$)),V("div",{key:"main",class:a.value,style:d.value,role:"img","aria-label":e.alt},r)}}});const Zt={...tt,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},ye=50,je=2*ye,Ke=je*Math.PI,Jt=Math.round(Ke*1e3)/1e3;var el=Me({name:"QCircularProgress",props:{...Zt,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:M}){const{proxy:{$q:f}}=Se(),v=lt(e),p=F(()=>{const T=(f.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(f.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-T}deg)`:`rotate3d(0, 0, 1, ${T-90}deg)`}}),b=F(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),n=F(()=>je/(1-e.thickness/2)),h=F(()=>`${n.value/2} ${n.value/2} ${n.value} ${n.value}`),U=F(()=>Mt(e.value,e.min,e.max)),R=F(()=>e.max-e.min),_=F(()=>e.thickness/2*n.value),S=F(()=>{const T=(e.max-U.value)/R.value,t=e.rounded===!0&&U.value<e.max&&T<.25?_.value/2*(1-T/.25):0;return Ke*T+t});function D({thickness:T,offset:t,color:g,cls:a,rounded:d}){return V("circle",{class:"q-circular-progress__"+a+(g!==void 0?` text-${g}`:""),style:b.value,fill:"transparent",stroke:"currentColor","stroke-width":T,"stroke-dasharray":Jt,"stroke-dashoffset":t,"stroke-linecap":d,cx:n.value,cy:n.value,r:ye})}return()=>{const T=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&T.push(V("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:ye-_.value/2,cx:n.value,cy:n.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&T.push(D({cls:"track",thickness:_.value,offset:0,color:e.trackColor})),T.push(D({cls:"circle",thickness:_.value,offset:S.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const t=[V("svg",{class:"q-circular-progress__svg",style:p.value,viewBox:h.value,"aria-hidden":"true"},T)];return e.showValue===!0&&t.push(V("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},M.default!==void 0?M.default():[V("div",U.value)])),V("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:v.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:U.value},at(M.internal,t))}}});function oe(e,M,f,v){const p=[];return e.forEach(b=>{v(b)===!0?p.push(b):M.push({failedPropValidation:f,file:b})}),p}function ve(e){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),Qe(e)}const tl={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},ll=["rejected"];function al({editable:e,dnd:M,getFileInput:f,addFilesToQueue:v}){const{props:p,emit:b,proxy:n}=Se(),h=w(null),U=F(()=>p.accept!==void 0?p.accept.split(",").map(l=>(l=l.trim(),l==="*"?"*/":(l.endsWith("/*")&&(l=l.slice(0,l.length-1)),l.toUpperCase()))):null),R=F(()=>parseInt(p.maxFiles,10)),_=F(()=>parseInt(p.maxTotalSize,10));function S(l){if(e.value)if(l!==Object(l)&&(l={target:null}),l.target!==null&&l.target.matches('input[type="file"]')===!0)l.clientX===0&&l.clientY===0&&Be(l);else{const s=f();s&&s!==l.target&&s.click(l)}}function D(l){e.value&&l&&v(null,l)}function T(l,s,z,P){let y=Array.from(s||l.target.files);const O=[],k=()=>{O.length!==0&&b("rejected",O)};if(p.accept!==void 0&&U.value.indexOf("*/")===-1&&(y=oe(y,O,"accept",u=>U.value.some(m=>u.type.toUpperCase().startsWith(m)||u.name.toUpperCase().endsWith(m))),y.length===0))return k();if(p.maxFileSize!==void 0){const u=parseInt(p.maxFileSize,10);if(y=oe(y,O,"max-file-size",m=>m.size<=u),y.length===0)return k()}if(p.multiple!==!0&&y.length!==0&&(y=[y[0]]),y.forEach(u=>{u.__key=u.webkitRelativePath+u.lastModified+u.name+u.size}),P===!0){const u=z.map(m=>m.__key);y=oe(y,O,"duplicate",m=>u.includes(m.__key)===!1)}if(y.length===0)return k();if(p.maxTotalSize!==void 0){let u=P===!0?z.reduce((m,$)=>m+$.size,0):0;if(y=oe(y,O,"max-total-size",m=>(u+=m.size,u<=_.value)),y.length===0)return k()}if(typeof p.filter=="function"){const u=p.filter(y);y=oe(y,O,"filter",m=>u.includes(m))}if(p.maxFiles!==void 0){let u=P===!0?z.length:0;if(y=oe(y,O,"max-files",()=>(u++,u<=R.value)),y.length===0)return k()}if(k(),y.length!==0)return y}function t(l){ve(l),M.value!==!0&&(M.value=!0)}function g(l){Qe(l),(l.relatedTarget!==null||ot.is.safari!==!0?l.relatedTarget!==h.value:document.elementsFromPoint(l.clientX,l.clientY).includes(h.value)===!1)===!0&&(M.value=!1)}function a(l){ve(l);const s=l.dataTransfer.files;s.length!==0&&v(null,s),M.value=!1}function d(l){if(M.value===!0)return V("div",{ref:h,class:`q-${l}__dnd absolute-full`,onDragenter:ve,onDragover:ve,onDragleave:g,onDrop:a})}return Object.assign(n,{pickFiles:S,addFiles:D}),{pickFiles:S,addFiles:D,onDragover:t,onDragleave:g,processFiles:T,getDndNode:d,maxFilesNumber:R,maxTotalSizeNumber:_}}function Ee(e){return(e*100).toFixed(2)+"%"}const ol={...nt,...tl,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Ge=[...ll,"start","finish","added","removed"];function nl(e,M){const f=Se(),{props:v,slots:p,emit:b,proxy:n}=f,{$q:h}=n,U=it(v,h);function R(c,q,H){if(c.__status=q,q==="idle"){c.__uploaded=0,c.__progress=0,c.__sizeLabel=Le(c.size),c.__progressLabel="0.00%";return}if(q==="failed"){n.$forceUpdate();return}c.__uploaded=q==="uploaded"?c.size:H,c.__progress=q==="uploaded"?1:Math.min(.9999,c.__uploaded/c.size),c.__progressLabel=Ee(c.__progress),n.$forceUpdate()}const _=F(()=>v.disable!==!0&&v.readonly!==!0),S=w(!1),D=w(null),T=w(null),t={files:w([]),queuedFiles:w([]),uploadedFiles:w([]),uploadedSize:w(0),updateFileStatus:R,isAlive:()=>me(f)===!1},{pickFiles:g,addFiles:a,onDragover:d,onDragleave:l,processFiles:s,getDndNode:z,maxFilesNumber:P,maxTotalSizeNumber:y}=al({editable:_,dnd:S,getFileInput:Ve,addFilesToQueue:Ie});Object.assign(t,e({props:v,slots:p,emit:b,helpers:t,exposeApi:c=>{Object.assign(t,c)}})),t.isBusy===void 0&&(t.isBusy=w(!1));const O=w(0),k=F(()=>O.value===0?0:t.uploadedSize.value/O.value),u=F(()=>Ee(k.value)),m=F(()=>Le(O.value)),$=F(()=>_.value===!0&&t.isUploading.value!==!0&&(v.multiple===!0||t.queuedFiles.value.length===0)&&(v.maxFiles===void 0||t.files.value.length<P.value)&&(v.maxTotalSize===void 0||O.value<y.value)),r=F(()=>_.value===!0&&t.isBusy.value!==!0&&t.isUploading.value!==!0&&t.queuedFiles.value.length!==0);st(rt,Ue);const A=F(()=>"q-uploader column no-wrap"+(U.value===!0?" q-uploader--dark q-dark":"")+(v.bordered===!0?" q-uploader--bordered":"")+(v.square===!0?" q-uploader--square no-border-radius":"")+(v.flat===!0?" q-uploader--flat no-shadow":"")+(v.disable===!0?" disabled q-uploader--disable":"")+(S.value===!0?" q-uploader--dnd":"")),Y=F(()=>"q-uploader__header"+(v.color!==void 0?` bg-${v.color}`:"")+(v.textColor!==void 0?` text-${v.textColor}`:""));He(t.isUploading,(c,q)=>{q===!1&&c===!0?b("start"):q===!0&&c===!1&&b("finish")});function le(){v.disable===!1&&(t.abort(),t.uploadedSize.value=0,O.value=0,ke(),t.files.value=[],t.queuedFiles.value=[],t.uploadedFiles.value=[])}function K(){v.disable===!1&&we(["uploaded"],()=>{t.uploadedFiles.value=[]})}function ce(){we(["idle","failed"],({size:c})=>{O.value-=c,t.queuedFiles.value=[]})}function we(c,q){if(v.disable===!0)return;const H={files:[],size:0},W=t.files.value.filter(B=>c.indexOf(B.__status)===-1?!0:(H.size+=B.size,H.files.push(B),B.__img!==void 0&&window.URL.revokeObjectURL(B.__img.src),!1));H.files.length!==0&&(t.files.value=W,q(H),b("removed",H.files))}function he(c){v.disable||(c.__status==="uploaded"?t.uploadedFiles.value=t.uploadedFiles.value.filter(q=>q.__key!==c.__key):c.__status==="uploading"?c.__abort():O.value-=c.size,t.files.value=t.files.value.filter(q=>q.__key!==c.__key?!0:(q.__img!==void 0&&window.URL.revokeObjectURL(q.__img.src),!1)),t.queuedFiles.value=t.queuedFiles.value.filter(q=>q.__key!==c.__key),b("removed",[c]))}function ke(){t.files.value.forEach(c=>{c.__img!==void 0&&window.URL.revokeObjectURL(c.__img.src)})}function Ve(){return T.value||D.value.getElementsByClassName("q-uploader__input")[0]}function Ie(c,q){const H=s(c,q,t.files.value,!0),W=Ve();W!=null&&(W.value=""),H!==void 0&&(H.forEach(B=>{if(t.updateFileStatus(B,"idle"),O.value+=B.size,v.noThumbnails!==!0&&B.type.toUpperCase().startsWith("IMAGE")){const Fe=new Image;Fe.src=window.URL.createObjectURL(B),B.__img=Fe}}),t.files.value=t.files.value.concat(H),t.queuedFiles.value=t.queuedFiles.value.concat(H),b("added",H),v.autoUpload===!0&&t.upload())}function Re(){r.value===!0&&t.upload()}function ie(c,q,H){if(c===!0){const W={type:"a",key:q,icon:h.iconSet.uploader[q],flat:!0,dense:!0};let B;return q==="add"?(W.onClick=g,B=Ue):W.onClick=H,V(x,W,B)}}function Ue(){return V("input",{ref:T,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:v.accept,multiple:v.multiple===!0?"multiple":void 0,capture:v.capture,onMousedown:Be,onClick:g,onChange:Ie})}function We(){return p.header!==void 0?p.header(ae):[V("div",{class:"q-uploader__header-content column"},[V("div",{class:"flex flex-center no-wrap q-gutter-xs"},[ie(t.queuedFiles.value.length!==0,"removeQueue",ce),ie(t.uploadedFiles.value.length!==0,"removeUploaded",K),t.isUploading.value===!0?V(Ce,{class:"q-uploader__spinner"}):null,V("div",{class:"col column justify-center"},[v.label!==void 0?V("div",{class:"q-uploader__title"},[v.label]):null,V("div",{class:"q-uploader__subtitle"},[m.value+" / "+u.value])]),ie($.value,"add"),ie(v.hideUploadBtn===!1&&r.value===!0,"upload",t.upload),ie(t.isUploading.value,"clear",t.abort)])])]}function Xe(){return p.list!==void 0?p.list(ae):t.files.value.map(c=>V("div",{key:c.__key,class:"q-uploader__file relative-position"+(v.noThumbnails!==!0&&c.__img!==void 0?" q-uploader__file--img":"")+(c.__status==="failed"?" q-uploader__file--failed":c.__status==="uploaded"?" q-uploader__file--uploaded":""),style:v.noThumbnails!==!0&&c.__img!==void 0?{backgroundImage:'url("'+c.__img.src+'")'}:null},[V("div",{class:"q-uploader__file-header row flex-center no-wrap"},[c.__status==="failed"?V(De,{class:"q-uploader__file-status",name:h.iconSet.type.negative,color:"negative"}):null,V("div",{class:"q-uploader__file-header-content col"},[V("div",{class:"q-uploader__title"},[c.name]),V("div",{class:"q-uploader__subtitle row items-center no-wrap"},[c.__sizeLabel+" / "+c.__progressLabel])]),c.__status==="uploading"?V(el,{value:c.__progress,min:0,max:1,indeterminate:c.__progress===0}):V(x,{round:!0,dense:!0,flat:!0,icon:h.iconSet.uploader[c.__status==="uploaded"?"done":"clear"],onClick:()=>{he(c)}})])]))}ut(()=>{t.isUploading.value===!0&&t.abort(),t.files.value.length!==0&&ke()});const ae={};for(const c in t)dt(t[c])===!0?ct(ae,c,()=>t[c].value):ae[c]=t[c];return Object.assign(ae,{upload:Re,reset:le,removeUploadedFiles:K,removeQueuedFiles:ce,removeFile:he,pickFiles:g,addFiles:a}),vt(ae,{canAddFiles:()=>$.value,canUpload:()=>r.value,uploadSizeLabel:()=>m.value,uploadProgressLabel:()=>u.value}),M({...t,upload:Re,reset:le,removeUploadedFiles:K,removeQueuedFiles:ce,removeFile:he,pickFiles:g,addFiles:a,canAddFiles:$,canUpload:r,uploadSizeLabel:m,uploadProgressLabel:u}),()=>{const c=[V("div",{class:Y.value},We()),V("div",{class:"q-uploader__list scroll"},Xe()),z("uploader")];t.isBusy.value===!0&&c.push(V("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[V(Ce)]));const q={ref:D,class:A.value};return $.value===!0&&Object.assign(q,{onDragover:d,onDragleave:l}),V("div",q,c)}}const il=yt(Ge);var sl=({name:e,props:M,emits:f,injectPlugin:v})=>Me({name:e,props:{...ol,...M},emits:mt(f)===!0?{...il,...f}:[...Ge,...f],setup(p,{expose:b}){return nl(v,b)}});function X(e){return typeof e=="function"?e:()=>e}const rl="QUploader",ul={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>e=>e.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},dl=["factoryFailed","uploaded","failed","uploading"];function cl({props:e,emit:M,helpers:f}){const v=w([]),p=w([]),b=w(0),n=F(()=>({url:X(e.url),method:X(e.method),headers:X(e.headers),formFields:X(e.formFields),fieldName:X(e.fieldName),withCredentials:X(e.withCredentials),sendRaw:X(e.sendRaw),batch:X(e.batch)})),h=F(()=>b.value>0),U=F(()=>p.value.length!==0);let R;function _(){v.value.forEach(t=>{t.abort()}),p.value.length!==0&&(R=!0)}function S(){const t=f.queuedFiles.value.slice(0);f.queuedFiles.value=[],n.value.batch(t)?D(t):t.forEach(g=>{D([g])})}function D(t){if(b.value++,typeof e.factory!="function"){T(t,{});return}const g=e.factory(t);if(!g)M("factoryFailed",new Error("QUploader: factory() does not return properly"),t),b.value--;else if(typeof g.catch=="function"&&typeof g.then=="function"){p.value.push(g);const a=d=>{f.isAlive()===!0&&(p.value=p.value.filter(l=>l!==g),p.value.length===0&&(R=!1),f.queuedFiles.value=f.queuedFiles.value.concat(t),t.forEach(l=>{f.updateFileStatus(l,"failed")}),M("factoryFailed",d,t),b.value--)};g.then(d=>{R===!0?a(new Error("Aborted")):f.isAlive()===!0&&(p.value=p.value.filter(l=>l!==g),T(t,d))}).catch(a)}else T(t,g||{})}function T(t,g){const a=new FormData,d=new XMLHttpRequest,l=(r,A)=>g[r]!==void 0?X(g[r])(A):n.value[r](A),s=l("url",t);if(!s){console.error("q-uploader: invalid or no URL specified"),b.value--;return}const z=l("formFields",t);z!==void 0&&z.forEach(r=>{a.append(r.name,r.value)});let P=0,y=0,O=0,k=0,u;d.upload.addEventListener("progress",r=>{if(u===!0)return;const A=Math.min(k,r.loaded);f.uploadedSize.value+=A-O,O=A;let Y=O-y;for(let le=P;Y>0&&le<t.length;le++){const K=t[le];if(Y>K.size)Y-=K.size,P++,y+=K.size,f.updateFileStatus(K,"uploading",K.size);else{f.updateFileStatus(K,"uploading",Y);return}}},!1),d.onreadystatechange=()=>{d.readyState<4||(d.status&&d.status<400?(f.uploadedFiles.value=f.uploadedFiles.value.concat(t),t.forEach(r=>{f.updateFileStatus(r,"uploaded")}),M("uploaded",{files:t,xhr:d})):(u=!0,f.uploadedSize.value-=O,f.queuedFiles.value=f.queuedFiles.value.concat(t),t.forEach(r=>{f.updateFileStatus(r,"failed")}),M("failed",{files:t,xhr:d})),b.value--,v.value=v.value.filter(r=>r!==d))},d.open(l("method",t),s),l("withCredentials",t)===!0&&(d.withCredentials=!0);const m=l("headers",t);m!==void 0&&m.forEach(r=>{d.setRequestHeader(r.name,r.value)});const $=l("sendRaw",t);t.forEach(r=>{f.updateFileStatus(r,"uploading",0),$!==!0&&a.append(l("fieldName",r),r,r.name),r.xhr=d,r.__abort=()=>{d.abort()},k+=r.size}),M("uploading",{files:t,xhr:d}),v.value.push(d),$===!0?d.send(new Blob(t)):d.send(a)}return{isUploading:h,isBusy:U,abort:_,upload:S}}var vl={name:rl,props:ul,emits:dl,injectPlugin:cl},ml=sl(vl);const fl={class:"bg-white"},_l={class:"row",style:{"min-height":"50vh","max-width":"90vh"}},gl={class:"col"},pl=C("div",{class:"text-h6"},"Preview Photo",-1),Sl={__name:"uploadPhoto",props:{photo:String},emits:[...re.emits],setup(e){const M=de(),f=w(""),v=e;ue(()=>{v.photo!==""&&(f.value=v.photo)});const p=()=>{M.dialog({title:"Confirmation",message:"Do you want to remove this photo ?",cancel:!0,persistent:!0}).onOk(async()=>{R("")})},b=async S=>{const D=await n(S[0]);D&&(console.log(D),R(D))};function n(S){var D=new FileReader;return S&&D.readAsDataURL(S),new Promise((T,t)=>{D.onload=function(g){T(g.target.result)}})}const{dialogRef:h,onDialogHide:U,onDialogOK:R,onDialogCancel:_}=re();return(S,D)=>(I(),N(pe,{ref_key:"dialogRef",ref:h,onHide:te(U)},{default:i(()=>[C("div",fl,[C("div",_l,[C("div",gl,[f.value?(I(),N(_e,{key:0},{default:i(()=>[o(J,null,{default:i(()=>[pl]),_:1}),o(Ye),o(J,null,{default:i(()=>[o(Xt,{src:f.value,style:{width:"80vh"}},null,8,["src"])]),_:1}),o(ge,{vertical:""},{default:i(()=>[o(x,{flat:"",onClick:D[0]||(D[0]=T=>p())},{default:i(()=>[L("Change Photo")]),_:1})]),_:1})]),_:1})):(I(),N(ml,{key:1,class:"full-height",url:T=>b(T),label:"Upload Photo",color:"amber","text-color":"black",accept:"image/*",style:{"min-width":"500px"},"max-files":1,"auto-upload":"","send-raw":""},null,8,["url"]))])])])]),_:1},8,["onHide"]))}},hl=C("div",{class:"text-h6"},"Create Order",-1),Cl={class:"row q-pb-md"},Tl={class:"col"},bl={style:{border:"1px black solid","border-radius":"10px"}},yl=C("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[C("b",null,"Header")],-1),Ml={class:"row"},Dl={class:"col"},wl={class:"col q-pl-md"},kl={class:"row items-center justify-end"},Vl={class:"row"},Il={class:"col"},Rl=C("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[C("b",null,"Detail Items")],-1),Ul={key:0,class:"row q-pb-sm"},Fl={class:"col text-right"},ze={__name:"serviceCreateOrder",props:{header:Array,detail:Array,mode:String},setup(e){const{dialogRef:M,onDialogHide:f,onDialogOK:v,onDialogCancel:p}=re(),b=de(),n=e;ue(async()=>{n.header&&(await g(),await a(),h.value=n.header,_.value=n.detail,D.value=parseInt(n.header.SRVH_ISINT))});const h=w({SRVH_DOCNO:"",SRVH_ISSDT:fe.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),U=w([]),R=w([]),_=w([]),S=w(!1),D=w(0),T=w(0),t=(k,u,m,$)=>{u(async()=>{$==="cust"&&(D.value==1?await g("connect_jos","MCUS_CGCON"):await g(k)),$==="item"&&await a(k)})},g=async(k,u="MCUS_CUSNM")=>{S.value=!0,await G.post("customer/searchAPI",{searchValue:k,searchCol:u}).then(m=>{S.value=!1,R.value=m.data.data}).catch(()=>{S.value=!1})},a=async k=>{S.value=!0,await G.post("item/searchAPI",{searchValue:k,isForServ:1,isITMCD:1,useCustomer:h.value.SRVH_CUSCD}).then(u=>{S.value=!1,U.value=u.data.data}).catch(()=>{S.value=!1})},d=()=>{_.value.push({TSRVD_ITMCD:"",TSRVD_LINE:_.value.length+1,TSRVD_QTY:1,TSRVD_CUSTRMK:"",TSRVD_PHOTO:""})},l=k=>{b.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${k+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{_.value.splice(k,1)}).catch(u=>{b.notify({color:"red",message:"Something's wrong."})})},s=k=>{b.dialog({component:Pt,componentProps:{ItemCat:"SERVICE_ITEM",ItemType:3,listOpenField:["MITM_ITMCD","MITM_ITMNM","MITM_STKUOM"]}}).onOk(async u=>{console.log(u),await a(""),_.value[k].TSRVD_ITMCD=u.MITM_ITMNM})},z=()=>{b.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{S.value=!0,await G.post("servicesAdmin",{header:{...h.value,SRVH_ISINT:D.value},detail:_.value}).then(k=>{S.value=!1,v()})})},P=()=>{b.dialog({component:jt}).onOk(async k=>{console.log(k),await g(""),_.value[idx].SRVH_CUSCD=k.MCUS_CUSCD})},y=k=>{b.dialog({component:Sl,componentProps:{photo:_.value[k].TSRVD_PHOTO}}).onOk(async u=>{console.log(u),u?_.value[k].TSRVD_PHOTO=u:_.value[k].TSRVD_PHOTO="",T.value=T.value+1,console.log(_.value[k])})},O=async k=>{k==1&&(h.value.SRVH_CUSCD="",R.value=[],await g("connect_jos","MCUS_CGCON"))};return(k,u)=>(I(),N(pe,{ref_key:"dialogRef",ref:M,onHide:te(f),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:i(()=>[o(_e,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:i(()=>[o(J,null,{default:i(()=>[hl]),_:1}),o(J,{class:"q-pa-sm"},{default:i(()=>[C("div",Cl,[C("div",Tl,[o(ft,{modelValue:D.value,"onUpdate:modelValue":[u[0]||(u[0]=m=>D.value=m),u[1]||(u[1]=m=>O(m))],label:"Internal Service ?",color:"teal","true-value":1,"false-value":0,disable:S.value},null,8,["modelValue","disable"])])]),C("fieldset",bl,[yl,C("div",Ml,[C("div",Dl,[o(Q,{label:"SPK No",readonly:"",dense:"",modelValue:h.value.SRVH_DOCNO,"onUpdate:modelValue":u[2]||(u[2]=m=>h.value.SRVH_DOCNO=m),filled:""},null,8,["modelValue"])]),C("div",wl,[o(Q,{filled:"",modelValue:h.value.SRVH_ISSDT,"onUpdate:modelValue":u[4]||(u[4]=m=>h.value.SRVH_ISSDT=m),dense:"",label:"Issue Date",loading:S.value,onClick:u[5]||(u[5]=m=>k.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD",readonly:n.mode==="view"},{append:i(()=>[o(De,{name:"event",class:"cursor-pointer",disable:n.mode==="view"},{default:i(()=>[o(ht,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:i(()=>[o(Ct,{modelValue:h.value.SRVH_ISSDT,"onUpdate:modelValue":u[3]||(u[3]=m=>h.value.SRVH_ISSDT=m),mask:"YYYY-MM-DD"},{default:i(()=>[C("div",kl,[qe(o(x,{label:"Close",color:"primary",flat:""},null,512),[[Tt]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["disable"])]),_:1},8,["modelValue","loading","readonly"])])]),C("div",Vl,[C("div",Il,[o(se,{dense:"",filled:"",label:"Customer Choose",modelValue:h.value.SRVH_CUSCD,"onUpdate:modelValue":[u[7]||(u[7]=m=>h.value.SRVH_CUSCD=m),u[9]||(u[9]=m=>_.value=[])],"use-input":"","input-debounce":"500",options:R.value,onFilter:u[8]||(u[8]=(m,$,r)=>t(m,$,r,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:S.value,readonly:n.mode==="view"},{after:i(()=>[o(x,{round:"",dense:"",flat:"",icon:"person_add",onClick:u[6]||(u[6]=m=>P()),color:"cyan"},{default:i(()=>[o(j,null,{default:i(()=>[L("Add new customer")]),_:1})]),_:1})]),_:1},8,["modelValue","options","loading","readonly"])])])]),(I(),ee("fieldset",{style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"},key:T.value},[Rl,n.mode!=="view"?(I(),ee("div",Ul,[C("div",Fl,[o(x,{flat:"",icon:"add",color:"blue",onClick:u[10]||(u[10]=m=>d())},{default:i(()=>[o(j,null,{default:i(()=>[L("Add lines")]),_:1})]),_:1})])])):E("",!0),o(bt,{bordered:"",dense:""},{default:i(()=>[_.value.length>0?(I(!0),ee(Te,{key:0},be(_.value,(m,$)=>(I(),N(Pe,{key:$,class:"q-my-sm",dense:""},{default:i(()=>[o(Z,{avatar:""},{default:i(()=>[o(_t,{"text-color":"blue"},{default:i(()=>[L(ne($+1),1)]),_:2},1024)]),_:2},1024),o(Z,null,{default:i(()=>[o(Ae,{class:"text-center"},{default:i(()=>[o(se,{dense:"",filled:"",label:"Item Name",modelValue:m.TSRVD_ITMCD,"onUpdate:modelValue":r=>m.TSRVD_ITMCD=r,"use-input":"","input-debounce":"500",options:U.value,onFilter:u[11]||(u[11]=(r,A,Y)=>t(r,A,Y,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:S.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),o(Z,null,{default:i(()=>[o(Q,{label:"Qty",filled:"",dense:"",modelValue:m.TSRVD_QTY,"onUpdate:modelValue":r=>m.TSRVD_QTY=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(Z,null,{default:i(()=>[o(Q,{label:"Problem",filled:"",dense:"",modelValue:m.TSRVD_CUSTRMK,"onUpdate:modelValue":r=>m.TSRVD_CUSTRMK=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),n.mode!=="view"?(I(),N(Z,{key:0,side:""},{default:i(()=>[o(x,{icon:"delete",color:"red",flat:"",onClick:r=>l($),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L("Delete line")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):E("",!0),n.mode!=="view"?(I(),N(Z,{key:1,side:""},{default:i(()=>[o(x,{icon:"library_add",color:"indigo",flat:"",onClick:r=>s($),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L("Add new item")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):E("",!0),n.mode!=="view"?(I(),N(Z,{key:2,side:""},{default:i(()=>[o(x,{icon:"photo",color:m.TSRVD_PHOTO!=""?"blue":"orange",flat:"",onClick:r=>y($),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L("Add photo")]),_:1})]),_:2},1032,["color","onClick"])]),_:2},1024)):E("",!0)]),_:2},1024))),128)):qe((I(),N(Pe,{key:1,class:"q-my-sm",clickable:""},{default:i(()=>[o(Z,null,{default:i(()=>[o(Ae,null,{default:i(()=>[L(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[gt]])]),_:1})]))]),_:1}),o(ge,{align:"right"},{default:i(()=>[o(x,{label:"OK",color:"primary",onClick:u[12]||(u[12]=m=>z()),disable:S.value,loading:S.value},null,8,["disable","loading"]),o(x,{flat:"",label:"Cancel",color:"red",onClick:te(p),loading:S.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const Ol={class:"q-pa-md"},ql={class:"row q-pb-md"},Nl=C("div",{class:"col"},[C("span",{class:"text-h4"},"Receive Order ")],-1),$l={class:"col text-right"},xl={class:"row q-pt-md"},Pl={class:"col"},Al={key:1},na={__name:"serviceView",setup(e){const M=de(),f=w("SRVH_DOCNO"),v=w(""),p=w([]),b=w([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Cust",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"STAT",label:"Status",field:a=>g(a),sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left",format:a=>fe.formatDate(new Date(a),"DD MMM YYYY")}]),n=w(!1),h=w(null);ue(()=>{U(),h.value=setInterval(()=>{U()},1e4)});const U=async()=>{n.value=!0,await G.post("servicesAdmins/search",{searchBy:f.value,searchValue:v.value}).then(a=>{n.value=!1,p.value=a.data.data}).catch(a=>{n.value=!1})},R=()=>{M.dialog({component:ze}).onOk(async a=>{U()})},_=a=>{const d={SRVH_DOCNO:a.SRVH_DOCNO,SRVH_ISSDT:fe.formatDate(a.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:a.MCUS_CUSCD};let l=[];a.detail.map(s=>{l.push({id:s.id,TSRVD_ITMCD:s.TSRVD_ITMCD,TSRVD_LINE:s.TSRVD_LINE,TSRVD_QTY:s.TSRVD_QTY,TSRVD_CUSTRMK:s.TSRVD_CUSTRMK,TSRVD_REMARK:s.TSRVD_REMARK,TSRVD_FLGSTS:s.TSRVD_FLGSTS,listFixDet:s.list_fix_det})}),M.dialog({component:Dt,componentProps:{header:d,detail:l,mode:a.detail.filter(s=>s.TSRVD_FLGSTS===1).length===a.detail.length?"approvecust":"view"}}).onOk(async s=>{U()})},S=a=>{window.open("https://joss.jatpowerindo.co.id/servicesAdmins/printInvoice/"+btoa(a),"_blank").focus()},D=a=>{const d={SRVH_DOCNO:a.SRVH_DOCNO,SRVH_ISSDT:fe.formatDate(a.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:a.MCUS_CUSCD};let l=[];a.detail.map(s=>{l.push({TSRVD_ITMCD:s.TSRVD_ITMCD,TSRVD_LINE:s.TSRVD_LINE,TSRVD_QTY:s.TSRVD_QTY,TSRVD_CUSTRMK:s.TSRVD_CUSTRMK})}),M.dialog({component:ze,componentProps:{header:d,detail:l}}).onOk(async s=>{U()})},T=a=>{M.dialog({title:"Confirmation",message:"Do you want to proceed to service ?",cancel:!0,persistent:!0}).onOk(async()=>{n.value=!0,await G.put(`servicesAdmins/updateDetByIDHead/${btoa(a.id)}`,{TSRVD_FLGSTS:2}).then(d=>{n.value=!1}).catch(d=>{n.value=!1})})},t=a=>{M.dialog({title:"Confirmation",message:"Are you sure want to delete this order ?",cancel:!0,persistent:!0}).onOk(async()=>{n.value=!0,await G.delete(`servicesAdmin/${btoa(a.SRVH_DOCNO)}`).then(d=>{n.value=!1}).catch(d=>{n.value=!1})})},g=a=>{const d=a.detail.filter(y=>y.TSRVD_FLGSTS==0),l=a.detail.filter(y=>y.TSRVD_FLGSTS==1),s=a.detail.filter(y=>y.TSRVD_FLGSTS==2),z=a.detail.filter(y=>y.TSRVD_FLGSTS==3),P=a.detail.filter(y=>y.TSRVD_FLGSTS==5);if(d.length==a.detail.length)return{color:"red",label:"No Price Added yet !",icon:"edit"};if(l.length>0&&l.length<a.detail.length)return{color:"warning",label:"Please Add item & price",icon:"payments"};if(P.length>0&&P.length==a.detail.length)return{color:"indigo",label:"Added Price Done, Waiting Manager Confirmation",icon:"price_check"};if(l.length>0&&l.length==a.detail.length)return{color:"green",label:"Manager has been approve, Waiting Cust. Confirmation",icon:"price_check"};if(s.length>0&&s.length>=a.detail.length)return{color:"cyan",label:"Cust. has been approved, continue to fix.",icon:"engineering"};if(z.length>0&&z.length===a.detail.length)return{color:"primary",label:"Fix has been done",icon:"fact_check"}};return(a,d)=>(I(),ee("div",Ol,[C("div",ql,[Nl,C("div",$l,[o(x,{icon:"add",color:"blue",onClick:R},{default:i(()=>[o(j,null,{default:i(()=>[L("Create New Order")]),_:1})]),_:1})])]),o(Ye),C("div",xl,[C("div",Pl,[o(St,{title:"Created Order",rows:p.value,columns:b.value,"row-key":"name",loading:n.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":i(()=>[o(se,{outlined:"",modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=l=>f.value=l),options:b.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),o(Q,{borderless:"",dense:"",modelValue:v.value,"onUpdate:modelValue":[d[1]||(d[1]=l=>v.value=l),d[2]||(d[2]=l=>a.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:i(()=>[o(De,{name:"search"})]),_:1},8,["modelValue"])]),header:i(l=>[o($e,{props:l},{default:i(()=>[(I(!0),ee(Te,null,be(l.cols,s=>(I(),N(Ne,{key:s.name,props:l},{default:i(()=>[L(ne(s.label),1)]),_:2},1032,["props"]))),128)),o(Ne,{"auto-width":""},{default:i(()=>[L("Action")]),_:1})]),_:2},1032,["props"])]),body:i(l=>[o($e,{props:l},{default:i(()=>[(I(!0),ee(Te,null,be(l.cols,s=>(I(),N(xe,{key:s.name,props:l},{default:i(()=>[s.name==="STAT"?(I(),N(pt,{key:0,clickable:"",color:s.value.color,"text-color":"white",icon:s.value.icon},{default:i(()=>[L(ne(s.value.label),1)]),_:2},1032,["color","icon"])):(I(),ee("span",Al,ne(s.value),1))]),_:2},1032,["props"]))),128)),o(xe,{"auto-width":""},{default:i(()=>[l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length===0?(I(),N(x,{key:0,flat:"",color:"orange",icon:"edit",onClick:s=>D(l.row),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L("Edit this Order")]),_:1})]),_:2},1032,["onClick"])):E("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length===l.row.detail.length?(I(),N(x,{key:1,flat:"",color:"indigo",icon:"print",onClick:s=>S(l.row.SRVH_DOCNO),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L("Print Estimation Price")]),_:1})]),_:2},1032,["onClick"])):E("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length===0?(I(),N(x,{key:2,flat:"",color:"red",icon:"delete",onClick:s=>t(l.row.SRVH_DOCNO),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L(ne(l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length>0?"Cannot delete processed order":"Delete this Order"),1)]),_:2},1024)]),_:2},1032,["onClick"])):E("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length>0?(I(),N(x,{key:3,flat:"",color:"cyan",icon:"visibility",onClick:s=>_(l.row),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L("View this Order")]),_:1})]),_:2},1032,["onClick"])):E("",!0),l.row.detail.filter(s=>s.TSRVD_FLGSTS==1).length===l.row.detail.length?(I(),N(x,{key:4,flat:"",color:"indigo",icon:"check",onClick:s=>T(l.row),dense:""},{default:i(()=>[o(j,null,{default:i(()=>[L(ne(l.row.detail.filter(s=>s.TSRVD_FLGSTS>0).length!==l.row.detail.length?"Please wait until all item checked":"Proceed all item to service"),1)]),_:2},1024)]),_:2},1032,["onClick"])):E("",!0)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{na as default};
