import{Q}from"./QTooltip.bdbd830a.js";import{s as T,o as Se,B as F,C as $,D as s,E as l,L as he,M as ne,I as p,Z as E,W as Ce,Q as x,X as Z,Y as _e,av as Ke,c as Le,aw as Ge,a as q,h as V,ay as We,g as be,aO as Ee,ab as ze,ag as Xe,ah as Ze,aj as Je,bd as et,p as tt,be as lt,w as at,j as ot,bf as nt,aW as it,aV as st,bg as Ue,am as De,aU as ut,T as Ie,H as A,P as oe,a$ as G,R as fe,S as pe,U as rt,O as ae,V as dt,aX as ct}from"./index.5e9dba61.js";import{u as re,k as se,t as mt,w as Fe,Q as _t,a as Oe,b as W,c as qe,j as vt,l as xe,x as ft}from"./QTable.3873ce7c.js";import{Q as Ne,a as $e}from"./QTd.798a5fa3.js";import{d as me}from"./date.41aa1c6d.js";import{api_web as Y}from"./axios.bf14412d.js";import{Q as pt,a as gt,C as St}from"./ClosePopup.6e9fb319.js";import{u as ue,g as ht}from"./use-dialog-plugin-component.2cdcce98.js";import{_ as Ct}from"./serviceOprUpdateOrder.0256e4a4.js";import"./use-cache.b0833c75.js";import"./QBtnGroup.97659690.js";import"./QBadge.7de80d54.js";import"./serviceOprItemAdd.b0891de1.js";const bt=p("div",{class:"text-h6"},"Create Item Master",-1),Dt={class:"row"},Tt={class:"col"},Mt={class:"col q-pl-md"},yt={class:"row q-pt-md"},wt={class:"col"},Vt={class:"col q-pl-md"},kt={class:"row q-pt-md"},Rt={class:"col"},Ut={class:"col q-pl-md"},It={class:"row q-pt-md"},Ft={class:"col"},Ot={__name:"itemCreate",props:{ItemCat:String},setup(a){const{dialogRef:D,onDialogHide:_,onDialogOK:d,onDialogCancel:v}=ue(),C=re(),i=T({MITM_ITMCD:"",MITM_ITMNM:"",MITM_STKUOM:"",MITM_ITMTYPE:1,MITM_BRAND:"",MITM_MODEL:"",MITM_SPEC:"",MITM_ITMCAT:"",MITM_COACD:"",MITM_ITMCAT:""}),g=T(!1),R=T([]),U=T([]),h=a;Se(()=>{M(),i.value.MITM_ITMCAT=h.ItemCat});const b=(e,c,o,m)=>{c(async()=>{await Y.post("item/getListCoasAPI",{search:e}).then(t=>{U.value=t.data})})},N=()=>{C.dialog({title:"Confirmation",message:"Do you want to save this item ?",cancel:!0,persistent:!0}).onOk(async()=>{await Y.post("item",i.value).then(e=>{d(e.data.data.value)})})},M=async()=>{g.value=!0,await Y.get("item/formAPI").then(e=>{g.value=!1,R.value=e.data.uoms,U.value=e.data.coas}).catch(()=>{g.value=!1})};return(e,c)=>(F(),$(_e,{ref_key:"dialogRef",ref:D,onHide:Z(_),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:s(()=>[l(he,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:s(()=>[l(ne,null,{default:s(()=>[bt]),_:1}),l(ne,{class:"q-pa-sm"},{default:s(()=>[p("div",Dt,[p("div",Tt,[l(E,{label:"Item Code",dense:"",modelValue:i.value.MITM_ITMCD,"onUpdate:modelValue":c[0]||(c[0]=o=>i.value.MITM_ITMCD=o),filled:""},null,8,["modelValue"])]),p("div",Mt,[l(E,{label:"Item Name",dense:"",modelValue:i.value.MITM_ITMNM,"onUpdate:modelValue":c[1]||(c[1]=o=>i.value.MITM_ITMNM=o),filled:""},null,8,["modelValue"])])]),p("div",yt,[p("div",wt,[l(se,{dense:"",filled:"",label:"UOM",modelValue:i.value.MITM_STKUOM,"onUpdate:modelValue":c[2]||(c[2]=o=>i.value.MITM_STKUOM=o),options:R.value,behavior:"dialog","option-label":"MUOM_UOMNM","option-value":"MUOM_UOMCD","emit-value":"","map-options":"",loading:g.value},null,8,["modelValue","options","loading"])]),p("div",Vt,[l(E,{label:"Item Brand",dense:"",modelValue:i.value.MITM_BRAND,"onUpdate:modelValue":c[3]||(c[3]=o=>i.value.MITM_BRAND=o),filled:""},null,8,["modelValue"])])]),p("div",kt,[p("div",Rt,[l(E,{label:"Item Model",dense:"",modelValue:i.value.MITM_MODEL,"onUpdate:modelValue":c[4]||(c[4]=o=>i.value.MITM_MODEL=o),filled:""},null,8,["modelValue"])]),p("div",Ut,[l(E,{label:"Item Specification",dense:"",modelValue:i.value.MITM_SPEC,"onUpdate:modelValue":c[5]||(c[5]=o=>i.value.MITM_SPEC=o),filled:""},null,8,["modelValue"])])]),p("div",It,[p("div",Ft,[l(se,{dense:"",filled:"",label:"COA",modelValue:i.value.MITM_COACD,"onUpdate:modelValue":c[6]||(c[6]=o=>i.value.MITM_COACD=o),options:U.value,"use-input":"",behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD",onFilter:c[7]||(c[7]=(o,m,t)=>b(o,m,t)),"emit-value":"","map-options":"",loading:g.value},null,8,["modelValue","options","loading"])])])]),_:1}),l(Ce,{align:"right"},{default:s(()=>[l(x,{label:"OK",color:"primary",onClick:c[8]||(c[8]=o=>N())}),l(x,{flat:"",label:"Cancel",color:"red",onClick:Z(v)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},qt=p("div",{class:"text-h6"},"Create New Customer Data",-1),xt={class:"row q-pb-md"},Nt={class:"col"},$t={class:"row q-pb-md"},At={class:"col"},Pt={class:"col q-pl-md"},Lt={class:"row"},Et={class:"col"},zt={__name:"customerView",setup(a){const{dialogRef:D,onDialogHide:_,onDialogOK:d,onDialogCancel:v}=ue(),C=re(),i=T({MCUS_CUSCD:"",MCUS_CUSNM:"",MCUS_CURCD:"IDR",MCUS_TAXREG:"-",MCUS_ADDR1:"",MCUS_TELNO:"",MCUS_PIC_NAME:"-",MCUS_PIC_TELNO:"-",MCUS_TYPE:1,MCUS_GROUP:"SERVICE",MCUS_EMAIL:""}),g=T(!1),R=()=>{C.dialog({title:"Confirmation",message:"Do you want to save this customer ?",cancel:!0,persistent:!0}).onOk(async()=>{g.value=!0,await Y.post("customer",i.value).then(U=>{g.value=!1,d(U.data)}).catch(U=>{g.value=!1})})};return(U,h)=>(F(),$(_e,{ref_key:"dialogRef",ref:D,onHide:Z(_),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:s(()=>[l(he,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:s(()=>[l(ne,null,{default:s(()=>[qt]),_:1}),l(ne,{class:"q-pa-sm"},{default:s(()=>[p("div",xt,[p("div",Nt,[l(E,{label:"Customer Name",dense:"",modelValue:i.value.MCUS_CUSNM,"onUpdate:modelValue":h[0]||(h[0]=b=>i.value.MCUS_CUSNM=b),filled:""},null,8,["modelValue"])])]),p("div",$t,[p("div",At,[l(E,{label:"Customer Email",dense:"",modelValue:i.value.MCUS_EMAIL,"onUpdate:modelValue":h[1]||(h[1]=b=>i.value.MCUS_EMAIL=b),filled:""},null,8,["modelValue"])]),p("div",Pt,[l(E,{label:"Customer Phone",dense:"",modelValue:i.value.MCUS_TELNO,"onUpdate:modelValue":h[2]||(h[2]=b=>i.value.MCUS_TELNO=b),filled:"",mask:"####-####-####"},null,8,["modelValue"])])]),p("div",Lt,[p("div",Et,[l(E,{label:"Customer Address",dense:"",modelValue:i.value.MCUS_ADDR1,"onUpdate:modelValue":h[3]||(h[3]=b=>i.value.MCUS_ADDR1=b),filled:"",type:"textarea"},null,8,["modelValue"])])])]),_:1}),l(Ce,{align:"right"},{default:s(()=>[l(x,{label:"OK",color:"primary",onClick:h[4]||(h[4]=b=>R()),loading:g.value},null,8,["loading"]),l(x,{flat:"",label:"Cancel",color:"red",onClick:Z(v),loading:g.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Ht={...Ke,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:a=>a>=0&&a<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},ge=50,He=2*ge,Qe=He*Math.PI,Qt=Math.round(Qe*1e3)/1e3;var Bt=Le({name:"QCircularProgress",props:{...Ht,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(a,{slots:D}){const{proxy:{$q:_}}=be(),d=Ge(a),v=q(()=>{const M=(_.lang.rtl===!0?-1:1)*a.angle;return{transform:a.reverse!==(_.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-M}deg)`:`rotate3d(0, 0, 1, ${M-90}deg)`}}),C=q(()=>a.instantFeedback!==!0&&a.indeterminate!==!0?{transition:`stroke-dashoffset ${a.animationSpeed}ms ease 0s, stroke ${a.animationSpeed}ms ease`}:""),i=q(()=>He/(1-a.thickness/2)),g=q(()=>`${i.value/2} ${i.value/2} ${i.value} ${i.value}`),R=q(()=>mt(a.value,a.min,a.max)),U=q(()=>a.max-a.min),h=q(()=>a.thickness/2*i.value),b=q(()=>{const M=(a.max-R.value)/U.value,e=a.rounded===!0&&R.value<a.max&&M<.25?h.value/2*(1-M/.25):0;return Qe*M+e});function N({thickness:M,offset:e,color:c,cls:o,rounded:m}){return V("circle",{class:"q-circular-progress__"+o+(c!==void 0?` text-${c}`:""),style:C.value,fill:"transparent",stroke:"currentColor","stroke-width":M,"stroke-dasharray":Qt,"stroke-dashoffset":e,"stroke-linecap":m,cx:i.value,cy:i.value,r:ge})}return()=>{const M=[];a.centerColor!==void 0&&a.centerColor!=="transparent"&&M.push(V("circle",{class:`q-circular-progress__center text-${a.centerColor}`,fill:"currentColor",r:ge-h.value/2,cx:i.value,cy:i.value})),a.trackColor!==void 0&&a.trackColor!=="transparent"&&M.push(N({cls:"track",thickness:h.value,offset:0,color:a.trackColor})),M.push(N({cls:"circle",thickness:h.value,offset:b.value,color:a.color,rounded:a.rounded===!0?"round":void 0}));const e=[V("svg",{class:"q-circular-progress__svg",style:v.value,viewBox:g.value,"aria-hidden":"true"},M)];return a.showValue===!0&&e.push(V("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:a.fontSize}},D.default!==void 0?D.default():[V("div",R.value)])),V("div",{class:`q-circular-progress q-circular-progress--${a.indeterminate===!0?"in":""}determinate`,style:d.value,role:"progressbar","aria-valuemin":a.min,"aria-valuemax":a.max,"aria-valuenow":a.indeterminate===!0?void 0:R.value},We(D.internal,e))}}});function le(a,D,_,d){const v=[];return a.forEach(C=>{d(C)===!0?v.push(C):D.push({failedPropValidation:_,file:C})}),v}function ce(a){a&&a.dataTransfer&&(a.dataTransfer.dropEffect="copy"),ze(a)}const Yt={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},jt=["rejected"];function Kt({editable:a,dnd:D,getFileInput:_,addFilesToQueue:d}){const{props:v,emit:C,proxy:i}=be(),g=T(null),R=q(()=>v.accept!==void 0?v.accept.split(",").map(t=>(t=t.trim(),t==="*"?"*/":(t.endsWith("/*")&&(t=t.slice(0,t.length-1)),t.toUpperCase()))):null),U=q(()=>parseInt(v.maxFiles,10)),h=q(()=>parseInt(v.maxTotalSize,10));function b(t){if(a.value)if(t!==Object(t)&&(t={target:null}),t.target!==null&&t.target.matches('input[type="file"]')===!0)t.clientX===0&&t.clientY===0&&Ee(t);else{const u=_();u&&u!==t.target&&u.click(t)}}function N(t){a.value&&t&&d(null,t)}function M(t,u,z,y){let n=Array.from(u||t.target.files);const f=[],O=()=>{f.length!==0&&C("rejected",f)};if(v.accept!==void 0&&R.value.indexOf("*/")===-1&&(n=le(n,f,"accept",S=>R.value.some(I=>S.type.toUpperCase().startsWith(I)||S.name.toUpperCase().endsWith(I))),n.length===0))return O();if(v.maxFileSize!==void 0){const S=parseInt(v.maxFileSize,10);if(n=le(n,f,"max-file-size",I=>I.size<=S),n.length===0)return O()}if(v.multiple!==!0&&n.length!==0&&(n=[n[0]]),n.forEach(S=>{S.__key=S.webkitRelativePath+S.lastModified+S.name+S.size}),y===!0){const S=z.map(I=>I.__key);n=le(n,f,"duplicate",I=>S.includes(I.__key)===!1)}if(n.length===0)return O();if(v.maxTotalSize!==void 0){let S=y===!0?z.reduce((I,H)=>I+H.size,0):0;if(n=le(n,f,"max-total-size",I=>(S+=I.size,S<=h.value)),n.length===0)return O()}if(typeof v.filter=="function"){const S=v.filter(n);n=le(n,f,"filter",I=>S.includes(I))}if(v.maxFiles!==void 0){let S=y===!0?z.length:0;if(n=le(n,f,"max-files",()=>(S++,S<=U.value)),n.length===0)return O()}if(O(),n.length!==0)return n}function e(t){ce(t),D.value!==!0&&(D.value=!0)}function c(t){ze(t),(t.relatedTarget!==null||Xe.is.safari!==!0?t.relatedTarget!==g.value:document.elementsFromPoint(t.clientX,t.clientY).includes(g.value)===!1)===!0&&(D.value=!1)}function o(t){ce(t);const u=t.dataTransfer.files;u.length!==0&&d(null,u),D.value=!1}function m(t){if(D.value===!0)return V("div",{ref:g,class:`q-${t}__dnd absolute-full`,onDragenter:ce,onDragover:ce,onDragleave:c,onDrop:o})}return Object.assign(i,{pickFiles:b,addFiles:N}),{pickFiles:b,addFiles:N,onDragover:e,onDragleave:c,processFiles:M,getDndNode:m,maxFilesNumber:U,maxTotalSizeNumber:h}}function Ae(a){return(a*100).toFixed(2)+"%"}const Gt={...Ze,...Yt,label:String,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,noThumbnails:Boolean,autoUpload:Boolean,hideUploadBtn:Boolean,disable:Boolean,readonly:Boolean},Be=[...jt,"start","finish","added","removed"];function Wt(a,D){const _=be(),{props:d,slots:v,emit:C,proxy:i}=_,{$q:g}=i,R=Je(d,g);function U(r,k,P){if(r.__status=k,k==="idle"){r.__uploaded=0,r.__progress=0,r.__sizeLabel=Fe(r.size),r.__progressLabel="0.00%";return}if(k==="failed"){i.$forceUpdate();return}r.__uploaded=k==="uploaded"?r.size:P,r.__progress=k==="uploaded"?1:Math.min(.9999,r.__uploaded/r.size),r.__progressLabel=Ae(r.__progress),i.$forceUpdate()}const h=q(()=>d.disable!==!0&&d.readonly!==!0),b=T(!1),N=T(null),M=T(null),e={files:T([]),queuedFiles:T([]),uploadedFiles:T([]),uploadedSize:T(0),updateFileStatus:U,isAlive:()=>et(_)===!1},{pickFiles:c,addFiles:o,onDragover:m,onDragleave:t,processFiles:u,getDndNode:z,maxFilesNumber:y,maxTotalSizeNumber:n}=Kt({editable:h,dnd:b,getFileInput:ye,addFilesToQueue:we});Object.assign(e,a({props:d,slots:v,emit:C,helpers:e,exposeApi:r=>{Object.assign(e,r)}})),e.isBusy===void 0&&(e.isBusy=T(!1));const f=T(0),O=q(()=>f.value===0?0:e.uploadedSize.value/f.value),S=q(()=>Ae(O.value)),I=q(()=>Fe(f.value)),H=q(()=>h.value===!0&&e.isUploading.value!==!0&&(d.multiple===!0||e.queuedFiles.value.length===0)&&(d.maxFiles===void 0||e.files.value.length<y.value)&&(d.maxTotalSize===void 0||f.value<n.value)),w=q(()=>h.value===!0&&e.isBusy.value!==!0&&e.isUploading.value!==!0&&e.queuedFiles.value.length!==0);tt(lt,ke);const X=q(()=>"q-uploader column no-wrap"+(R.value===!0?" q-uploader--dark q-dark":"")+(d.bordered===!0?" q-uploader--bordered":"")+(d.square===!0?" q-uploader--square no-border-radius":"")+(d.flat===!0?" q-uploader--flat no-shadow":"")+(d.disable===!0?" disabled q-uploader--disable":"")+(b.value===!0?" q-uploader--dnd":"")),J=q(()=>"q-uploader__header"+(d.color!==void 0?` bg-${d.color}`:"")+(d.textColor!==void 0?` text-${d.textColor}`:""));at(e.isUploading,(r,k)=>{k===!1&&r===!0?C("start"):k===!0&&r===!1&&C("finish")});function ee(){d.disable===!1&&(e.abort(),e.uploadedSize.value=0,f.value=0,Me(),e.files.value=[],e.queuedFiles.value=[],e.uploadedFiles.value=[])}function B(){d.disable===!1&&Te(["uploaded"],()=>{e.uploadedFiles.value=[]})}function de(){Te(["idle","failed"],({size:r})=>{f.value-=r,e.queuedFiles.value=[]})}function Te(r,k){if(d.disable===!0)return;const P={files:[],size:0},j=e.files.value.filter(L=>r.indexOf(L.__status)===-1?!0:(P.size+=L.size,P.files.push(L),L.__img!==void 0&&window.URL.revokeObjectURL(L.__img.src),!1));P.files.length!==0&&(e.files.value=j,k(P),C("removed",P.files))}function ve(r){d.disable||(r.__status==="uploaded"?e.uploadedFiles.value=e.uploadedFiles.value.filter(k=>k.__key!==r.__key):r.__status==="uploading"?r.__abort():f.value-=r.size,e.files.value=e.files.value.filter(k=>k.__key!==r.__key?!0:(k.__img!==void 0&&window.URL.revokeObjectURL(k.__img.src),!1)),e.queuedFiles.value=e.queuedFiles.value.filter(k=>k.__key!==r.__key),C("removed",[r]))}function Me(){e.files.value.forEach(r=>{r.__img!==void 0&&window.URL.revokeObjectURL(r.__img.src)})}function ye(){return M.value||N.value.getElementsByClassName("q-uploader__input")[0]}function we(r,k){const P=u(r,k,e.files.value,!0),j=ye();j!=null&&(j.value=""),P!==void 0&&(P.forEach(L=>{if(e.updateFileStatus(L,"idle"),f.value+=L.size,d.noThumbnails!==!0&&L.type.toUpperCase().startsWith("IMAGE")){const Re=new Image;Re.src=window.URL.createObjectURL(L),L.__img=Re}}),e.files.value=e.files.value.concat(P),e.queuedFiles.value=e.queuedFiles.value.concat(P),C("added",P),d.autoUpload===!0&&e.upload())}function Ve(){w.value===!0&&e.upload()}function ie(r,k,P){if(r===!0){const j={type:"a",key:k,icon:g.iconSet.uploader[k],flat:!0,dense:!0};let L;return k==="add"?(j.onClick=c,L=ke):j.onClick=P,V(x,j,L)}}function ke(){return V("input",{ref:M,class:"q-uploader__input overflow-hidden absolute-full",tabindex:-1,type:"file",title:"",accept:d.accept,multiple:d.multiple===!0?"multiple":void 0,capture:d.capture,onMousedown:Ee,onClick:c,onChange:we})}function Ye(){return v.header!==void 0?v.header(te):[V("div",{class:"q-uploader__header-content column"},[V("div",{class:"flex flex-center no-wrap q-gutter-xs"},[ie(e.queuedFiles.value.length!==0,"removeQueue",de),ie(e.uploadedFiles.value.length!==0,"removeUploaded",B),e.isUploading.value===!0?V(Ue,{class:"q-uploader__spinner"}):null,V("div",{class:"col column justify-center"},[d.label!==void 0?V("div",{class:"q-uploader__title"},[d.label]):null,V("div",{class:"q-uploader__subtitle"},[I.value+" / "+S.value])]),ie(H.value,"add"),ie(d.hideUploadBtn===!1&&w.value===!0,"upload",e.upload),ie(e.isUploading.value,"clear",e.abort)])])]}function je(){return v.list!==void 0?v.list(te):e.files.value.map(r=>V("div",{key:r.__key,class:"q-uploader__file relative-position"+(d.noThumbnails!==!0&&r.__img!==void 0?" q-uploader__file--img":"")+(r.__status==="failed"?" q-uploader__file--failed":r.__status==="uploaded"?" q-uploader__file--uploaded":""),style:d.noThumbnails!==!0&&r.__img!==void 0?{backgroundImage:'url("'+r.__img.src+'")'}:null},[V("div",{class:"q-uploader__file-header row flex-center no-wrap"},[r.__status==="failed"?V(De,{class:"q-uploader__file-status",name:g.iconSet.type.negative,color:"negative"}):null,V("div",{class:"q-uploader__file-header-content col"},[V("div",{class:"q-uploader__title"},[r.name]),V("div",{class:"q-uploader__subtitle row items-center no-wrap"},[r.__sizeLabel+" / "+r.__progressLabel])]),r.__status==="uploading"?V(Bt,{value:r.__progress,min:0,max:1,indeterminate:r.__progress===0}):V(x,{round:!0,dense:!0,flat:!0,icon:g.iconSet.uploader[r.__status==="uploaded"?"done":"clear"],onClick:()=>{ve(r)}})])]))}ot(()=>{e.isUploading.value===!0&&e.abort(),e.files.value.length!==0&&Me()});const te={};for(const r in e)nt(e[r])===!0?it(te,r,()=>e[r].value):te[r]=e[r];return Object.assign(te,{upload:Ve,reset:ee,removeUploadedFiles:B,removeQueuedFiles:de,removeFile:ve,pickFiles:c,addFiles:o}),st(te,{canAddFiles:()=>H.value,canUpload:()=>w.value,uploadSizeLabel:()=>I.value,uploadProgressLabel:()=>S.value}),D({...e,upload:Ve,reset:ee,removeUploadedFiles:B,removeQueuedFiles:de,removeFile:ve,pickFiles:c,addFiles:o,canAddFiles:H,canUpload:w,uploadSizeLabel:I,uploadProgressLabel:S}),()=>{const r=[V("div",{class:J.value},Ye()),V("div",{class:"q-uploader__list scroll"},je()),z("uploader")];e.isBusy.value===!0&&r.push(V("div",{class:"q-uploader__overlay absolute-full flex flex-center"},[V(Ue)]));const k={ref:N,class:X.value};return H.value===!0&&Object.assign(k,{onDragover:m,onDragleave:t}),V("div",k,r)}}const Xt=ht(Be);var Zt=({name:a,props:D,emits:_,injectPlugin:d})=>Le({name:a,props:{...Gt,...D},emits:ut(_)===!0?{...Xt,..._}:[...Be,..._],setup(v,{expose:C}){return Wt(d,C)}});function K(a){return typeof a=="function"?a:()=>a}const Jt={url:[Function,String],method:{type:[Function,String],default:"POST"},fieldName:{type:[Function,String],default:()=>a=>a.name},headers:[Function,Array],formFields:[Function,Array],withCredentials:[Function,Boolean],sendRaw:[Function,Boolean],batch:[Function,Boolean],factory:Function},el=["factoryFailed","uploaded","failed","uploading"];function tl({props:a,emit:D,helpers:_}){const d=T([]),v=T([]),C=T(0),i=q(()=>({url:K(a.url),method:K(a.method),headers:K(a.headers),formFields:K(a.formFields),fieldName:K(a.fieldName),withCredentials:K(a.withCredentials),sendRaw:K(a.sendRaw),batch:K(a.batch)})),g=q(()=>C.value>0),R=q(()=>v.value.length!==0);let U;function h(){d.value.forEach(e=>{e.abort()}),v.value.length!==0&&(U=!0)}function b(){const e=_.queuedFiles.value.slice(0);_.queuedFiles.value=[],i.value.batch(e)?N(e):e.forEach(c=>{N([c])})}function N(e){if(C.value++,typeof a.factory!="function"){M(e,{});return}const c=a.factory(e);if(!c)D("factoryFailed",new Error("QUploader: factory() does not return properly"),e),C.value--;else if(typeof c.catch=="function"&&typeof c.then=="function"){v.value.push(c);const o=m=>{_.isAlive()===!0&&(v.value=v.value.filter(t=>t!==c),v.value.length===0&&(U=!1),_.queuedFiles.value=_.queuedFiles.value.concat(e),e.forEach(t=>{_.updateFileStatus(t,"failed")}),D("factoryFailed",m,e),C.value--)};c.then(m=>{U===!0?o(new Error("Aborted")):_.isAlive()===!0&&(v.value=v.value.filter(t=>t!==c),M(e,m))}).catch(o)}else M(e,c||{})}function M(e,c){const o=new FormData,m=new XMLHttpRequest,t=(w,X)=>c[w]!==void 0?K(c[w])(X):i.value[w](X),u=t("url",e);if(!u){console.error("q-uploader: invalid or no URL specified"),C.value--;return}const z=t("formFields",e);z!==void 0&&z.forEach(w=>{o.append(w.name,w.value)});let y=0,n=0,f=0,O=0,S;m.upload.addEventListener("progress",w=>{if(S===!0)return;const X=Math.min(O,w.loaded);_.uploadedSize.value+=X-f,f=X;let J=f-n;for(let ee=y;J>0&&ee<e.length;ee++){const B=e[ee];if(J>B.size)J-=B.size,y++,n+=B.size,_.updateFileStatus(B,"uploading",B.size);else{_.updateFileStatus(B,"uploading",J);return}}},!1),m.onreadystatechange=()=>{m.readyState<4||(m.status&&m.status<400?(_.uploadedFiles.value=_.uploadedFiles.value.concat(e),e.forEach(w=>{_.updateFileStatus(w,"uploaded")}),D("uploaded",{files:e,xhr:m})):(S=!0,_.uploadedSize.value-=f,_.queuedFiles.value=_.queuedFiles.value.concat(e),e.forEach(w=>{_.updateFileStatus(w,"failed")}),D("failed",{files:e,xhr:m})),C.value--,d.value=d.value.filter(w=>w!==m))},m.open(t("method",e),u),t("withCredentials",e)===!0&&(m.withCredentials=!0);const I=t("headers",e);I!==void 0&&I.forEach(w=>{m.setRequestHeader(w.name,w.value)});const H=t("sendRaw",e);e.forEach(w=>{_.updateFileStatus(w,"uploading",0),H!==!0&&o.append(t("fieldName",w),w,w.name),w.xhr=m,w.__abort=()=>{m.abort()},O+=w.size}),D("uploading",{files:e,xhr:m}),d.value.push(m),H===!0?m.send(new Blob(e)):m.send(o)}return{isUploading:g,isBusy:R,abort:h,upload:b}}var ll={name:"QUploader",props:Jt,emits:el,injectPlugin:tl},al=Zt(ll);const ol={class:"bg-white"},nl={class:"row",style:{height:"50vh"}},il={class:"col"},sl={__name:"uploadPhoto",emits:[...ue.emits],setup(a){re(),T("");const D=i=>new Promise((g,R)=>{g(U=>v(U))}),{dialogRef:_,onDialogHide:d,onDialogOK:v,onDialogCancel:C}=ue();return(i,g)=>(F(),$(_e,{ref_key:"dialogRef",ref:_,onHide:Z(d)},{default:s(()=>[p("div",ol,[p("div",nl,[p("div",il,[l(al,{class:"full-height",label:"Upload Photo",color:"amber","text-color":"black",accept:"image/*",style:{"min-width":"500px"},"max-files":1,"auto-upload":"",factory:D,"send-raw":""})])])])]),_:1},8,["onHide"]))}},ul=p("div",{class:"text-h6"},"Create Order",-1),rl={style:{border:"1px black solid","border-radius":"10px"}},dl=p("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[p("b",null,"Header")],-1),cl={class:"row"},ml={class:"col"},_l={class:"col q-pl-md"},vl={class:"row items-center justify-end"},fl={class:"row"},pl={class:"col"},gl={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Sl=p("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[p("b",null,"Detail Items")],-1),hl={key:0,class:"row q-pb-sm"},Cl={class:"col text-right"},Pe={__name:"serviceCreateOrder",props:{header:Array,detail:Array,mode:String},setup(a){const{dialogRef:D,onDialogHide:_,onDialogOK:d,onDialogCancel:v}=ue(),C=re(),i=a;Se(async()=>{i.header&&(await M(),await e(),g.value=i.header,h.value=i.detail)});const g=T({SRVH_DOCNO:"",SRVH_ISSDT:me.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),R=T([]),U=T([]),h=T([]),b=T(!1),N=(y,n,f,O)=>{n(async()=>{O==="cust"&&await M(y),O==="item"&&await e(y)})},M=async y=>{b.value=!0,await Y.post("customer/searchAPI",{searchValue:y}).then(n=>{b.value=!1,U.value=n.data.data}).catch(()=>{b.value=!1})},e=async y=>{b.value=!0,await Y.post("item/searchAPI",{searchValue:y}).then(n=>{b.value=!1,R.value=n.data.data}).catch(()=>{b.value=!1})},c=()=>{h.value.push({TSRVD_ITMCD:"",TSRVD_LINE:h.value.length+1,TSRVD_QTY:1,TSRVD_CUSTRMK:""})},o=y=>{C.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${y+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{h.value.splice(y,1)})},m=y=>{C.dialog({component:Ot,componentProps:{ItemCat:"SERVICE_ITEMM"}}).onOk(async n=>{await e(""),h.value[y].TSRVD_ITMCD=n.MITM_ITMNM})},t=()=>{C.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{b.value=!0,await Y.post("servicesAdmin",{header:g.value,detail:h.value}).then(y=>{b.value=!1,d()})})},u=()=>{C.dialog({component:zt}).onOk(async y=>{console.log(y),await M(""),h.value[idx].SRVH_CUSCD=y.MCUS_CUSCD})},z=y=>{C.dialog({component:sl}).onOk(async n=>{console.log(n)})};return(y,n)=>(F(),$(_e,{ref_key:"dialogRef",ref:D,onHide:Z(_),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:s(()=>[l(he,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:s(()=>[l(ne,null,{default:s(()=>[ul]),_:1}),l(ne,{class:"q-pa-sm"},{default:s(()=>[p("fieldset",rl,[dl,p("div",cl,[p("div",ml,[l(E,{label:"SPK No",readonly:"",dense:"",modelValue:g.value.SRVH_DOCNO,"onUpdate:modelValue":n[0]||(n[0]=f=>g.value.SRVH_DOCNO=f),filled:""},null,8,["modelValue"])]),p("div",_l,[l(E,{filled:"",modelValue:g.value.SRVH_ISSDT,"onUpdate:modelValue":n[2]||(n[2]=f=>g.value.SRVH_ISSDT=f),dense:"",label:"Issue Date",loading:b.value,onClick:n[3]||(n[3]=f=>y.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD",readonly:i.mode==="view"},{append:s(()=>[l(De,{name:"event",class:"cursor-pointer",disable:i.mode==="view"},{default:s(()=>[l(pt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[l(gt,{modelValue:g.value.SRVH_ISSDT,"onUpdate:modelValue":n[1]||(n[1]=f=>g.value.SRVH_ISSDT=f),mask:"YYYY-MM-DD"},{default:s(()=>[p("div",vl,[Ie(l(x,{label:"Close",color:"primary",flat:""},null,512),[[St]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["disable"])]),_:1},8,["modelValue","loading","readonly"])])]),p("div",fl,[p("div",pl,[l(se,{dense:"",filled:"",label:"Customer Choose",modelValue:g.value.SRVH_CUSCD,"onUpdate:modelValue":n[5]||(n[5]=f=>g.value.SRVH_CUSCD=f),"use-input":"","input-debounce":"500",options:U.value,onFilter:n[6]||(n[6]=(f,O,S)=>N(f,O,S,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:b.value,readonly:i.mode==="view"},{after:s(()=>[l(x,{round:"",dense:"",flat:"",icon:"person_add",onClick:n[4]||(n[4]=f=>u()),color:"cyan"},{default:s(()=>[l(Q,null,{default:s(()=>[A("Add new customer")]),_:1})]),_:1})]),_:1},8,["modelValue","options","loading","readonly"])])])]),p("fieldset",gl,[Sl,i.mode!=="view"?(F(),oe("div",hl,[p("div",Cl,[l(x,{flat:"",icon:"add",color:"blue",onClick:n[7]||(n[7]=f=>c())},{default:s(()=>[l(Q,null,{default:s(()=>[A("Add lines")]),_:1})]),_:1})])])):G("",!0),l(_t,{bordered:"",dense:""},{default:s(()=>[h.value.length>0?(F(!0),oe(fe,{key:0},pe(h.value,(f,O)=>(F(),$(Oe,{key:O,class:"q-my-sm",dense:""},{default:s(()=>[l(W,{avatar:""},{default:s(()=>[l(rt,{"text-color":"blue"},{default:s(()=>[A(ae(O+1),1)]),_:2},1024)]),_:2},1024),l(W,null,{default:s(()=>[l(qe,null,{default:s(()=>[l(se,{dense:"",filled:"",label:"Item Name",modelValue:f.TSRVD_ITMCD,"onUpdate:modelValue":S=>f.TSRVD_ITMCD=S,"use-input":"","input-debounce":"500",options:R.value,onFilter:n[8]||(n[8]=(S,I,H)=>N(S,I,H,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:b.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),l(W,null,{default:s(()=>[l(E,{label:"Qty",filled:"",dense:"",modelValue:f.TSRVD_QTY,"onUpdate:modelValue":S=>f.TSRVD_QTY=S},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(W,null,{default:s(()=>[l(E,{label:"Problem",filled:"",dense:"",modelValue:f.TSRVD_CUSTRMK,"onUpdate:modelValue":S=>f.TSRVD_CUSTRMK=S},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),i.mode!=="view"?(F(),$(W,{key:0,side:""},{default:s(()=>[l(x,{icon:"delete",color:"red",flat:"",onClick:S=>o(O),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A("Delete line")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):G("",!0),i.mode!=="view"?(F(),$(W,{key:1,side:""},{default:s(()=>[l(x,{icon:"library_add",color:"indigo",flat:"",onClick:S=>m(O),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A("Add new item")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):G("",!0),i.mode!=="view"?(F(),$(W,{key:2,side:""},{default:s(()=>[l(x,{icon:"photo",color:"orange",flat:"",onClick:S=>z(O),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A("Add photo")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):G("",!0)]),_:2},1024))),128)):Ie((F(),$(Oe,{key:1,class:"q-my-sm",clickable:""},{default:s(()=>[l(W,null,{default:s(()=>[l(qe,null,{default:s(()=>[A(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[dt]])]),_:1})])]),_:1}),l(Ce,{align:"right"},{default:s(()=>[l(x,{label:"OK",color:"primary",onClick:n[9]||(n[9]=f=>t()),disable:b.value,loading:b.value},null,8,["disable","loading"]),l(x,{flat:"",label:"Cancel",color:"red",onClick:Z(v),loading:b.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const bl={class:"q-pa-md"},Dl={class:"row q-pb-md"},Tl=p("div",{class:"col"},[p("span",{class:"text-h4"},"Receive Order ")],-1),Ml={class:"col text-right"},yl={class:"row q-pt-md"},wl={class:"col"},Vl={key:1},El={__name:"serviceView",setup(a){const D=re(),_=T("SRVH_DOCNO"),d=T(""),v=T([]),C=T([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Cust",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"STAT",label:"Status",field:o=>c(o),sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left",format:o=>me.formatDate(new Date(o),"DD MMM YYYY")}]),i=T(!1),g=T(null);Se(()=>{R(),g.value=setInterval(()=>{R()},1e4)});const R=async()=>{i.value=!0,await Y.post("servicesAdmins/search",{searchBy:_.value,searchValue:d.value}).then(o=>{i.value=!1,v.value=o.data.data}).catch(o=>{i.value=!1})},U=()=>{D.dialog({component:Pe}).onOk(async o=>{R()})},h=o=>{const m={SRVH_DOCNO:o.SRVH_DOCNO,SRVH_ISSDT:me.formatDate(o.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:o.MCUS_CUSCD};let t=[];o.detail.map(u=>{t.push({id:u.id,TSRVD_ITMCD:u.TSRVD_ITMCD,TSRVD_LINE:u.TSRVD_LINE,TSRVD_QTY:u.TSRVD_QTY,TSRVD_CUSTRMK:u.TSRVD_CUSTRMK,TSRVD_REMARK:u.TSRVD_REMARK,TSRVD_FLGSTS:u.TSRVD_FLGSTS,listFixDet:u.list_fix_det})}),D.dialog({component:Ct,componentProps:{header:m,detail:t,mode:o.detail.filter(u=>u.TSRVD_FLGSTS===1).length===o.detail.length?"approvecust":"view"}}).onOk(async u=>{R()})},b=o=>{window.open("http://tribin.test/servicesAdmins/printInvoice/"+btoa(o),"_blank").focus()},N=o=>{const m={SRVH_DOCNO:o.SRVH_DOCNO,SRVH_ISSDT:me.formatDate(o.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:o.MCUS_CUSCD};let t=[];o.detail.map(u=>{t.push({TSRVD_ITMCD:u.TSRVD_ITMCD,TSRVD_LINE:u.TSRVD_LINE,TSRVD_QTY:u.TSRVD_QTY,TSRVD_CUSTRMK:u.TSRVD_CUSTRMK})}),D.dialog({component:Pe,componentProps:{header:m,detail:t}}).onOk(async u=>{R()})},M=o=>{D.dialog({title:"Confirmation",message:"Do you want to proceed to service ?",cancel:!0,persistent:!0}).onOk(async()=>{i.value=!0,await Y.put(`servicesAdmin/${btoa(o.SRVH_DOCNO)}`,{TSRVD_FLGSTS:2}).then(m=>{i.value=!1}).catch(m=>{i.value=!1})})},e=o=>{D.dialog({title:"Confirmation",message:"Are you sure want to delete this order ?",cancel:!0,persistent:!0}).onOk(async()=>{i.value=!0,await Y.delete(`servicesAdmin/${btoa(o.SRVH_DOCNO)}`).then(m=>{i.value=!1}).catch(m=>{i.value=!1})})},c=o=>{const m=o.detail.filter(n=>n.TSRVD_FLGSTS==0),t=o.detail.filter(n=>n.TSRVD_FLGSTS==1),u=o.detail.filter(n=>n.TSRVD_FLGSTS==2),z=o.detail.filter(n=>n.TSRVD_FLGSTS==3),y=o.detail.filter(n=>n.TSRVD_FLGSTS==5);if(m.length==o.detail.length)return{color:"red",label:"No Price Added yet !",icon:"edit"};if(t.length>0&&t.length<o.detail.length)return{color:"warning",label:"Please Add item & price",icon:"payments"};if(y.length>0&&y.length==o.detail.length)return{color:"indigo",label:"Added Price Done, Waiting Manager Confirmation",icon:"price_check"};if(t.length>0&&t.length==o.detail.length)return{color:"green",label:"Manager has been approve, Waiting Cust. Confirmation",icon:"price_check"};if(u.length>0&&u.length>=o.detail.length)return{color:"cyan",label:"Cust. has been approved, continue to fix.",icon:"engineering"};if(z.length>0&&z.length===o.detail.length)return{color:"primary",label:"Fix has been done",icon:"fact_check"}};return(o,m)=>(F(),oe("div",bl,[p("div",Dl,[Tl,p("div",Ml,[l(x,{icon:"add",color:"blue",onClick:U},{default:s(()=>[l(Q,null,{default:s(()=>[A("Create New Order")]),_:1})]),_:1})])]),l(ct),p("div",yl,[p("div",wl,[l(vt,{title:"Created Order",rows:v.value,columns:C.value,"row-key":"name",loading:i.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":s(()=>[l(se,{outlined:"",modelValue:_.value,"onUpdate:modelValue":m[0]||(m[0]=t=>_.value=t),options:C.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),l(E,{borderless:"",dense:"",modelValue:d.value,"onUpdate:modelValue":[m[1]||(m[1]=t=>d.value=t),m[2]||(m[2]=t=>o.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:s(()=>[l(De,{name:"search"})]),_:1},8,["modelValue"])]),header:s(t=>[l(Ne,{props:t},{default:s(()=>[(F(!0),oe(fe,null,pe(t.cols,u=>(F(),$(xe,{key:u.name,props:t},{default:s(()=>[A(ae(u.label),1)]),_:2},1032,["props"]))),128)),l(xe,{"auto-width":""},{default:s(()=>[A("Action")]),_:1})]),_:2},1032,["props"])]),body:s(t=>[l(Ne,{props:t},{default:s(()=>[(F(!0),oe(fe,null,pe(t.cols,u=>(F(),$($e,{key:u.name,props:t},{default:s(()=>[u.name==="STAT"?(F(),$(ft,{key:0,clickable:"",color:u.value.color,"text-color":"white",icon:u.value.icon},{default:s(()=>[A(ae(u.value.label),1)]),_:2},1032,["color","icon"])):(F(),oe("span",Vl,ae(u.value),1))]),_:2},1032,["props"]))),128)),l($e,{"auto-width":""},{default:s(()=>[t.row.detail.filter(u=>u.TSRVD_FLGSTS>0).length===0?(F(),$(x,{key:0,flat:"",color:"orange",icon:"edit",onClick:u=>N(t.row),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A("Edit this Order")]),_:1})]),_:2},1032,["onClick"])):G("",!0),t.row.detail.filter(u=>u.TSRVD_FLGSTS>0).length===t.row.detail.length?(F(),$(x,{key:1,flat:"",color:"indigo",icon:"print",onClick:u=>b(t.row.SRVH_DOCNO),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A("Print this order")]),_:1})]),_:2},1032,["onClick"])):G("",!0),t.row.detail.filter(u=>u.TSRVD_FLGSTS>0).length===0?(F(),$(x,{key:2,flat:"",color:"red",icon:"delete",onClick:u=>e(t.row.SRVH_DOCNO),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A(ae(t.row.detail.filter(u=>u.TSRVD_FLGSTS>0).length>0?"Cannot delete processed order":"Delete this Order"),1)]),_:2},1024)]),_:2},1032,["onClick"])):G("",!0),t.row.detail.filter(u=>u.TSRVD_FLGSTS>0).length>0?(F(),$(x,{key:3,flat:"",color:"cyan",icon:"visibility",onClick:u=>h(t.row),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A("View this Order")]),_:1})]),_:2},1032,["onClick"])):G("",!0),t.row.detail.filter(u=>u.TSRVD_FLGSTS==1).length===t.row.detail.length?(F(),$(x,{key:4,flat:"",color:"indigo",icon:"check",onClick:u=>M(t.row),dense:""},{default:s(()=>[l(Q,null,{default:s(()=>[A(ae(t.row.detail.filter(u=>u.TSRVD_FLGSTS>0).length!==t.row.detail.length?"Please wait until all item checked":"Proceed all item to service"),1)]),_:2},1024)]),_:2},1032,["onClick"])):G("",!0)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{El as default};
