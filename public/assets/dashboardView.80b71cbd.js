import{s as u,o as R,B as n,C as T,D as t,E as o,J as y,K as m,b0 as U,L as S,Q as P,M as w,O as q,I as l,P as x,aa as $,a$ as d,S as H,R as _,aY as A,aZ as O,b4 as L,H as Q}from"./index.f1e62f76.js";import{u as B,b as E,a as k,o as V}from"./use-dialog-plugin-component.ecea18b9.js";import{d as K,Q as M,b as G}from"./date.aed89a91.js";import{api_web as N}from"./axios.7cc3228e.js";const J=l("div",{class:"text-h6"},"Review Item List",-1),z={__name:"viewListApprovalItem",props:{cd:String,typeCD:String},setup(D){const{dialogRef:h,onDialogHide:p,onDialogOK:b,onDialogCancel:f}=B();E();const r=D,g=u(!1),C=u([{name:"MITM_ITMNM",label:"Item Name",field:"MITM_ITMNM",sortable:!0},{name:"TQUODETA_USAGE_DESCRIPTION",label:"Usage",field:"TQUODETA_USAGE_DESCRIPTION",sortable:!0},{name:"TQUODETA_PRC",label:"Price",field:"TQUODETA_PRC",sortable:!0},{name:"TQUODETA_OPRPRC",label:"Operator",field:"TQUODETA_OPRPRC",sortable:!0},{name:"TQUODETA_MOBDEMOB",label:"MOB DEMOB",field:"TQUODETA_MOBDEMOB",sortable:!0},{name:"SUBTOT",label:"MOB DEMOB",sortable:!0,field:a=>a.TQUODETA_PRC+a.TQUODETA_OPRPRC+a.TQUODETA_MOBDEMOB}]),c=u([]);R(()=>{v()});const v=async()=>{await N.get(`${r.typeCD}/${btoa(r.cd)}`).then(a=>{g.value=!1,c.value=a.data}).catch(a=>{g.value=!1})};return(a,e)=>(n(),T(q,{ref_key:"dialogRef",ref:h,onHide:w(p),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:t(()=>[o(y,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:t(()=>[o(m,null,{default:t(()=>[J]),_:1}),o(m,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:t(()=>[r.typeCD=="quotation"?(n(),T(k,{key:0,title:"Item List",rows:c.value.dataItem,columns:C.value,"row-key":"name",dense:""},null,8,["rows","columns"])):U("",!0)]),_:1}),o(S,{align:"center"},{default:t(()=>[o(P,{label:"OK",color:"primary",onClick:e[0]||(e[0]=i=>w(b)()),disable:a.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},j=l("div",{class:"text-h6"},"Approval List",-1),F={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Y={class:"text-h5 text-bold"},Z={class:"text-h6 text-bold"},W={class:"text-subtitle2"},X={class:"row"},ee={class:"col"},te={class:"col text-right"},ae={__name:"viewListApproval",props:{listApprv:Array,typeAPI:String},setup(D){const h=E(),p=D,b=u([{name:"APP_CD",label:"Doc Code",field:"APP_CD"},{name:"APP_CUSNM",label:"Customer",field:"APP_CUSNM"},{name:"APP_SBJCT",label:"Subject",field:"APP_SBJCT"},{name:"APP_ATTN",label:"Attn",field:"APP_ATTN"},{name:"CREATED_AT",label:"Created Date",field:"CREATED_AT"}]),f=u(""),r=(e,i="days")=>{const s=new Date,I=new Date(e);return K.getDateDiff(s,I,i)},g=e=>{let i="";p.typeAPI=="quot"?i="quotation":p.typeAPI=="pr"?i="purchase-request-approval":p.typeAPI=="po"&&(i="purchase-order/approval-document"),h.dialog({component:z,componentProps:{cd:e,typeCD:i}}).onOk(async s=>{quotationGroupConditions.value=s.MCONDITION_RPT_STAT,quotationConditions.value=s.group})},{dialogRef:C,onDialogHide:c,onDialogOK:v,onDialogCancel:a}=B();return(e,i)=>(n(),T(q,{ref_key:"dialogRef",ref:C,onHide:w(c),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:t(()=>[o(y,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:t(()=>[o(m,null,{default:t(()=>[j]),_:1}),o(m,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:t(()=>[o(k,{grid:"",flat:"",bordered:"","card-container-class":e.cardContainerClass,title:"Outstanding Approval",rows:p.listApprv,columns:b.value,"row-key":"name",filter:f.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":e.rowsPerPageOptions},{"top-right":t(()=>[o(x,{borderless:"",dense:"",debounce:"300",modelValue:f.value,"onUpdate:modelValue":i[0]||(i[0]=s=>f.value=s),placeholder:"Search"},{append:t(()=>[o($,{name:"search"})]),_:1},8,["modelValue"])]),item:t(s=>[l("div",F,[o(y,{flat:"",bordered:""},{default:t(()=>[o(m,{class:"text-center bg-secondary text-white"},{default:t(()=>[l("div",Y,d(s.row.APP_CUSNM),1)]),_:2},1024),o(H),o(m,null,{default:t(()=>[l("div",Z,d(s.row.APP_CD),1),l("div",W,d(s.row.APP_SBJCT),1)]),_:2},1024),o(m,null,{default:t(()=>[l("div",X,[l("div",ee,[o(P,{label:"Preview",color:"primary",outline:"",onClick:I=>g(s.row.APP_CD)},null,8,["onClick"])]),l("div",te,d(r(s.row.CREATED_AT)<30?`${r(s.row.CREATED_AT)} Days Ago`:`${r(s.row.CREATED_AT,"months")} Month ago`),1)])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options"])]),_:1}),o(S,{align:"right"},{default:t(()=>[o(P,{label:"OK",color:"primary",onClick:i[1]||(i[1]=s=>w(v)()),disable:e.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},oe={class:"q-pa-md bg-grey-5 window-height"},le={class:"row"},se={class:"row"},ne={class:"col"},ie={class:"text-h3 text-cyan"},re={class:"text-subtitle2 text-cyan"},ce={class:"col text-right"},de={class:"row q-pa-sm"},ue={class:"col"},pe={key:1},Te={__name:"dashboardView",setup(D){const h=E(),p=u([{total:900,title:"Total Sales",icon:"shopping_cart",color:"cyan"},{total:900,title:"Total Purchase",icon:"shopping_bag",color:"cyan"},{total:900,title:"Total Profit",icon:"payments",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"}]),b=u([{name:"name",label:"Business",field:"name",sortable:!0,align:"left"},{name:"quot",label:"Quotation",field:"quot_count",sortable:!0,align:"center"},{name:"pr",label:"Purchase Request",field:"pr_count",sortable:!0,align:"center"},{name:"po",label:"Purchase Order",field:"po_count",sortable:!0,align:"center"}]),f=u([]),r=u(!1);u(null),R(async()=>{await g()});const g=async()=>{r.value=!0,await N.get("/approval/notificationsAPI/top-user").then(c=>{r.value=!1,f.value=c.data}).catch(c=>{r.value=!1})},C=(c,v)=>{h.dialog({component:ae,componentProps:{listApprv:c,typeAPI:v}}).onOk(async a=>{quotationGroupConditions.value=a.MCONDITION_RPT_STAT,quotationConditions.value=a.group})};return(c,v)=>(n(),_("div",oe,[l("div",le,[(n(!0),_(A,null,O(p.value,(a,e)=>(n(),_("div",{class:L("col-3 q-pa-sm"),key:e},[o(y,null,{default:t(()=>[o(m,null,{default:t(()=>[l("div",se,[l("div",ne,[l("div",ie,d(a.total),1),l("div",re,d(a.title),1)]),l("div",ce,[o($,{name:a.icon,size:"4.4em",color:a.color},null,8,["name","color"])])])]),_:2},1024)]),_:2},1024)]))),128))]),l("div",de,[l("div",ue,[o(k,{flat:"",bordered:"",title:"Approval List",rows:f.value,columns:b.value,"row-key":"name",loading:r.value},{"top-right":t(()=>[o(P,{flat:"",icon:"refresh",color:"cyan",onClick:g})]),header:t(a=>[o(M,{props:a},{default:t(()=>[(n(!0),_(A,null,O(a.cols,e=>(n(),T(V,{key:e.name,props:a},{default:t(()=>[Q(d(e.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:t(a=>[o(M,{props:a},{default:t(()=>[(n(!0),_(A,null,O(a.cols,e=>(n(),T(G,{key:e.name,props:a},{default:t(()=>[e.name==="quot"||e.name==="pr"||e.name==="po"||e.name==="spk"?(n(),_(A,{key:0},[e.value>0?(n(),T(P,{key:0,flat:"",color:"blue",onClick:i=>C(a.row[e.name.split("_")[0]],e.name)},{default:t(()=>[l("b",null,d(e.value),1)]),_:2},1032,["onClick"])):(n(),_("span",pe,d(e.value),1))],64)):(n(),_(A,{key:1},[Q(d(e.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Te as default};
