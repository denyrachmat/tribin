import{o as P,s as m,B as _,C as y,D as l,E as e,J as $,K as v,I as n,R as M,Q as f,aY as q,aW as H,H as u,ap as N,aU as L,aV as Y,aZ as B,aX as d,P as K,L as E,M as U,O as j,aa as ee,S as le}from"./index.8cadce10.js";import{u as J,b as F,Q as W,j as x,k as c,l as k,c as ae,a as te}from"./use-dialog-plugin-component.2e44e9b3.js";import{d as X}from"./date.6cc4695d.js";import{api_web as Z}from"./axios.6268719c.js";import{Q as A}from"./QTooltip.e498c631.js";import{Q as oe}from"./QBadge.a7b012c3.js";const se={class:"row"},ne=n("div",{class:"col"},[n("div",{class:"text-h6"},"Update Used Item")],-1),ie={key:0,class:"col text-right"},de={__name:"serviceOprItemAdd",props:{mode:String,dataItem:Array},setup(O){const{dialogRef:I,onDialogHide:D,onDialogOK:S,onDialogCancel:p}=J(),C=F(),i=O;P(()=>{console.log(i.dataItem),i.dataItem.listFixDet&&(o.value=i.dataItem.listFixDet)});const t=m([]),o=m([]),a=m(!1),s=()=>{o.value.push({TSRVD_ID:i.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},b=(h,g,V,T)=>{g(async()=>{T==="item"&&await r(h)})},r=async h=>{a.value=!0,await Z.post("item/searchAPITBL",{searchValue:h}).then(g=>{a.value=!1,t.value=g.data.data}).catch(()=>{a.value=!1})},w=()=>{C.dialog({title:"Confirmation",message:"Are you sure want to save this items ?",cancel:!0,persistent:!0}).onOk(async()=>{S(o.value)})},Q=h=>{C.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${h+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{o.value.splice(h,1)})};return(h,g)=>(_(),y(j,{ref_key:"dialogRef",ref:I,onHide:U(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(v,null,{default:l(()=>[n("div",se,[ne,i.mode!=="view"?(_(),M("div",ie,[e(f,{icon:"add",outline:"",color:"blue",onClick:s})])):q("",!0)])]),_:1}),e(v,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:l(()=>[e(W,{bordered:""},{default:l(()=>[o.value.length===0?H((_(),y(x,{key:0,class:"q-my-sm",clickable:""},{default:l(()=>[e(c,null,{default:l(()=>[u(" No items added ")]),_:1})]),_:1})),[[N]]):q("",!0),(_(!0),M(L,null,Y(o.value,(V,T)=>H((_(),y(x,{key:T,class:"q-my-sm",clickable:""},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(B,{color:"primary","text-color":"white"},{default:l(()=>[u(d(T+1),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(k,null,{default:l(()=>[e(ae,{dense:"",filled:"",label:"Item Name",modelValue:V.TSRVF_ITMCD,"onUpdate:modelValue":R=>V.TSRVF_ITMCD=R,"use-input":"","input-debounce":"500",options:t.value,onFilter:g[0]||(g[0]=(R,z,G)=>b(R,z,G,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:a.value,readonly:i.mode==="view"},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"])]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(K,{label:"Price",modelValue:V.TSRVF_PRC,"onUpdate:modelValue":R=>V.TSRVF_PRC=R,filled:"",dense:"",readonly:i.mode==="view"},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024),e(c,{side:""},{default:l(()=>[e(f,{icon:"delete",flat:"",color:"red",onClick:R=>Q(T)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)),[[N]])),128))]),_:1})]),_:1}),e(E,{align:"right"},{default:l(()=>[e(f,{label:"OK",color:"primary",onClick:g[1]||(g[1]=V=>w()),disable:a.value,loading:a.value},null,8,["disable","loading"]),e(f,{flat:"",label:"Cancel",color:"red",onClick:U(p),loading:a.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},re={class:"text-h6"},ue={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(O){const{dialogRef:I,onDialogHide:D,onDialogOK:S,onDialogCancel:p}=J(),C=F(),i=O,t=m({SRVH_DOCNO:"",SRVH_ISSDT:X.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),o=m([]);P(async()=>{i.header&&(t.value=i.header,o.value=i.detail)});const a=(s,b="add")=>{C.dialog({component:de,componentProps:{mode:b,dataItem:o.value[s]}}).onOk(async r=>{o.value[s].listFixDet=r})};return(s,b)=>(_(),y(j,{ref_key:"dialogRef",ref:I,onHide:U(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(v,null,{default:l(()=>[n("div",re,"Update Order "+d(t.value.SRVH_DOCNO),1)]),_:1}),e(v,{class:"q-pa-sm"},{default:l(()=>[e(W,{bordered:""},{default:l(()=>[(_(!0),M(L,null,Y(o.value,(r,w)=>H((_(),y(x,{key:w,class:"q-my-sm",clickable:""},{default:l(()=>[e(c,{avatar:""},{default:l(()=>[e(B,{color:"primary","text-color":"white"},{default:l(()=>[u(d(r.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),e(c,null,{default:l(()=>[e(k,null,{default:l(()=>[u(d(r.TSRVD_ITMCD),1)]),_:2},1024),e(k,{caption:"",lines:"1"},{default:l(()=>[u("Item")]),_:1})]),_:2},1024),e(c,null,{default:l(()=>[e(k,null,{default:l(()=>[u(d(r.TSRVD_CUSTRMK),1)]),_:2},1024),e(k,{caption:"",lines:"1"},{default:l(()=>[u("Customer Remarks")]),_:1})]),_:2},1024),e(c,{side:""},{default:l(()=>[e(f,{icon:"construction",color:"green",flat:"",onClick:Q=>a(w,"add")},{default:l(()=>[e(A,null,{default:l(()=>[u("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(c,{side:""},{default:l(()=>[e(f,{icon:"visibility",color:"cyan",flat:"",onClick:Q=>a(w,"view"),disable:!r.listFixDet},{default:l(()=>[e(A,null,{default:l(()=>[u("View Added Item")]),_:1}),e(oe,{color:"red",floating:""},{default:l(()=>[u(d(r.listFixDet.length),1)]),_:2},1024)]),_:2},1032,["onClick","disable"])]),_:2},1024)]),_:2},1024)),[[N]])),128))]),_:1})]),_:1}),e(E,{align:"right"},{default:l(()=>[e(f,{label:"OK",color:"primary",onClick:b[0]||(b[0]=r=>s.onSubmitData()),disable:s.loading,loading:s.loading},null,8,["disable","loading"]),e(f,{flat:"",label:"Cancel",color:"red",onClick:U(p),loading:s.loading},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},ce={class:"q-pa-md"},_e={class:"row"},me={class:"col"},fe={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},pe={class:"text-h5 text-bold"},ge={class:"text-h6 text-bold"},ve={class:"text-subtitle2"},Se={class:"text-h6 text-bold"},Ce=n("div",{class:"text-subtitle2"},"Resolved Items",-1),he={class:"row"},De={class:"col"},be=n("div",{class:"col text-right"},null,-1),ye={__name:"serviceOprView",setup(O){const I=F();m([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:t=>t.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:t=>t.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const D=m([]),S=m(""),p=m(!1);P(()=>{C()});const C=async()=>{p.value=!0,await Z.post("servicesOPR/search",{searchBy:"",searchValue:S.value}).then(t=>{p.value=!1,D.value=t.data.data}).catch(t=>{p.value=!1})},i=t=>{const o={SRVH_DOCNO:t.SRVH_DOCNO,SRVH_ISSDT:X.formatDate(t.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:t.MCUS_CUSCD};let a=[];t.detail.map(s=>{a.push({TSRVD_ITMCD:s.TSRVD_ITMCD,TSRVD_LINE:s.TSRVD_LINE,TSRVD_QTY:s.TSRVD_QTY,TSRVD_CUSTRMK:s.TSRVD_CUSTRMK})}),I.dialog({component:ue,componentProps:{header:o,detail:a}}).onOk(async s=>{C()})};return(t,o)=>(_(),M("div",ce,[n("div",_e,[n("div",me,[e(te,{grid:"",flat:"",bordered:"","card-container-class":t.cardContainerClass,title:"Outstanding Order",rows:D.value,columns:t.columns,"row-key":"name",filter:S.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":t.rowsPerPageOptions,loading:p.value},{"top-right":l(()=>[e(K,{borderless:"",dense:"",debounce:"300",modelValue:S.value,"onUpdate:modelValue":o[0]||(o[0]=a=>S.value=a),placeholder:"Search"},{append:l(()=>[e(ee,{name:"search"})]),_:1},8,["modelValue"])]),item:l(a=>[n("div",fe,[e($,{flat:"",bordered:""},{default:l(()=>[e(v,{class:"text-center bg-secondary text-white"},{default:l(()=>[n("div",pe,d(a.row.SRVH_DOCNO),1)]),_:2},1024),e(le),e(v,null,{default:l(()=>[n("div",ge,d(a.row.MCUS_CUSNM),1),n("div",ve,d(a.row.SRVH_ISSDT),1)]),_:2},1024),e(v,null,{default:l(()=>[n("div",Se,d(a.row.resolve.length)+" of "+d(a.row.unresolve.length),1),Ce]),_:2},1024),e(v,null,{default:l(()=>[n("div",he,[n("div",De,[e(f,{label:"Resolve",color:"primary",outline:"",onClick:s=>i(a.row)},null,8,["onClick"])]),be])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{ye as default};
