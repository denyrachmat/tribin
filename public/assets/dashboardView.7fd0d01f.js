import{s as u,o as M,B as n,C as T,D as a,E as o,J as D,K as f,b0 as N,L as R,Q as P,M as w,O as q,I as l,P as x,aa as U,a$ as d,S as L,R as m,aY as A,aZ as O,b4 as H,H as k}from"./index.eae07c22.js";import{u as $,b as E,a as S,o as V}from"./use-dialog-plugin-component.eeaf573f.js";import{d as K,Q,b as G}from"./date.e6397719.js";import{api_web as B}from"./axios.7e5ef8c5.js";const J=l("div",{class:"text-h6"},"Review Item List",-1),z={__name:"viewListApprovalItem",props:{cd:String,typeCD:String},setup(y){const{dialogRef:h,onDialogHide:p,onDialogOK:b,onDialogCancel:g}=$();E();const r=y,_=u(!1),C=u([{name:"MITM_ITMNM",label:"Item Name",field:"MITM_ITMNM",sortable:!0,align:"left"},{name:"TQUODETA_USAGE_DESCRIPTION",label:"Usage",field:"TQUODETA_USAGE_DESCRIPTION",sortable:!0,align:"left"},{name:"TQUODETA_PRC",label:"Price",field:"TQUODETA_PRC",sortable:!0,align:"left",format:e=>e.toLocaleString()},{name:"TQUODETA_OPRPRC",label:"Operator",field:"TQUODETA_OPRPRC",sortable:!0,align:"left",format:e=>e.toLocaleString()},{name:"TQUODETA_MOBDEMOB",label:"MOB DEMOB",field:"TQUODETA_MOBDEMOB",sortable:!0,align:"left",format:e=>e.toLocaleString("en-US",{style:"currency",currency:"IDR"})},{name:"SUBTOT",label:"MOB DEMOB",sortable:!0,field:e=>e.TQUODETA_PRC+e.TQUODETA_OPRPRC+e.TQUODETA_MOBDEMOB,align:"left",format:e=>e.toLocaleString("en-US",{style:"currency",currency:"USD"})}]),c=u([]);M(()=>{v()});const v=async()=>{await B.get(`${r.typeCD}/${btoa(r.cd)}`).then(e=>{_.value=!1,c.value=e.data}).catch(e=>{_.value=!1})};return(e,t)=>(n(),T(q,{ref_key:"dialogRef",ref:h,onHide:w(p),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[o(D,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[o(f,null,{default:a(()=>[J]),_:1}),o(f,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[r.typeCD=="quotation"?(n(),T(S,{key:0,title:"Item List",rows:c.value.dataItem,columns:C.value,"row-key":"name",dense:"",loading:_.value},null,8,["rows","columns","loading"])):N("",!0)]),_:1}),o(R,{align:"center"},{default:a(()=>[o(P,{label:"OK",color:"primary",onClick:t[0]||(t[0]=i=>w(b)()),disable:e.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},j=l("div",{class:"text-h6"},"Approval List",-1),F={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Y={class:"text-h5 text-bold"},Z={class:"text-h6 text-bold"},W={class:"text-subtitle2"},X={class:"row"},ee={class:"col"},te={class:"col text-right"},ae={__name:"viewListApproval",props:{listApprv:Array,typeAPI:String},setup(y){const h=E(),p=y,b=u([{name:"APP_CD",label:"Doc Code",field:"APP_CD"},{name:"APP_CUSNM",label:"Customer",field:"APP_CUSNM"},{name:"APP_SBJCT",label:"Subject",field:"APP_SBJCT"},{name:"APP_ATTN",label:"Attn",field:"APP_ATTN"},{name:"CREATED_AT",label:"Created Date",field:"CREATED_AT"}]),g=u(""),r=(t,i="days")=>{const s=new Date,I=new Date(t);return K.getDateDiff(s,I,i)},_=t=>{let i="";p.typeAPI=="quot"?i="quotation":p.typeAPI=="pr"?i="purchase-request-approval":p.typeAPI=="po"&&(i="purchase-order/approval-document"),h.dialog({component:z,componentProps:{cd:t,typeCD:i}}).onOk(async s=>{quotationGroupConditions.value=s.MCONDITION_RPT_STAT,quotationConditions.value=s.group})},{dialogRef:C,onDialogHide:c,onDialogOK:v,onDialogCancel:e}=$();return(t,i)=>(n(),T(q,{ref_key:"dialogRef",ref:C,onHide:w(c),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[o(D,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[o(f,null,{default:a(()=>[j]),_:1}),o(f,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[o(S,{grid:"",flat:"",bordered:"","card-container-class":t.cardContainerClass,title:"Outstanding Approval",rows:p.listApprv,columns:b.value,"row-key":"name",filter:g.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":t.rowsPerPageOptions},{"top-right":a(()=>[o(x,{borderless:"",dense:"",debounce:"300",modelValue:g.value,"onUpdate:modelValue":i[0]||(i[0]=s=>g.value=s),placeholder:"Search"},{append:a(()=>[o(U,{name:"search"})]),_:1},8,["modelValue"])]),item:a(s=>[l("div",F,[o(D,{flat:"",bordered:""},{default:a(()=>[o(f,{class:"text-center bg-secondary text-white"},{default:a(()=>[l("div",Y,d(s.row.APP_CUSNM),1)]),_:2},1024),o(L),o(f,null,{default:a(()=>[l("div",Z,d(s.row.APP_CD),1),l("div",W,d(s.row.APP_SBJCT),1)]),_:2},1024),o(f,null,{default:a(()=>[l("div",X,[l("div",ee,[o(P,{label:"Preview",color:"primary",outline:"",onClick:I=>_(s.row.APP_CD)},null,8,["onClick"])]),l("div",te,d(r(s.row.CREATED_AT)<30?`${r(s.row.CREATED_AT)} Days Ago`:`${r(s.row.CREATED_AT,"months")} Month ago`),1)])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options"])]),_:1}),o(R,{align:"right"},{default:a(()=>[o(P,{label:"OK",color:"primary",onClick:i[1]||(i[1]=s=>w(v)()),disable:t.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},oe={class:"q-pa-md bg-grey-5 window-height"},le={class:"row"},se={class:"row"},ne={class:"col"},ie={class:"text-h3 text-cyan"},re={class:"text-subtitle2 text-cyan"},ce={class:"col text-right"},de={class:"row q-pa-sm"},ue={class:"col"},pe={key:1},Te={__name:"dashboardView",setup(y){const h=E(),p=u([{total:900,title:"Total Sales",icon:"shopping_cart",color:"cyan"},{total:900,title:"Total Purchase",icon:"shopping_bag",color:"cyan"},{total:900,title:"Total Profit",icon:"payments",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"}]),b=u([{name:"name",label:"Business",field:"name",sortable:!0,align:"left"},{name:"quot",label:"Quotation",field:"quot_count",sortable:!0,align:"center"},{name:"pr",label:"Purchase Request",field:"pr_count",sortable:!0,align:"center"},{name:"po",label:"Purchase Order",field:"po_count",sortable:!0,align:"center"}]),g=u([]),r=u(!1);u(null),M(async()=>{await _()});const _=async()=>{r.value=!0,await B.get("/approval/notificationsAPI/top-user").then(c=>{r.value=!1,g.value=c.data}).catch(c=>{r.value=!1})},C=(c,v)=>{h.dialog({component:ae,componentProps:{listApprv:c,typeAPI:v}}).onOk(async e=>{quotationGroupConditions.value=e.MCONDITION_RPT_STAT,quotationConditions.value=e.group})};return(c,v)=>(n(),m("div",oe,[l("div",le,[(n(!0),m(A,null,O(p.value,(e,t)=>(n(),m("div",{class:H("col-3 q-pa-sm"),key:t},[o(D,null,{default:a(()=>[o(f,null,{default:a(()=>[l("div",se,[l("div",ne,[l("div",ie,d(e.total),1),l("div",re,d(e.title),1)]),l("div",ce,[o(U,{name:e.icon,size:"4.4em",color:e.color},null,8,["name","color"])])])]),_:2},1024)]),_:2},1024)]))),128))]),l("div",de,[l("div",ue,[o(S,{flat:"",bordered:"",title:"Approval List",rows:g.value,columns:b.value,"row-key":"name",loading:r.value},{"top-right":a(()=>[o(P,{flat:"",icon:"refresh",color:"cyan",onClick:_})]),header:a(e=>[o(Q,{props:e},{default:a(()=>[(n(!0),m(A,null,O(e.cols,t=>(n(),T(V,{key:t.name,props:e},{default:a(()=>[k(d(t.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(e=>[o(Q,{props:e},{default:a(()=>[(n(!0),m(A,null,O(e.cols,t=>(n(),T(G,{key:t.name,props:e},{default:a(()=>[t.name==="quot"||t.name==="pr"||t.name==="po"||t.name==="spk"?(n(),m(A,{key:0},[t.value>0?(n(),T(P,{key:0,flat:"",color:"blue",onClick:i=>C(e.row[t.name.split("_")[0]],t.name)},{default:a(()=>[l("b",null,d(t.value),1)]),_:2},1032,["onClick"])):(n(),m("span",pe,d(t.value),1))],64)):(n(),m(A,{key:1},[k(d(t.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Te as default};
