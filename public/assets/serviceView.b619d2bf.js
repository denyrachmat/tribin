import{Q as h}from"./QTooltip.c0132ffa.js";import{s as r,o as j,B as C,C as w,D as l,E as e,J,K as Q,I as t,P as g,L as W,Q as v,M as R,O as X,aa as Z,aW as x,H as f,R as $,aU as q,aV as H,aZ as le,aX as P,ap as ae,S as te}from"./index.1848d22e.js";import{u as z,b as E,c as N,Q as oe,j as B,k as U,l as L,a as se,m as K}from"./use-dialog-plugin-component.5d2324e1.js";import{Q as Y,a as F}from"./date.cd199f52.js";import{api_web as O}from"./axios.0c373941.js";import{Q as ne,a as de,C as ie}from"./ClosePopup.17e9d920.js";const ue=t("div",{class:"text-h6"},"Create Item Master",-1),re={class:"row"},ce={class:"col"},me={class:"col q-pl-md"},_e={class:"row q-pt-md"},pe={class:"col"},ve={class:"col q-pl-md"},fe={class:"row q-pt-md"},Me={class:"col"},Ce={class:"col q-pl-md"},Ie={class:"row q-pt-md"},ge={class:"col"},Ve={__name:"itemCreate",props:{ItemCat:String},setup(A){const{dialogRef:k,onDialogHide:V,onDialogOK:b,onDialogCancel:S}=z(),D=E(),o=r({MITM_ITMCD:"",MITM_ITMNM:"",MITM_STKUOM:"",MITM_ITMTYPE:1,MITM_BRAND:"",MITM_MODEL:"",MITM_SPEC:"",MITM_ITMCAT:"",MITM_COACD:"",MITM_ITMCAT:""}),m=r(!1),_=r([]),u=r([]),c=A;j(()=>{p(),o.value.MITM_ITMCAT=c.ItemCat});const M=(I,n,a,s)=>{n(async()=>{await O.post("item/getListCoasAPI",{search:I}).then(i=>{u.value=i.data})})},d=()=>{D.dialog({title:"Confirmation",message:"Do you want to save this item ?",cancel:!0,persistent:!0}).onOk(async()=>{await O.post("item",o.value).then(I=>{b(I.data.data.value)})})},p=async()=>{m.value=!0,await O.get("item/formAPI").then(I=>{m.value=!1,_.value=I.data.uoms,u.value=I.data.coas}).catch(()=>{m.value=!1})};return(I,n)=>(C(),w(X,{ref_key:"dialogRef",ref:k,onHide:R(V),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(J,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(Q,null,{default:l(()=>[ue]),_:1}),e(Q,{class:"q-pa-sm"},{default:l(()=>[t("div",re,[t("div",ce,[e(g,{label:"Item Code",dense:"",modelValue:o.value.MITM_ITMCD,"onUpdate:modelValue":n[0]||(n[0]=a=>o.value.MITM_ITMCD=a),filled:""},null,8,["modelValue"])]),t("div",me,[e(g,{label:"Item Name",dense:"",modelValue:o.value.MITM_ITMNM,"onUpdate:modelValue":n[1]||(n[1]=a=>o.value.MITM_ITMNM=a),filled:""},null,8,["modelValue"])])]),t("div",_e,[t("div",pe,[e(N,{dense:"",filled:"",label:"UOM",modelValue:o.value.MITM_STKUOM,"onUpdate:modelValue":n[2]||(n[2]=a=>o.value.MITM_STKUOM=a),options:_.value,behavior:"dialog","option-label":"MUOM_UOMNM","option-value":"MUOM_UOMCD","emit-value":"","map-options":"",loading:m.value},null,8,["modelValue","options","loading"])]),t("div",ve,[e(g,{label:"Item Brand",dense:"",modelValue:o.value.MITM_BRAND,"onUpdate:modelValue":n[3]||(n[3]=a=>o.value.MITM_BRAND=a),filled:""},null,8,["modelValue"])])]),t("div",fe,[t("div",Me,[e(g,{label:"Item Model",dense:"",modelValue:o.value.MITM_MODEL,"onUpdate:modelValue":n[4]||(n[4]=a=>o.value.MITM_MODEL=a),filled:""},null,8,["modelValue"])]),t("div",Ce,[e(g,{label:"Item Specification",dense:"",modelValue:o.value.MITM_SPEC,"onUpdate:modelValue":n[5]||(n[5]=a=>o.value.MITM_SPEC=a),filled:""},null,8,["modelValue"])])]),t("div",Ie,[t("div",ge,[e(N,{dense:"",filled:"",label:"COA",modelValue:o.value.MITM_COACD,"onUpdate:modelValue":n[6]||(n[6]=a=>o.value.MITM_COACD=a),options:u.value,"use-input":"",behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD",onFilter:n[7]||(n[7]=(a,s,i)=>M(a,s,i)),"emit-value":"","map-options":"",loading:m.value},null,8,["modelValue","options","loading"])])])]),_:1}),e(W,{align:"right"},{default:l(()=>[e(v,{label:"OK",color:"primary",onClick:n[8]||(n[8]=a=>d())}),e(v,{flat:"",label:"Cancel",color:"red",onClick:R(S)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},De=t("div",{class:"text-h6"},"Create Order",-1),Te={style:{border:"1px black solid","border-radius":"10px"}},be=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Header")],-1),Se={class:"row"},he={class:"col"},we={class:"col q-pl-md"},Oe={class:"row items-center justify-end"},ke={class:"row"},ye={class:"col"},Ue={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},$e=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Detail Items")],-1),Qe={class:"row q-pb-sm"},Re={class:"col text-right"},Ne={__name:"serviceCreateOrder",setup(A){const{dialogRef:k,onDialogHide:V,onDialogOK:b,onDialogCancel:S}=z(),D=E(),o=r({SRVH_DOCNO:"",SRVH_ISSDT:"",SRVH_CUSCD:""}),m=r([]),_=r([]),u=r(!1),c=(a,s,i,T)=>{s(async()=>{T==="cust"&&await M(a),T==="item"&&await d(a)})},M=async a=>{u.value=!0,await O.post("customer/searchAPI",{searchValue:a}).then(s=>{u.value=!1,listCustomers.value=s.data.data}).catch(()=>{u.value=!1})},d=async a=>{u.value=!0,await O.post("item/searchAPI",{searchValue:a}).then(s=>{u.value=!1,m.value=s.data.data}).catch(()=>{u.value=!1})},p=()=>{_.value.push({TSRVD_ITMCD:"",TSRVD_LINE:_.value.length+1})},I=a=>{D.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${a+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{_.value.splice(a,1)})},n=a=>{D.dialog({component:Ve,componentProps:{ItemCat:"SERVICE_ITEMM"}}).onOk(async s=>{await d(""),_.value[a].TSRVD_ITMCD=s.MITM_ITMNM})};return(a,s)=>(C(),w(X,{ref_key:"dialogRef",ref:k,onHide:R(V),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(J,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(Q,null,{default:l(()=>[De]),_:1}),e(Q,{class:"q-pa-sm"},{default:l(()=>[t("fieldset",Te,[be,t("div",Se,[t("div",he,[e(g,{label:"SPK No",readonly:"",dense:"",modelValue:o.value.SRVH_DOCNO,"onUpdate:modelValue":s[0]||(s[0]=i=>o.value.SRVH_DOCNO=i),filled:""},null,8,["modelValue"])]),t("div",we,[e(g,{filled:"",modelValue:o.value.SRVH_ISSDT,"onUpdate:modelValue":s[2]||(s[2]=i=>o.value.SRVH_ISSDT=i),dense:"",label:"Issue Date",loading:u.value,onClick:s[3]||(s[3]=i=>a.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(Z,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(ne,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(de,{modelValue:o.value.SRVH_ISSDT,"onUpdate:modelValue":s[1]||(s[1]=i=>o.value.SRVH_ISSDT=i),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Oe,[x(e(v,{label:"Close",color:"primary",flat:""},null,512),[[ie]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),t("div",ke,[t("div",ye,[e(g,{label:"Customer Choose",dense:"",modelValue:o.value.SRVH_CUSCD,"onUpdate:modelValue":s[4]||(s[4]=i=>o.value.SRVH_CUSCD=i),filled:""},null,8,["modelValue"])])])]),t("fieldset",Ue,[$e,t("div",Qe,[t("div",Re,[e(v,{flat:"",icon:"add",color:"blue",onClick:s[5]||(s[5]=i=>p())},{default:l(()=>[e(h,null,{default:l(()=>[f("Add lines")]),_:1})]),_:1})])]),e(oe,{bordered:"",dense:""},{default:l(()=>[_.value.length>0?(C(!0),$(q,{key:0},H(_.value,(i,T)=>(C(),w(B,{key:T,class:"q-my-sm",dense:""},{default:l(()=>[e(U,{avatar:""},{default:l(()=>[e(le,{"text-color":"blue"},{default:l(()=>[f(P(T+1),1)]),_:2},1024)]),_:2},1024),e(U,null,{default:l(()=>[e(L,null,{default:l(()=>[e(N,{dense:"",filled:"",label:"Item Name",modelValue:i.TSRVD_ITMCD,"onUpdate:modelValue":y=>i.TSRVD_ITMCD=y,"use-input":"","input-debounce":"500",options:m.value,onFilter:s[6]||(s[6]=(y,G,ee)=>c(y,G,ee,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:u.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),e(U,{side:""},{default:l(()=>[e(v,{icon:"delete",color:"red",flat:"",onClick:y=>I(T)},{default:l(()=>[e(h,null,{default:l(()=>[f("Delete line")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(U,{side:""},{default:l(()=>[e(v,{icon:"library_add",color:"indigo",flat:"",onClick:y=>n(T)},{default:l(()=>[e(h,null,{default:l(()=>[f("Add new item")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)):x((C(),w(B,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(U,null,{default:l(()=>[e(L,null,{default:l(()=>[f(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[ae]])]),_:1})])]),_:1}),e(W,{align:"right"},{default:l(()=>[e(v,{label:"OK",color:"primary",onClick:s[7]||(s[7]=i=>a.onSubmitData()),disable:a.stateSubmit},null,8,["disable"]),e(v,{flat:"",label:"Cancel",color:"red",onClick:R(S)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const Ae={class:"q-pa-md"},qe={class:"row q-pb-md"},He=t("div",{class:"col"},[t("span",{class:"text-h4"},"Receive Order ")],-1),Pe={class:"col text-right"},Ee={class:"row q-pt-md"},xe={class:"col"},Je={__name:"serviceView",setup(A){const k=E(),V=r("SRVH_DOCNO"),b=r(""),S=r([]),D=r([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"SRVH_CUSCD",label:"Cust",field:"SRVH_CUSCD",sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left"}]),o=r(!1);j(()=>{m()});const m=async()=>{o.value=!0,await O.post("service/search",{searchBy:V.value,searchValue:b.value}).then(c=>{o.value=!1,S.value=c.data.data}).catch(c=>{o.value=!1})},_=()=>{k.dialog({component:Ne}).onOk(async c=>{m()})},u=c=>{window.open("https://joss.jatpowerindo.co.id/PDF/quotation/"+btoa(c),"_blank").focus()};return(c,M)=>(C(),$("div",Ae,[t("div",qe,[He,t("div",Pe,[e(v,{icon:"add",color:"blue",onClick:_},{default:l(()=>[e(h,null,{default:l(()=>[f("Create New Order")]),_:1})]),_:1})])]),e(te),t("div",Ee,[t("div",xe,[e(se,{title:"Created Order",rows:S.value,columns:D.value,"row-key":"name",loading:o.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(N,{outlined:"",modelValue:V.value,"onUpdate:modelValue":M[0]||(M[0]=d=>V.value=d),options:D.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(g,{borderless:"",dense:"",modelValue:b.value,"onUpdate:modelValue":[M[1]||(M[1]=d=>b.value=d),M[2]||(M[2]=d=>c.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(Z,{name:"search"})]),_:1},8,["modelValue"])]),header:l(d=>[e(Y,{props:d},{default:l(()=>[(C(!0),$(q,null,H(d.cols,p=>(C(),w(K,{key:p.name,props:d},{default:l(()=>[f(P(p.label),1)]),_:2},1032,["props"]))),128)),e(K,{"auto-width":""},{default:l(()=>[f("Action")]),_:1})]),_:2},1032,["props"])]),body:l(d=>[e(Y,{props:d},{default:l(()=>[(C(!0),$(q,null,H(d.cols,p=>(C(),w(F,{key:p.name,props:d},{default:l(()=>[f(P(p.value),1)]),_:2},1032,["props"]))),128)),e(F,{"auto-width":""},{default:l(()=>[e(v,{flat:"",color:"orange",icon:"edit",onClick:p=>c.onClickEdit(d.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(h,null,{default:l(()=>[f("Edit this quotation")]),_:1})]),_:2},1032,["onClick"]),e(v,{flat:"",color:"indigo",icon:"print",onClick:p=>u(d.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(h,null,{default:l(()=>[f("Print this order")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Je as default};
