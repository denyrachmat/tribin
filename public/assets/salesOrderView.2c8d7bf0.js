import{Q as y}from"./QTooltip.ed62567d.js";import{t as c,B as te,C as S,D as h,E as l,F as e,M as ne,O as $,J as t,$ as O,an as Q,U as L,Q as m,P as g,R,S as M,T as Y,V as se,I as r,b7 as de,b8 as ie,W as ue,X as re,Y as N,Z as _e,o as me,aY as ce}from"./index.5e6bb320.js";import{a as G,u as Te,l as j,Q as fe,b as q,c as v,d as _,w as De,k as Oe,m as F}from"./QTable.ca9841c4.js";import{Q as x,a as B}from"./QTd.dae30465.js";import{api_web as H,api as pe}from"./axios.bb40815b.js";import{Q as P,a as k,C as w}from"./ClosePopup.a3348b97.js";import"./use-render-cache.3aae9b27.js";import"./date.17854a66.js";const ve=t("div",{class:"text-h6"},"RO Maintenance",-1),Se={style:{border:"1px black solid","border-radius":"10px"}},Ce=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Header")],-1),Ve={class:"row"},Le={class:"col"},ge={class:"col q-pl-md"},Ue={class:"row items-center justify-end"},be={class:"col q-pl-md"},Qe={class:"row items-center justify-end"},he={class:"row"},Ae={class:"col"},Ee={class:"col q-pl-md"},ye={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Pe=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Detail Items")],-1),ke={class:"row q-pb-md"},we={class:"col"},Re={class:"text-h6"},Ie={class:"col text-right"},Me={class:"row"},Ye={class:"col"},$e={class:"row items-center justify-end"},Ne={class:"row items-center justify-end"},qe={__name:"salesOrderCreate",setup(K){const A=G(),d=c({TSLO_SLOCD:"",TSLO_ISSUDT:"",TSLO_PLAN_DLVDT:"",TSLO_QUOCD:"",TSLO_POCD:""});c(""),c("");const V=c([]),i=c(!1),U=c(1),T=c([]),E={masked:!1,prefix:"",suffix:"",thousands:",",decimal:".",precision:2,disableNegative:!1,disabled:!1,min:null,max:null,allowBlank:!1,minimumNumberOfCharacters:0,shouldRound:!0,focusOnRight:!1},I=(u,o,p,a)=>{o(async()=>{a==="quotation"&&await f(u)})},f=async(u="")=>{i.value=!0,await H.post("quotation/search",{searchBy:"MCUS_CUSNM",searchValue:u}).then(o=>{i.value=!1,V.value=o.data.data}).catch(o=>{i.value=!1})},C=()=>U.value===1?"Rental":U.value===2?"Sales":"Service",n=async u=>{console.log(u),i.value=!0,await pe.get(`transaction/quotation/view/${btoa(u)}`).then(o=>{i.value=!1,o.data.data.det.map(p=>{T.value.push({TSLODETA_ITMCD:p.TQUODETA_ITMCD,TSLODETA_ITMQT:p.TQUODETA_ITMQT,TSLODETA_USAGE:p.TQUODETA_USAGE,TSLODETA_PRC:p.TQUODETA_PRC,TSLODETA_PERIOD_FR:p.TQUODETA_PERIOD_FR,TSLODETA_PERIOD_TO:p.TQUODETA_PERIOD_TO})})}).catch(o=>{i.value=!1})},D=()=>{T.value.push({TSLODETA_ITMCD:"",TSLODETA_ITMQT:"",TSLODETA_USAGE:"",TSLODETA_PRC:0,TSLODETA_PERIOD_FR:"",TSLODETA_PERIOD_TO:""})},J=u=>{A.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${u+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{T.value.splice(u,1)})},W=()=>{A.dialog({title:"Confirmation",message:"Are you sure want to save this RO ?",cancel:!0,persistent:!0}).onOk(async()=>{z()})},{dialogRef:X,onDialogHide:Z,onDialogOK:z,onDialogCancel:ee}=Te();return(u,o)=>{const p=te("money3");return S(),h(_e,{ref_key:"dialogRef",ref:X,onHide:N(Z),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(ne,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e($,null,{default:l(()=>[ve]),_:1}),e($,{class:"q-pa-sm"},{default:l(()=>[t("fieldset",Se,[Ce,t("div",Ve,[t("div",Le,[e(O,{label:"RO Code",dense:"",filled:"",modelValue:d.value.TSLO_SLOCD,"onUpdate:modelValue":o[0]||(o[0]=a=>d.value.TSLO_SLOCD=a),disable:"",loading:i.value},null,8,["modelValue","loading"])]),t("div",ge,[e(O,{filled:"",modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":o[2]||(o[2]=a=>d.value.TSLO_ISSUDT=a),dense:"",label:"Issue Date",loading:i.value,onClick:o[3]||(o[3]=a=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(k,{modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":o[1]||(o[1]=a=>d.value.TSLO_ISSUDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Ue,[L(e(m,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])]),t("div",be,[e(O,{filled:"",modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":o[5]||(o[5]=a=>d.value.TSLO_PLAN_DLVDT=a),dense:"",label:"Delivery Date",loading:i.value,onClick:o[6]||(o[6]=a=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(k,{modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":o[4]||(o[4]=a=>d.value.TSLO_PLAN_DLVDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Qe,[L(e(m,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),t("div",he,[t("div",Ae,[e(j,{dense:"",filled:"",label:"Sales Quotation Code",modelValue:d.value.TSLO_QUOCD,"onUpdate:modelValue":[o[7]||(o[7]=a=>d.value.TSLO_QUOCD=a),n],"use-input":"","input-debounce":"500",options:V.value,onFilter:o[8]||(o[8]=(a,b,s)=>I(a,b,s,"quotation")),behavior:"dialog","option-label":"DESCSEL","option-value":"TQUO_QUOCD","emit-value":"","map-options":"",loading:i.value},null,8,["modelValue","options","loading"])]),t("div",Ee,[e(O,{label:"PO Number",dense:"",filled:"",modelValue:d.value.TSLO_POCD,"onUpdate:modelValue":o[9]||(o[9]=a=>d.value.TSLO_POCD=a),loading:i.value},null,8,["modelValue","loading"])])])]),t("fieldset",ye,[Pe,t("div",ke,[t("div",we,[t("span",Re,g(C()),1)]),t("div",Ie,[e(m,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:D,loading:i.value},null,8,["loading"])])]),t("div",Me,[t("div",Ye,[e(fe,{bordered:"",dense:""},{default:l(()=>[T.value.length>0?(S(!0),R(M,{key:0},Y(T.value,(a,b)=>(S(),h(q,{key:b,class:"q-my-sm",dense:""},{default:l(()=>[e(v,{avatar:""},{default:l(()=>[e(se,{"text-color":"blue"},{default:l(()=>[r(g(b+1),1)]),_:2},1024)]),_:2},1024),e(v,null,{default:l(()=>[e(_,{class:"text-center"},{default:l(()=>[e(O,{modelValue:a.TSLODETA_ITMCD,"onUpdate:modelValue":s=>a.TSLODETA_ITMCD=s,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[r(" Item Name ")]),_:1})]),_:2},1024),e(v,null,{default:l(()=>[e(_,null,{default:l(()=>[e(O,{modelValue:a.TSLODETA_ITMQT,"onUpdate:modelValue":s=>a.TSLODETA_ITMQT=s,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[r(" Qty ")]),_:1})]),_:2},1024),e(v,null,{default:l(()=>[e(_,null,{default:l(()=>[e(O,{modelValue:a.TSLODETA_USAGE,"onUpdate:modelValue":s=>a.TSLODETA_USAGE=s,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[r(" Usage ")]),_:1})]),_:2},1024),e(v,null,{default:l(()=>[e(_,null,{default:l(()=>[e(De,{filled:"",modelValue:a.TSLODETA_PRC,"onUpdate:modelValue":s=>a.TSLODETA_PRC=s,label:"Price with v-money component",hint:"Mask: $ #,###.00 #"},{control:l(({id:s,floatingLabel:le,modelValue:ae,emitValue:oe})=>[L(e(p,de({id:s,class:"q-field__input text-right","model-value":ae,"onUpdate:modelValue":oe,ref_for:!0},E),null,16,["id","model-value","onUpdate:modelValue"]),[[ie,le]])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[r(" Price ")]),_:1})]),_:2},1024),e(v,null,{default:l(()=>[e(_,null,{default:l(()=>[e(O,{filled:"",modelValue:a.TSLODETA_PERIOD_FROM,"onUpdate:modelValue":s=>a.TSLODETA_PERIOD_FROM=s,dense:"",loading:i.value,onClick:o[10]||(o[10]=s=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":""},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(k,{modelValue:a.TSLODETA_PERIOD_FROM,"onUpdate:modelValue":s=>a.TSLODETA_PERIOD_FROM=s,mask:"YYYY-MM-DD"},{default:l(()=>[t("div",$e,[L(e(m,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","loading"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[r(" Period From ")]),_:1})]),_:2},1024),e(v,null,{default:l(()=>[e(_,null,{default:l(()=>[e(O,{filled:"",modelValue:a.TSLODETA_PERIOD_TO,"onUpdate:modelValue":s=>a.TSLODETA_PERIOD_TO=s,dense:"",loading:i.value,onClick:o[11]||(o[11]=s=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":""},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(k,{modelValue:a.TSLODETA_PERIOD_TO,"onUpdate:modelValue":s=>a.TSLODETA_PERIOD_TO=s,mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Ne,[L(e(m,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","loading"])]),_:2},1024),e(_,{caption:""},{default:l(()=>[r(" Period To ")]),_:1})]),_:2},1024),e(v,{side:""},{default:l(()=>[e(m,{icon:"delete",color:"red",flat:"",onClick:s=>J(b)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)):L((S(),h(q,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(v,null,{default:l(()=>[e(_,null,{default:l(()=>[r(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[ue]])]),_:1})])])])]),_:1}),e(re,{align:"right"},{default:l(()=>[e(m,{label:"OK",color:"primary",onClick:o[12]||(o[12]=a=>W()),disable:u.stateSubmit,loading:i.value},null,8,["disable","loading"]),e(m,{flat:"",label:"Cancel",color:"red",onClick:N(ee)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"])}}};const Fe={class:"q-pa-md"},xe={class:"row q-pb-md"},Be=t("div",{class:"col"},[t("span",{class:"text-h4"},"Sales Order / Receive Order")],-1),Ge={class:"col text-right"},je={class:"row q-pt-md"},He={class:"col"},al={__name:"salesOrderView",setup(K){const A=G(),d=c("TQUO_QUOCD"),V=c(""),i=c([]),U=c([{name:"TSLO_SLOCD",label:"RO. Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_ADDRESS_NAME",label:"Customer Addr.",field:"TSLO_ADDRESS_NAME",sortable:!0,align:"left"},{name:"TSLO_CUSCD",label:"Customer Code",field:"TSLO_CUSCD",sortable:!0,align:"left"},{name:"TSLO_ISSUDT",label:"Issue Date",field:"TSLO_ISSUDT",sortable:!0,align:"left"},{name:"TSLO_QUOCD",label:"Quot. Code",field:"TSLO_QUOCD",sortable:!0,align:"left"}]),T=c(!1);me(()=>{E()});const E=async()=>{T.value=!0,await H.post("receive-order/searchAPI",{searchBy:d.value,searchValue:V.value}).then(f=>{T.value=!1,i.value=f.data.data}).catch(f=>{T.value=!1})},I=()=>{A.dialog({component:qe}).onOk(async f=>{E()})};return(f,C)=>(S(),R("div",Fe,[t("div",xe,[Be,t("div",Ge,[e(m,{icon:"add",color:"blue",onClick:I},{default:l(()=>[e(y,null,{default:l(()=>[r("Create New RO")]),_:1})]),_:1})])]),e(ce),t("div",je,[t("div",He,[e(Oe,{title:"Created RO",rows:i.value,columns:U.value,"row-key":"name",loading:T.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(j,{outlined:"",modelValue:d.value,"onUpdate:modelValue":C[0]||(C[0]=n=>d.value=n),options:U.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(O,{borderless:"",dense:"",modelValue:V.value,"onUpdate:modelValue":[C[1]||(C[1]=n=>V.value=n),C[2]||(C[2]=n=>f.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(Q,{name:"search"})]),_:1},8,["modelValue"])]),header:l(n=>[e(x,{props:n},{default:l(()=>[e(F,{"auto-width":""},{default:l(()=>[r("Action")]),_:1}),(S(!0),R(M,null,Y(n.cols,D=>(S(),h(F,{key:D.name,props:n},{default:l(()=>[r(g(D.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(n=>[e(x,{props:n},{default:l(()=>[e(B,{"auto-width":""},{default:l(()=>[e(m,{flat:"",color:n.row.TQUO_APPRVDT!==null?"grey":"orange",icon:"edit",onClick:D=>f.onClickEdit(n.row.TQUO_QUOCD),dense:"",disable:n.row.TQUO_APPRVDT!==null},{default:l(()=>[e(y,null,{default:l(()=>[r(g(n.row.TQUO_APPRVDT?"Quotation already approved, cannot edit !":"Edit this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(m,{flat:"",color:n.row.TQUO_APPRVDT!==null?"grey":"red",icon:"delete",onClick:D=>f.onClickDelete(n.row.TQUO_QUOCD),dense:"",disable:n.row.TQUO_APPRVDT!==null},{default:l(()=>[e(y,null,{default:l(()=>[r(g(n.row.TQUO_APPRVDT?"Quotation already approved, cannot delete !":"Delete this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(m,{flat:"",color:"indigo",icon:"print",onClick:D=>f.onClickPrint(n.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(y,null,{default:l(()=>[r("Print this quotation")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(S(!0),R(M,null,Y(n.cols,D=>(S(),h(B,{key:D.name,props:n},{default:l(()=>[r(g(D.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{al as default};
