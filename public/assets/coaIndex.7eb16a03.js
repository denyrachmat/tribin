import{Q as $}from"./QTooltip.be452c7c.js";import{t as p,o as Y,C as _,D as P,E as a,F as e,M as J,O as U,J as l,$ as D,R as O,Q as f,S as Q,T as q,aZ as K,X as Z,Y as S,Z as X,aM as z,I as b,at as W,P as E}from"./index.42e87062.js";import{e as y}from"./QSelect.db843a49.js";import{u as ee,a as le,b as I}from"./QTable.1a212581.js";import{Q as x,a as B}from"./QTd.05fafdee.js";import{u as H}from"./format.950ca993.js";import{api_web as V}from"./axios.973daedc.js";const ae=l("div",{class:"text-h6"},"Closing Period",-1),oe={style:{border:"1px black solid","border-radius":"10px"}},te=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Header")],-1),se={class:"row q-col-gutter-sm"},ne={class:"col-12 col-sm-6"},de={class:"col-12 col-sm-6"},ie={class:"row q-col-gutter-sm q-pt-sm"},ue={class:"col-12 col-sm-6"},re={class:"col-12 col-sm-6"},ce={key:0,style:{border:"1px black solid","border-radius":"10px"}},Ce=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"COA Mapping")],-1),me={class:"row q-col-gutter-sm q-pt-sm"},pe={class:"col-12 col-sm-12 text-right"},_e={class:"col-12 col-sm-2"},ve={class:"col-12 col-sm-2"},Ae={class:"col-12 col-sm-1"},Oe={key:1,class:"row q-col-gutter-sm q-pt-sm"},fe=l("div",{class:"col-12 text-center"},"Click + button to add",-1),ge=[fe],Me={__name:"coaCreate",props:{header:String},setup(N){const g=H(),o=p({MCOA_COACD:"",MCOA_COANM:"",MCOA_CURR:"",MCOA_TYPE:"INC"}),r=p([]),i=p(!1),M=p([]),v=p([{label:"Income",value:"income"},{label:"Expense",value:"expense"},{label:"Account Group",value:"group"}]),C=N;Y(async()=>{C.header&&C.header!==""&&(await m(""),o.value.MCOA_COACD=C.header.MCOA_COACD,o.value.MCOA_COANM=C.header.MCOA_COANM,o.value.MCOA_CURR=C.header.MCOA_CURR,o.value.MCOA_TYPE=C.header.MCOA_TYPE,r.value=C.header.det)});const{dialogRef:k,onDialogHide:w,onDialogOK:c,onDialogCancel:d}=ee(),s=(u,t,n,h)=>{t(async()=>{h==="coa"&&await m(u)})},m=async(u,t="MCOA_COACD")=>{i.value=!0,await V.post("coa/searchAPI",{searchValue:u,searchCol:t}).then(n=>{i.value=!1,M.value=n.data.data}).catch(()=>{i.value=!1})},L=()=>{r.value.push({MCOAM_CR_COACD:"",MCOAM_DB_COACD:""})},F=u=>{g.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${u+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{r.value.splice(u,1),r.value.splice(u+1,1)})},j=u=>{r.value=[]},G=()=>{g.dialog({title:"Confirmation",message:"Are you sure want to save this journal ?",cancel:!0,persistent:!0}).onOk(async()=>{i.value=!0,await V.post(`${o.value.GLHIST_DOC?`acc/journal/${btoa(o.value.GLHIST_DOC)}`:"acc/journal"}`,{...o.value,det:r.value}).then(u=>{i.value=!1,g.notify({color:"green",message:`${u.data.msg}`}),c()}).catch(u=>{i.value=!1})})};return(u,t)=>(_(),P(X,{ref_key:"dialogRef",ref:k,onHide:S(w),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e(J,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(U,null,{default:a(()=>[ae]),_:1}),e(U,{class:"q-pa-sm"},{default:a(()=>[l("fieldset",oe,[te,l("div",se,[l("div",ne,[e(D,{filled:"",label:"COA Number",modelValue:o.value.MCOA_COACD,"onUpdate:modelValue":t[0]||(t[0]=n=>o.value.MCOA_COACD=n),dense:""},null,8,["modelValue"])]),l("div",de,[e(D,{filled:"",modelValue:o.value.MCOA_COANM,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value.MCOA_COANM=n),label:"COA Name",dense:""},null,8,["modelValue"])])]),l("div",ie,[l("div",ue,[e(D,{filled:"",label:"Valuta",modelValue:o.value.MCOA_CURR,"onUpdate:modelValue":t[2]||(t[2]=n=>o.value.MCOA_CURR=n),dense:""},null,8,["modelValue"])]),l("div",re,[e(y,{filled:"",modelValue:o.value.MCOA_TYPE,"onUpdate:modelValue":[t[3]||(t[3]=n=>o.value.MCOA_TYPE=n),t[4]||(t[4]=n=>j(n))],options:v.value,label:"Filled",dense:""},null,8,["modelValue","options"])])])]),o.value.MCOA_TYPE==="group"?(_(),O("fieldset",ce,[Ce,l("div",me,[l("div",pe,[e(f,{flat:"",color:"primary",icon:"add",onClick:L})])]),r.value.length>0?(_(!0),O(Q,{key:0},q(r.value,(n,h)=>(_(),O("div",{class:"row q-col-gutter-sm q-pt-sm",key:h},[l("div",_e,[e(y,{filled:"",label:"Account Code Credit",modelValue:n.MCOAM_CR_COACD,"onUpdate:modelValue":A=>n.MCOAM_CR_COACD=A,"use-input":"","input-debounce":"500",options:M.value,onFilter:t[5]||(t[5]=(A,R,T)=>s(A,R,T,"coa")),behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD","emit-value":"","map-options":"",loading:i.value,dense:""},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),l("div",ve,[e(y,{filled:"",label:"Account Code Debit",modelValue:n.MCOAM_DB_COACD,"onUpdate:modelValue":A=>n.MCOAM_DB_COACD=A,"use-input":"","input-debounce":"500",options:M.value,onFilter:t[6]||(t[6]=(A,R,T)=>s(A,R,T,"coa")),behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD","emit-value":"","map-options":"",loading:i.value,dense:""},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),l("div",Ae,[e(f,{icon:"delete",onClick:A=>F(h),flat:"",color:"red"},null,8,["onClick"])])]))),128)):(_(),O("div",Oe,ge))])):K("",!0)]),_:1}),e(Z,{align:"right"},{default:a(()=>[e(f,{label:"OK",color:"primary",onClick:t[7]||(t[7]=n=>G()),disable:u.stateSubmit,loading:i.value},null,8,["disable","loading"]),e(f,{flat:"",label:"Cancel",color:"red",onClick:S(d)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},be={class:"q-pa-md"},he={class:"row q-pb-md"},De=l("div",{class:"col"},[l("span",{class:"text-h4"},"Chart of Account")],-1),ye={class:"col text-right"},Ve={class:"row q-pt-md"},ke={class:"col"},Ne={__name:"coaIndex",setup(N){const g=H(),o=p("MCOA_COANM"),r=p(""),i=p([]),M=p([{name:"MCOA_COACD",label:"COA Code",field:"MCOA_COACD",sortable:!0,align:"left"},{name:"MCOA_TYPE",label:"Type",field:"MCOA_TYPE",sortable:!0,align:"left"},{name:"MCOA_CURR",label:"Valuta",field:"MCOA_CURR",sortable:!0,align:"left"},{name:"MAP_PARAM",label:"COA Configured",field:"MAP_PARAM",sortable:!0,align:"left"}]),v=p(!1);Y(()=>{C()});const C=async()=>{v.value=!0,await V.post("coa/searchAPI",{searchBy:o.value,searchValue:r.value}).then(c=>{v.value=!1,i.value=c.data.data}).catch(c=>{v.value=!1})},k=c=>{g.dialog({title:"Confirmation",message:"Are you sure want to delete this journal doc ?",cancel:!0,persistent:!0}).onOk(async()=>{V.delete(`acc/journal/${btoa(c)}`).then(d=>{v.value=!1,i.value=d.data.data}).catch(d=>{v.value=!1})})},w=(c=null)=>{g.dialog({component:Me,componentProps:{header:c}}).onOk(async d=>{C()})};return(c,d)=>(_(),O("div",be,[l("div",he,[De,l("div",ye,[e(f,{icon:"add",color:"blue",onClick:d[0]||(d[0]=s=>c.onClickNew([]))},{default:a(()=>[e($,null,{default:a(()=>[b("Create New COA")]),_:1})]),_:1})])]),e(z),l("div",Ve,[l("div",ke,[e(le,{title:"COA List",rows:i.value,columns:M.value,"row-key":"name",loading:v.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":a(()=>[e(y,{outlined:"",modelValue:o.value,"onUpdate:modelValue":d[1]||(d[1]=s=>o.value=s),options:M.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(D,{borderless:"",dense:"",modelValue:r.value,"onUpdate:modelValue":[d[2]||(d[2]=s=>r.value=s),d[3]||(d[3]=s=>c.dataAcc())],placeholder:"Search",outlined:"",debounce:"1000"},{append:a(()=>[e(W,{name:"search"})]),_:1},8,["modelValue"])]),header:a(s=>[e(x,{props:s},{default:a(()=>[e(I,{"auto-width":""},{default:a(()=>[b("Action")]),_:1}),(_(!0),O(Q,null,q(s.cols,m=>(_(),P(I,{key:m.name,props:s},{default:a(()=>[b(E(m.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(s=>[e(x,{props:s},{default:a(()=>[e(B,{"auto-width":""},{default:a(()=>[e(f,{flat:"",color:"orange",icon:"edit",onClick:m=>w(s.row),dense:""},{default:a(()=>[e($,null,{default:a(()=>[b("Journal Edit")]),_:1})]),_:2},1032,["onClick"]),e(f,{flat:"",color:"red",icon:"delete",onClick:m=>k(s.row.GLHIST_DOC),dense:""},{default:a(()=>[e($,null,{default:a(()=>[b("Journal Delete")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(_(!0),O(Q,null,q(s.cols,m=>(_(),P(B,{key:m.name,props:s},{default:a(()=>[b(E(m.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Ne as default};
