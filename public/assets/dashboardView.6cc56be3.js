import{s as u,o as M,B as n,C as T,D as a,E as t,J as y,K as g,b0 as N,L as R,Q as h,M as w,O as q,I as l,P as U,aa as B,a$ as d,S as L,R as f,aY as A,aZ as O,b4 as H,H as Q}from"./index.430f9beb.js";import{u as $,b as E,a as k,c as V,q as G}from"./use-dialog-plugin-component.d7c8d33f.js";import{d as J,Q as S,b as K}from"./date.1f48afa7.js";import{api_web as x}from"./axios.86950c4c.js";const j=l("div",{class:"text-h6"},"Review Item List",-1),z={__name:"viewListApprovalItem",props:{cd:String,typeCD:String},setup(P){const{dialogRef:C,onDialogHide:p,onDialogOK:D,onDialogCancel:_}=$();E();const i=P,m=u(!1),b=u([{name:"MITM_ITMNM",label:"Item Name",field:"MITM_ITMNM",sortable:!0,align:"left"},{name:"TQUODETA_USAGE_DESCRIPTION",label:"Usage",field:"TQUODETA_USAGE_DESCRIPTION",sortable:!0,align:"left"},{name:"TQUODETA_PRC",label:"Price",field:"TQUODETA_PRC",sortable:!0,align:"left",format:e=>e.toLocaleString()},{name:"TQUODETA_OPRPRC",label:"Operator",field:"TQUODETA_OPRPRC",sortable:!0,align:"left",format:e=>e.toLocaleString()},{name:"TQUODETA_MOBDEMOB",label:"MOB DEMOB",field:"TQUODETA_MOBDEMOB",sortable:!0,align:"left",format:e=>e.toLocaleString()},{name:"SUBTOT",label:"MOB DEMOB",sortable:!0,field:e=>e.TQUODETA_PRC+e.TQUODETA_OPRPRC+e.TQUODETA_MOBDEMOB,align:"left",format:e=>e.toLocaleString()}]),c=u([]);M(()=>{v()});const v=async()=>{await x.get(`${i.typeCD}/${btoa(i.cd)}`).then(e=>{m.value=!1,c.value=e.data}).catch(e=>{m.value=!1})};return(e,o)=>(n(),T(q,{ref_key:"dialogRef",ref:C,onHide:w(p),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[t(y,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[t(g,null,{default:a(()=>[j]),_:1}),t(g,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[i.typeCD=="quotation"?(n(),T(k,{key:0,title:"Item List",rows:c.value.dataItem,columns:b.value,"row-key":"name",dense:"",loading:m.value},null,8,["rows","columns","loading"])):N("",!0)]),_:1}),t(R,{align:"center"},{default:a(()=>[t(V,null,{default:a(()=>[t(h,{color:"primary",icon:"check",label:"Approve"}),t(h,{color:"red",icon:"cancel",label:"Reject"}),t(h,{color:"orange",flat:"",label:"cancel",onClick:w(_)},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}},F=l("div",{class:"text-h6"},"Approval List",-1),Y={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Z={class:"text-h5 text-bold"},W={class:"text-h6 text-bold"},X={class:"text-subtitle2"},ee={class:"row"},te={class:"col"},ae={class:"col text-right"},oe={__name:"viewListApproval",props:{listApprv:Array,typeAPI:String},setup(P){const C=E(),p=P,D=u([{name:"APP_CD",label:"Doc Code",field:"APP_CD"},{name:"APP_CUSNM",label:"Customer",field:"APP_CUSNM"},{name:"APP_SBJCT",label:"Subject",field:"APP_SBJCT"},{name:"APP_ATTN",label:"Attn",field:"APP_ATTN"},{name:"CREATED_AT",label:"Created Date",field:"CREATED_AT"}]),_=u(""),i=(o,r="days")=>{const s=new Date,I=new Date(o);return J.getDateDiff(s,I,r)},m=o=>{let r="";p.typeAPI=="quot"?r="quotation":p.typeAPI=="pr"?r="purchase-request-approval":p.typeAPI=="po"&&(r="purchase-order/approval-document"),C.dialog({component:z,componentProps:{cd:o,typeCD:r}}).onOk(async s=>{quotationGroupConditions.value=s.MCONDITION_RPT_STAT,quotationConditions.value=s.group})},{dialogRef:b,onDialogHide:c,onDialogOK:v,onDialogCancel:e}=$();return(o,r)=>(n(),T(q,{ref_key:"dialogRef",ref:b,onHide:w(c),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[t(y,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[t(g,null,{default:a(()=>[F]),_:1}),t(g,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[t(k,{grid:"",flat:"",bordered:"","card-container-class":o.cardContainerClass,title:"Outstanding Approval",rows:p.listApprv,columns:D.value,"row-key":"name",filter:_.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":o.rowsPerPageOptions},{"top-right":a(()=>[t(U,{borderless:"",dense:"",debounce:"300",modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=s=>_.value=s),placeholder:"Search"},{append:a(()=>[t(B,{name:"search"})]),_:1},8,["modelValue"])]),item:a(s=>[l("div",Y,[t(y,{flat:"",bordered:""},{default:a(()=>[t(g,{class:"text-center bg-secondary text-white"},{default:a(()=>[l("div",Z,d(s.row.APP_CUSNM),1)]),_:2},1024),t(L),t(g,null,{default:a(()=>[l("div",W,d(s.row.APP_CD),1),l("div",X,d(s.row.APP_SBJCT),1)]),_:2},1024),t(g,null,{default:a(()=>[l("div",ee,[l("div",te,[t(h,{label:"Preview",color:"primary",outline:"",onClick:I=>m(s.row.APP_CD)},null,8,["onClick"])]),l("div",ae,d(i(s.row.CREATED_AT)<30?`${i(s.row.CREATED_AT)} Days Ago`:`${i(s.row.CREATED_AT,"months")} Month ago`),1)])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options"])]),_:1}),t(R,{align:"right"},{default:a(()=>[t(h,{label:"OK",color:"primary",onClick:r[1]||(r[1]=s=>w(v)()),disable:o.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},le={class:"q-pa-md bg-grey-5 window-height"},se={class:"row"},ne={class:"row"},ie={class:"col"},re={class:"text-h3 text-cyan"},ce={class:"text-subtitle2 text-cyan"},de={class:"col text-right"},ue={class:"row q-pa-sm"},pe={class:"col"},_e={key:1},Te={__name:"dashboardView",setup(P){const C=E(),p=u([{total:900,title:"Total Sales",icon:"shopping_cart",color:"cyan"},{total:900,title:"Total Purchase",icon:"shopping_bag",color:"cyan"},{total:900,title:"Total Profit",icon:"payments",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"}]),D=u([{name:"name",label:"Business",field:"name",sortable:!0,align:"left"},{name:"quot",label:"Quotation",field:"quot_count",sortable:!0,align:"center"},{name:"pr",label:"Purchase Request",field:"pr_count",sortable:!0,align:"center"},{name:"po",label:"Purchase Order",field:"po_count",sortable:!0,align:"center"}]),_=u([]),i=u(!1);u(null),M(async()=>{await m()});const m=async()=>{i.value=!0,await x.get("/approval/notificationsAPI/top-user").then(c=>{i.value=!1,_.value=c.data}).catch(c=>{i.value=!1})},b=(c,v)=>{C.dialog({component:oe,componentProps:{listApprv:c,typeAPI:v}}).onOk(async e=>{quotationGroupConditions.value=e.MCONDITION_RPT_STAT,quotationConditions.value=e.group})};return(c,v)=>(n(),f("div",le,[l("div",se,[(n(!0),f(A,null,O(p.value,(e,o)=>(n(),f("div",{class:H("col-3 q-pa-sm"),key:o},[t(y,null,{default:a(()=>[t(g,null,{default:a(()=>[l("div",ne,[l("div",ie,[l("div",re,d(e.total),1),l("div",ce,d(e.title),1)]),l("div",de,[t(B,{name:e.icon,size:"4.4em",color:e.color},null,8,["name","color"])])])]),_:2},1024)]),_:2},1024)]))),128))]),l("div",ue,[l("div",pe,[t(k,{flat:"",bordered:"",title:"Approval List",rows:_.value,columns:D.value,"row-key":"name",loading:i.value},{"top-right":a(()=>[t(h,{flat:"",icon:"refresh",color:"cyan",onClick:m})]),header:a(e=>[t(S,{props:e},{default:a(()=>[(n(!0),f(A,null,O(e.cols,o=>(n(),T(G,{key:o.name,props:e},{default:a(()=>[Q(d(o.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(e=>[t(S,{props:e},{default:a(()=>[(n(!0),f(A,null,O(e.cols,o=>(n(),T(K,{key:o.name,props:e},{default:a(()=>[o.name==="quot"||o.name==="pr"||o.name==="po"||o.name==="spk"?(n(),f(A,{key:0},[o.value>0?(n(),T(h,{key:0,flat:"",color:"blue",onClick:r=>b(e.row[o.name.split("_")[0]],o.name)},{default:a(()=>[l("b",null,d(o.value),1)]),_:2},1032,["onClick"])):(n(),f("span",_e,d(o.value),1))],64)):(n(),f(A,{key:1},[Q(d(o.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Te as default};
