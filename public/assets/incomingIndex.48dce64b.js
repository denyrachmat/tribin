import{Q as I}from"./QTooltip.39ce04a3.js";import{t as p,o as x,C as v,D as P,E as o,F as a,M as ae,O as A,J as i,$ as S,an as B,U as q,Q as D,R as T,S as k,T as Q,V as oe,I as f,P as M,W as te,X as se,Z as ne,aY as ie}from"./index.1eca0595.js";import{a as Y,l as y,Q as ue,b as E,c as h,d as w,k as de,m as F}from"./QTable.17923e75.js";import{Q as $,a as H}from"./QTd.67b8ab51.js";import{api_web as g}from"./axios.24326879.js";import{Q as re,a as ce}from"./QInnerLoading.c2e7448b.js";import{Q as pe,a as me,C as ve}from"./ClosePopup.681b4c90.js";import{Q as Ce}from"./QBtnToggle.93b7e77e.js";import"./use-render-cache.3aae9b27.js";import"./date.b1f7a7be.js";import"./QBtnGroup.ca81f0b2.js";const _e=i("div",{class:"text-h6"},"Create Incoming",-1),Ve={style:{border:"1px black solid","border-radius":"10px"}},fe=i("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[i("b",null,"Header")],-1),De={class:"row q-col-gutter-md"},Te={class:"col-12 col-sm-6"},ge={class:"col-12 col-sm-6"},be={class:"row items-center justify-end"},Re={class:"row q-col-gutter-md q-pt-md"},he={key:0,class:"col-12 col-sm-6"},Se={key:1,class:"col-12 col-sm-6"},ye={key:2,class:"col-12 col-sm-6"},Oe={key:3,class:"col-12 col-sm-6"},Pe={class:"row q-col-gutter-md q-pt-md"},Ue={class:"col"},we={class:"row q-py-md"},Ie={class:"col"},ke={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Qe=i("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[i("b",null,"List Of Items")],-1),Me={class:"row q-pb-sm"},Ne={class:"col text-right"},Le={__name:"incomingCreate",props:{dataHeader:Array},setup(J){const O=Y(),s=p({TRCV_RCVCD:"",TRCV_SUPCD:"",TRCV_ISSUDT:"",TRCV_REFFNO:"",TRCV_DOCNO:""}),V=p(1),c=p([]),t=p(!1),b=p([]),U=p([]),R=p([]),C=p([]),m=p([]);x(()=>{_(""),L(""),N("")});const u=(n,l,e,d)=>{l(async()=>{d==="supp"&&await N(n),d==="cust"&&await L(n),d==="item"&&await _(n),d==="po"&&await K(n),d==="inv"&&await G(n)})},_=async n=>{t.value=!0,await g.post("item/searchAPI",{searchValue:n,isITMCD:1}).then(l=>{t.value=!1,C.value=l.data.data}).catch(()=>{t.value=!1})},N=async(n,l="MSUP_SUPNM")=>{t.value=!0,await g.post("supplier/searchAPI",{searchValue:n,searchCol:l}).then(e=>{t.value=!1,b.value=e.data.data}).catch(()=>{t.value=!1})},L=async(n,l="MCUS_CUSNM")=>{t.value=!0,await g.post("customer/searchAPI",{searchValue:n,searchCol:l}).then(e=>{t.value=!1,U.value=e.data.data}).catch(()=>{t.value=!1})},K=async(n,l="TPCHORD_PCHCD")=>{t.value=!0,await g.post("purchase-order/searchApprovedPO",{searchValue:n,searchCol:l}).then(e=>{t.value=!1,R.value=e.data.data}).catch(()=>{t.value=!1})},j=n=>{O.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${n+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{c.value.splice(n,1)})},z=()=>{c.value.push({item_code:"",quantity:"",unit_price:""})},G=async(n,l="TDLVORD_DLVCD")=>{t.value=!0,await g.post("invoices/search",{searchBy:l,searchValue:n}).then(e=>{t.value=!1,m.value=e.data.data}).catch(e=>{t.value=!1})},W=n=>{let l=R.value.filter(e=>e.TPCHORD_PCHCD==n);c.value=[],l.length>0&&(s.value.TRCV_SUPCD=l[0].TPCHORD_SUPCD,l[0].det.map(e=>{c.value.push({item_code:e.TPCHORDDETA_ITMCD,quantity:e.TPCHORDDETA_ITMQT,unit_price:e.TPCHORDDETA_ITMPRC_PER})}))},X=n=>{let l=m.value.filter(e=>e.TDLVORD_DLVCD==n);c.value=[],l.length>0&&(s.value.TRCV_SUPCD=l[0].TDLVORD_CUSCD,l[0].dlvacc.map(e=>{c.value.push({item_code:e.TDLVACCESSORY_ITMCD,quantity:e.TDLVACCESSORY_ITMQT,unit_price:0})}),l[0].dlvdet.map(e=>{c.value.push({item_code:e.TDLVORDDETA_ITMCD,quantity:e.TDLVORDDETA_ITMQT,unit_price:e.TDLVORDDETA_PRC})}))},Z=()=>{O.dialog({title:"Confirmation",message:"Are you sure want to save this Incoming ?",cancel:!0,persistent:!0}).onOk(async()=>{t.value=!0,await g.post("receive/saveAPI",{...forms.value,det:quotDetail.value}).then(n=>{t.value=!1,O.notify({color:"green",message:`${n.data.msg}`}),onDialogOK()}).catch(()=>{t.value=!1})})};return(n,l)=>(v(),P(ne,{ref:"dialogRef",onHide:n.onDialogHide,"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:o(()=>[a(ae,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:o(()=>[a(A,null,{default:o(()=>[_e]),_:1}),a(A,{class:"q-pa-sm"},{default:o(()=>[i("fieldset",Ve,[fe,a(re,{showing:t.value,dark:""},{default:o(()=>[a(ce,{size:"50px",color:"primary"})]),_:1},8,["showing"]),i("div",De,[i("div",Te,[a(S,{label:"Code",readonly:"",dense:"",filled:"",modelValue:s.value.TRCV_RCVCD,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value.TRCV_RCVCD=e)},null,8,["modelValue"])]),i("div",ge,[a(S,{filled:"",modelValue:s.value.TRCV_ISSUDT,"onUpdate:modelValue":l[2]||(l[2]=e=>s.value.TRCV_ISSUDT=e),dense:"",label:"Receive Date"},{append:o(()=>[a(B,{name:"event",class:"cursor-pointer"},{default:o(()=>[a(pe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(me,{modelValue:s.value.TRCV_ISSUDT,"onUpdate:modelValue":l[1]||(l[1]=e=>s.value.TRCV_ISSUDT=e),mask:"YYYY-MM-DD"},{default:o(()=>[i("div",be,[q(a(D,{label:"Close",color:"primary",flat:""},null,512),[[ve]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),i("div",Re,[V.value==1?(v(),T("div",he,[a(y,{dense:"",filled:"",label:"Supplier Name",modelValue:s.value.TRCV_SUPCD,"onUpdate:modelValue":l[3]||(l[3]=e=>s.value.TRCV_SUPCD=e),"use-input":"","input-debounce":"500",options:b.value,onFilter:l[4]||(l[4]=(e,d,r)=>u(e,d,r,"supp")),behavior:"dialog","option-label":"MSUP_SUPNM","option-value":"MSUP_SUPCD","emit-value":"","map-options":"",loading:t.value,disable:s.value.TRCV_RCVCD!==""||V.value==1},null,8,["modelValue","options","loading","disable"])])):(v(),T("div",Se,[a(y,{dense:"",filled:"",label:"Customer Name",modelValue:s.value.TRCV_SUPCD,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value.TRCV_SUPCD=e),"use-input":"","input-debounce":"500",options:U.value,onFilter:l[6]||(l[6]=(e,d,r)=>u(e,d,r,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:t.value,disable:s.value.TRCV_RCVCD!==""||V.value==1},null,8,["modelValue","options","loading","disable"])])),V.value==1?(v(),T("div",ye,[a(y,{dense:"",filled:"",label:"PO Number",modelValue:s.value.TRCV_REFFNO,"onUpdate:modelValue":[l[7]||(l[7]=e=>s.value.TRCV_REFFNO=e),l[9]||(l[9]=e=>W(e))],"use-input":"","input-debounce":"500",options:R.value,onFilter:l[8]||(l[8]=(e,d,r)=>u(e,d,r,"po")),behavior:"dialog","option-label":"PO_CUSTDESC","option-value":"TPCHORD_PCHCD","emit-value":"","map-options":"",loading:t.value,disable:s.value.TRCV_RCVCD!==""},null,8,["modelValue","options","loading","disable"])])):(v(),T("div",Oe,[a(y,{dense:"",filled:"",label:"JAT Invoice No",modelValue:s.value.TRCV_REFFNO,"onUpdate:modelValue":[l[10]||(l[10]=e=>s.value.TRCV_REFFNO=e),l[12]||(l[12]=e=>X(e))],"use-input":"","input-debounce":"500",options:m.value,onFilter:l[11]||(l[11]=(e,d,r)=>u(e,d,r,"inv")),behavior:"dialog","option-label":"LABEL","option-value":"TDLVORD_DLVCD","emit-value":"","map-options":"",loading:t.value,disable:s.value.TRCV_RCVCD!==""},null,8,["modelValue","options","loading","disable"])]))]),i("div",Pe,[i("div",Ue,[a(S,{label:"Doc Supplier No",dense:"",filled:"",modelValue:s.value.TRCV_DOCNO,"onUpdate:modelValue":l[13]||(l[13]=e=>s.value.TRCV_DOCNO=e)},null,8,["modelValue"])])])]),i("div",we,[i("div",Ie,[a(Ce,{modelValue:V.value,"onUpdate:modelValue":l[14]||(l[14]=e=>V.value=e),spread:"","no-caps":"","toggle-color":"purple",color:"white","text-color":"black",options:[{label:"From PO",value:1},{label:"Return",value:2}],disable:s.value.TRCV_RCVCD!=="",onChange:l[15]||(l[15]=e=>s.value.TRCV_REFFNO="")},null,8,["modelValue","disable"])])]),i("fieldset",ke,[Qe,i("div",Me,[i("div",Ne,[a(D,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:z,loading:t.value},null,8,["loading"])])]),a(ue,{bordered:"",dense:""},{default:o(()=>[c.value.length>0?(v(!0),T(k,{key:0},Q(c.value,(e,d)=>(v(),P(E,{key:d,class:"q-my-sm",dense:"",loading:t.value},{default:o(()=>[a(h,{avatar:""},{default:o(()=>[a(oe,{"text-color":"blue"},{default:o(()=>[f(M(d+1),1)]),_:2},1024)]),_:2},1024),a(h,null,{default:o(()=>[a(w,null,{default:o(()=>[a(y,{dense:"",filled:"",label:"Item Code",modelValue:e.item_code,"onUpdate:modelValue":r=>e.item_code=r,"use-input":"","input-debounce":"500",options:C.value,onFilter:l[16]||(l[16]=(r,ee,le)=>u(r,ee,le,"item")),behavior:"dialog","option-label":"MITM_ITMNMREAL","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:t.value,disable:s.value.TRCV_RCVCD!==""},null,8,["modelValue","onUpdate:modelValue","options","loading","disable"])]),_:2},1024)]),_:2},1024),a(h,null,{default:o(()=>[a(w,null,{default:o(()=>[a(S,{dense:"",label:"Qty",filled:"",modelValue:e.quantity,"onUpdate:modelValue":r=>e.quantity=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a(h,null,{default:o(()=>[a(w,null,{default:o(()=>[a(S,{dense:"",label:"Price",filled:"",modelValue:e.unit_price,"onUpdate:modelValue":r=>e.unit_price=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a(h,{side:""},{default:o(()=>[a(D,{icon:"delete",color:"red",flat:"",onClick:r=>j(d)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["loading"]))),128)):q((v(),P(E,{key:1,class:"q-my-sm",clickable:""},{default:o(()=>[a(h,null,{default:o(()=>[a(w,null,{default:o(()=>[f(" Choose sales order first to access item list ")]),_:1})]),_:1})]),_:1})),[[te]])]),_:1})])]),_:1}),a(se,{align:"right"},{default:o(()=>[a(D,{label:"OK",color:"primary",onClick:l[17]||(l[17]=e=>Z()),disable:n.stateSubmit,loading:t.value},null,8,["disable","loading"]),a(D,{flat:"",label:"Cancel",color:"red",onClick:n.onDialogCancel},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Ae={class:"q-pa-md"},qe={class:"row q-pb-md"},Ee=i("div",{class:"col"},[i("span",{class:"text-h4"},"Incoming")],-1),Fe={class:"col text-right"},$e={class:"row q-pt-md"},He={class:"col"},el={__name:"incomingIndex",setup(J){const O=Y(),s=p([]),V=p([{name:"TRCV_RCVCD",label:"Receive ID",field:"TRCV_RCVCD",sortable:!0,align:"left"},{name:"MSUP_SUPNM",label:"Supplier Name",field:"MSUP_SUPNM",sortable:!0,align:"left"},{name:"TOT_RCV",label:"Total Qty",field:"TOT_RCV",sortable:!0,align:"left"},{name:"TOT_AMT",label:"Total Amount",field:"TOT_AMT",sortable:!0,align:"left"}]),c=p(!1),t=p(""),b=p("");x(()=>{U()});const U=async()=>{c.value=!0,await g.post("receive/searchAPI",{searchBy:t.value,searchValue:b.value}).then(C=>{c.value=!1,s.value=C.data.data}).catch(C=>{c.value=!1})},R=(C=[])=>{O.dialog({component:Le,componentProps:{dataHeader:C}}).onOk(async m=>{getOutgoingData()})};return(C,m)=>(v(),T("div",Ae,[i("div",qe,[Ee,i("div",Fe,[a(D,{icon:"add",color:"blue",onClick:m[0]||(m[0]=u=>R())},{default:o(()=>[a(I,null,{default:o(()=>[f("Create New Delivery")]),_:1})]),_:1})])]),a(ie),i("div",$e,[i("div",He,[a(de,{title:"Outgoing List",rows:s.value,columns:V.value,"row-key":"TDLVORD_DLVCD",loading:c.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":o(()=>[a(y,{outlined:"",modelValue:t.value,"onUpdate:modelValue":m[1]||(m[1]=u=>t.value=u),options:C.columns,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),a(S,{borderless:"",dense:"",modelValue:b.value,"onUpdate:modelValue":[m[2]||(m[2]=u=>b.value=u),m[3]||(m[3]=u=>C.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:o(()=>[a(B,{name:"search"})]),_:1},8,["modelValue"])]),header:o(u=>[a($,{props:u},{default:o(()=>[(v(!0),T(k,null,Q(u.cols,_=>(v(),P(F,{key:_.name,props:u},{default:o(()=>[f(M(_.label),1)]),_:2},1032,["props"]))),128)),a(F,{"auto-width":""},{default:o(()=>[f("Action")]),_:1})]),_:2},1032,["props"])]),body:o(u=>[a($,{props:u},{default:o(()=>[(v(!0),T(k,null,Q(u.cols,_=>(v(),P(H,{key:_.name,props:u},{default:o(()=>[f(M(_.value),1)]),_:2},1032,["props"]))),128)),a(H,{"auto-width":""},{default:o(()=>[a(D,{flat:"",color:"orange",icon:"edit",onClick:_=>R(u.row),dense:""},{default:o(()=>[a(I,null,{default:o(()=>[f("Edit Data")]),_:1})]),_:2},1032,["onClick"]),a(D,{flat:"",color:"red",icon:"delete",onClick:_=>C.onDelete(u.row.TDLVORD_DLVCD),dense:""},{default:o(()=>[a(I,null,{default:o(()=>[f("Edit Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{el as default};
