import{t as p,o as U,C as _,D as V,E as a,F as e,M as N,O as w,J as l,$ as g,at as F,U as j,Q as f,R as T,S as H,T as L,P as y,X as J,Y as k,Z as K,aM as X,I as A}from"./index.e4aab49f.js";import{e as q}from"./QSelect.aec9ae8a.js";import{u as Z,a as z,b as M}from"./QTable.d45a0fc0.js";import{Q as E,a as Q}from"./QTd.ad20fd76.js";import{Q as W}from"./QTooltip.a60047a4.js";import{u as $}from"./format.1f37e7f0.js";import{api_web as O}from"./axios.edfbc1f0.js";import{Q as ee}from"./QBtnToggle.ea1a7eb4.js";import{Q as le,a as ae,C as oe}from"./ClosePopup.161d4a01.js";import"./QBtnGroup.2158cfc6.js";import"./use-render-cache.3aae9b27.js";import"./date.8adfc801.js";const te=l("div",{class:"text-h6"},"Closing Period",-1),se={style:{border:"1px black solid","border-radius":"10px"}},ne=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Header")],-1),de={class:"row q-col-gutter-sm"},ie={class:"col-12"},ue={class:"row q-col-gutter-sm q-pt-sm"},re={class:"col-12 col-sm-6"},ce={class:"col-12 col-sm-6"},me={class:"row items-center justify-end"},pe={style:{border:"1px black solid","border-radius":"10px"}},_e=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Detail")],-1),Ce={class:"row q-col-gutter-sm q-pt-sm"},ve={class:"col-12 col-sm-12 text-right"},fe={class:"col-12 col-sm-3"},ge={class:"col-12 col-sm-2"},Te={class:"col-12 col-sm-3"},be={class:"col-12 col-sm-3"},he={class:"col-12 col-sm-1"},Se={key:1,class:"row q-col-gutter-sm q-pt-sm"},Ie={class:"col-12"},Ae={__name:"journalInputCreate",props:{header:String},setup(G){const b=$(),t=p({GLHIST_ACC:"",GLHIST_DOC:"",GLHIST_EFFDT:"",MCOA_TYPE:"INC"}),m=p([]),d=p(!1),h=p([]),C=G;U(async()=>{C.header&&C.header!==""&&console.log(C.header)});const{dialogRef:S,onDialogHide:D,onDialogOK:i,onDialogCancel:u}=Z(),s=(r,n,o,I)=>{n(async()=>{I==="coa"&&await v(r)})},v=async(r,n="MCOA_COACD")=>{d.value=!0,await O.post("coa/searchAPI",{searchValue:r,searchCol:n}).then(o=>{d.value=!1,h.value=o.data.data}).catch(()=>{d.value=!1})},P=()=>{m.value.push({GLHIST_ACC:t.value.GLHIST_ACC,GLHIST_DOC:t.value.GLHIST_DOC,GLHIST_AMT:0,GLHIST_DESC:"",GLHIST_EFFDT:t.value.GLHIST_EFFDT,MCOA_TYPE:t.value.MCOA_TYPE})},x=r=>{b.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${r+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{m.value.splice(r,1)})},R=()=>{b.dialog({title:"Confirmation",message:"Are you sure want to save this journal ?",cancel:!0,persistent:!0}).onOk(async()=>{d.value=!0,await O.post("acc/journal",{...t.value,det:m.value}).then(r=>{d.value=!1,b.notify({color:"green",message:`${r.data.msg}`}),i()}).catch(r=>{d.value=!1})})};return(r,n)=>(_(),V(K,{ref_key:"dialogRef",ref:S,onHide:k(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e(N,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(w,null,{default:a(()=>[te]),_:1}),e(w,{class:"q-pa-sm"},{default:a(()=>[l("fieldset",se,[ne,l("div",de,[l("div",ie,[e(ee,{modelValue:t.value.MCOA_TYPE,"onUpdate:modelValue":n[0]||(n[0]=o=>t.value.MCOA_TYPE=o),spread:"",class:"my-custom-toggle","no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Income",value:"INC"},{label:"Expense",value:"OUT"}]},null,8,["modelValue"])])]),l("div",ue,[l("div",re,[e(g,{filled:"",label:"Doc Reference",modelValue:t.value.GLHIST_DOC,"onUpdate:modelValue":n[1]||(n[1]=o=>t.value.GLHIST_DOC=o),readonly:"",dense:""},null,8,["modelValue"])]),l("div",ce,[e(g,{filled:"",modelValue:t.value.GLHIST_EFFDT,"onUpdate:modelValue":n[3]||(n[3]=o=>t.value.GLHIST_EFFDT=o),label:"Eff Date",dense:""},{prepend:a(()=>[e(F,{name:"event",class:"cursor-pointer"},{default:a(()=>[e(le,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(ae,{modelValue:t.value.GLHIST_EFFDT,"onUpdate:modelValue":n[2]||(n[2]=o=>t.value.GLHIST_EFFDT=o),mask:"YYYY-MM-DD"},{default:a(()=>[l("div",me,[j(e(f,{label:"Close",color:"primary",flat:""},null,512),[[oe]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),l("fieldset",pe,[_e,l("div",Ce,[l("div",ve,[e(f,{flat:"",color:"primary",icon:"add",onClick:P})])]),m.value.length>0?(_(!0),T(H,{key:0},L(m.value,(o,I)=>(_(),T("div",{class:"row q-col-gutter-sm q-pt-sm",key:I},[l("div",fe,[e(q,{filled:"",label:"Account Code",modelValue:o.GLHIST_ACC,"onUpdate:modelValue":c=>o.GLHIST_ACC=c,"use-input":"","input-debounce":"500",options:h.value,onFilter:n[4]||(n[4]=(c,Y,B)=>s(c,Y,B,"coa")),behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD","emit-value":"","map-options":"",loading:d.value,dense:""},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),l("div",ge,[e(g,{filled:"",label:"Valuta",modelValue:o.GLHIST_CURR,"onUpdate:modelValue":c=>o.GLHIST_CURR=c,dense:""},null,8,["modelValue","onUpdate:modelValue"])]),l("div",Te,[e(g,{filled:"",label:"Description",modelValue:o.GLHIST_DESC,"onUpdate:modelValue":c=>o.GLHIST_DESC=c,dense:""},null,8,["modelValue","onUpdate:modelValue"])]),l("div",be,[e(g,{filled:"",label:"Amount",modelValue:o.GLHIST_AMT,"onUpdate:modelValue":c=>o.GLHIST_AMT=c,dense:""},null,8,["modelValue","onUpdate:modelValue"])]),l("div",he,[e(f,{icon:"delete",onClick:c=>x(I),flat:"",color:"red"},null,8,["onClick"])])]))),128)):(_(),T("div",Se,[l("div",Ie," Click + button to add "+y(t.value.MCOA_TYPE==="INC"?"Income":"Expense"),1)]))])]),_:1}),e(J,{align:"right"},{default:a(()=>[e(f,{label:"OK",color:"primary",onClick:n[5]||(n[5]=o=>R()),disable:r.stateSubmit,loading:d.value},null,8,["disable","loading"]),e(f,{flat:"",label:"Cancel",color:"red",onClick:k(u)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},De={class:"q-pa-md"},Ve={class:"row q-pb-md"},He=l("div",{class:"col"},[l("span",{class:"text-h4"},"Journal Input")],-1),Le={class:"col text-right"},ye={class:"row q-pt-md"},Oe={class:"col"},Re={__name:"journalInputIndex",setup(G){const b=$(),t=p("DOCCD"),m=p(""),d=p([]),h=p([{name:"GLHIST_ACC",label:"COA Code",field:"GLHIST_ACC",sortable:!0,align:"left"},{name:"MCOA_COANM",label:"COA Desc",field:"MCOA_COANM",sortable:!0,align:"left"},{name:"GLHIST_DESC",label:"Description",field:"GLHIST_DESC",sortable:!0,align:"left"},{name:"CURR",label:"Valuta",field:"CURR",sortable:!0,align:"left"},{name:"GLHIST_AMT_DB",label:"Amount",field:"GLHIST_AMT_DB",sortable:!0,format:i=>i.toLocaleString(),align:"left"},{name:"GLHIST_AMT_CR",label:"Amount",field:"GLHIST_AMT_CR",sortable:!0,format:i=>i.toLocaleString(),align:"left"}]),C=p(!1);U(()=>{S()});const S=async()=>{C.value=!0,await O.post("acc/journal/searchAPI",{searchBy:t.value,searchValue:m.value}).then(i=>{C.value=!1,d.value=i.data.data}).catch(i=>{C.value=!1})},D=(i=null)=>{b.dialog({component:Ae}).onOk(async u=>{S()})};return(i,u)=>(_(),T("div",De,[l("div",Ve,[He,l("div",Le,[e(f,{icon:"add",color:"primary",onClick:u[0]||(u[0]=s=>D())})])]),e(X),l("div",ye,[l("div",Oe,[e(z,{title:"Journal History",rows:d.value,columns:h.value,"row-key":"name",loading:C.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":a(()=>[e(q,{outlined:"",modelValue:t.value,"onUpdate:modelValue":u[1]||(u[1]=s=>t.value=s),options:h.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(g,{borderless:"",dense:"",modelValue:m.value,"onUpdate:modelValue":[u[2]||(u[2]=s=>m.value=s),u[3]||(u[3]=s=>S())],placeholder:"Search",outlined:"",debounce:"1000"},{append:a(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),header:a(s=>[e(E,{props:s},{default:a(()=>[e(M,{"auto-width":""},{default:a(()=>[A("Action")]),_:1}),(_(!0),T(H,null,L(s.cols,v=>(_(),V(M,{key:v.name,props:s},{default:a(()=>[A(y(v.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(s=>[e(E,{props:s},{default:a(()=>[e(Q,{"auto-width":""},{default:a(()=>[e(f,{flat:"",color:"orange",icon:"edit",onClick:v=>i.onClickEdit(s.row.TQUO_QUOCD),dense:""},{default:a(()=>[e(W,null,{default:a(()=>[A("Journal Edit")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(_(!0),T(H,null,L(s.cols,v=>(_(),V(Q,{key:v.name,props:s},{default:a(()=>[A(y(v.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Re as default};
