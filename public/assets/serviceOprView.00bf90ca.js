import{s as u,B as g,C as k,D as l,E as e,J as x,K as v,I as s,Q as c,aW as Q,H as d,ap as H,aY as G,R as P,aU as F,aV as A,aZ as L,aX as i,P as Y,L as B,M,O as K,o as E,aa as ee,S as le}from"./index.11f8c140.js";import{u as j,b as $,Q as J,j as N,k as r,l as w,c as ae,a as te}from"./use-dialog-plugin-component.5f9c452a.js";import{d as W}from"./date.b8c082a6.js";import{api_web as X}from"./axios.7ce08196.js";import{Q as q}from"./QTooltip.48c01921.js";import{Q as oe}from"./QBadge.89a684e0.js";const se={class:"row"},ne=s("div",{class:"col"},[s("div",{class:"text-h6"},"Update Used Item")],-1),ie={class:"col text-right"},de={__name:"serviceOprItemAdd",props:{dataItem:Array},setup(y){const{dialogRef:I,onDialogHide:D,onDialogOK:S,onDialogCancel:_}=j(),b=$(),C=y,a=u([]),n=u([]),t=u(!1),o=()=>{n.value.push({TSRVD_ID:C.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},f=(h,p,V,T)=>{p(async()=>{T==="item"&&await m(h)})},m=async h=>{t.value=!0,await X.post("item/searchAPITBL",{searchValue:h}).then(p=>{t.value=!1,a.value=p.data.data}).catch(()=>{t.value=!1})},O=()=>{S(n.value)},U=h=>{b.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${h+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{n.value.splice(h,1)})};return(h,p)=>(g(),k(K,{ref_key:"dialogRef",ref:I,onHide:M(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(x,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(v,null,{default:l(()=>[s("div",se,[ne,s("div",ie,[e(c,{icon:"add",outline:"",color:"blue",onClick:o})])])]),_:1}),e(v,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:l(()=>[e(J,{bordered:""},{default:l(()=>[n.value.length===0?Q((g(),k(N,{key:0,class:"q-my-sm",clickable:""},{default:l(()=>[e(r,null,{default:l(()=>[d(" No items added ")]),_:1})]),_:1})),[[H]]):G("",!0),(g(!0),P(F,null,A(n.value,(V,T)=>Q((g(),k(N,{key:T,class:"q-my-sm",clickable:""},{default:l(()=>[e(r,{avatar:""},{default:l(()=>[e(L,{color:"primary","text-color":"white"},{default:l(()=>[d(i(T+1),1)]),_:2},1024)]),_:2},1024),e(r,null,{default:l(()=>[e(w,null,{default:l(()=>[e(ae,{dense:"",filled:"",label:"Item Name",modelValue:V.TSRVF_ITMCD,"onUpdate:modelValue":R=>V.TSRVF_ITMCD=R,"use-input":"","input-debounce":"500",options:a.value,onFilter:p[0]||(p[0]=(R,Z,z)=>f(R,Z,z,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:t.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),e(r,null,{default:l(()=>[e(Y,{label:"Price",modelValue:V.TSRVF_PRC,"onUpdate:modelValue":R=>V.TSRVF_PRC=R,filled:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{side:""},{default:l(()=>[e(c,{icon:"delete",flat:"",color:"red",onClick:R=>U(T)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)),[[H]])),128))]),_:1})]),_:1}),e(B,{align:"right"},{default:l(()=>[e(c,{label:"OK",color:"primary",onClick:p[1]||(p[1]=V=>O()),disable:t.value,loading:t.value},null,8,["disable","loading"]),e(c,{flat:"",label:"Cancel",color:"red",onClick:M(_),loading:t.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},re={class:"text-h6"},ue={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(y){const{dialogRef:I,onDialogHide:D,onDialogOK:S,onDialogCancel:_}=j(),b=$(),C=y,a=u({SRVH_DOCNO:"",SRVH_ISSDT:W.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),n=u([]);E(async()=>{C.header&&(a.value=C.header,n.value=C.detail)});const t=o=>{b.dialog({component:de,componentProps:{dataItem:o}}).onOk(async f=>{n.value[o].listFixDet=f})};return(o,f)=>(g(),k(K,{ref_key:"dialogRef",ref:I,onHide:M(D),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(x,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(v,null,{default:l(()=>[s("div",re,"Update Order "+i(a.value.SRVH_DOCNO),1)]),_:1}),e(v,{class:"q-pa-sm"},{default:l(()=>[e(J,{bordered:""},{default:l(()=>[(g(!0),P(F,null,A(n.value,(m,O)=>Q((g(),k(N,{key:O,class:"q-my-sm",clickable:""},{default:l(()=>[e(r,{avatar:""},{default:l(()=>[e(L,{color:"primary","text-color":"white"},{default:l(()=>[d(i(m.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),e(r,null,{default:l(()=>[e(w,null,{default:l(()=>[d(i(m.TSRVD_ITMCD),1)]),_:2},1024),e(w,{caption:"",lines:"1"},{default:l(()=>[d("Item")]),_:1})]),_:2},1024),e(r,null,{default:l(()=>[e(w,null,{default:l(()=>[d(i(m.TSRVD_CUSTRMK),1)]),_:2},1024),e(w,{caption:"",lines:"1"},{default:l(()=>[d("Customer Remarks")]),_:1})]),_:2},1024),e(r,{side:""},{default:l(()=>[e(c,{icon:"construction",color:"green",flat:"",onClick:U=>t(O)},{default:l(()=>[e(q,null,{default:l(()=>[d("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(r,{side:""},{default:l(()=>[e(c,{icon:"visibility",color:"cyan",flat:"",onClick:f[0]||(f[0]=U=>o.viewAddedItem()),disable:!m.listFixDet},{default:l(()=>[e(q,null,{default:l(()=>[d("View Added Item")]),_:1}),e(oe,{color:"red",floating:""},{default:l(()=>[d(i(m.listFixDet.length),1)]),_:2},1024)]),_:2},1032,["disable"])]),_:2},1024)]),_:2},1024)),[[H]])),128))]),_:1})]),_:1}),e(B,{align:"right"},{default:l(()=>[e(c,{label:"OK",color:"primary",onClick:f[1]||(f[1]=m=>o.onSubmitData()),disable:o.loading,loading:o.loading},null,8,["disable","loading"]),e(c,{flat:"",label:"Cancel",color:"red",onClick:M(_),loading:o.loading},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},ce={class:"q-pa-md"},_e={class:"row"},fe={class:"col"},me={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},pe={class:"text-h5 text-bold"},ge={class:"text-h6 text-bold"},ve={class:"text-subtitle2"},Se={class:"text-h6 text-bold"},Ce=s("div",{class:"text-subtitle2"},"Resolved Items",-1),he={class:"row"},De={class:"col"},be=s("div",{class:"col text-right"},null,-1),ye={__name:"serviceOprView",setup(y){const I=$();u([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:a=>a.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:a=>a.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const D=u([]),S=u(""),_=u(!1);E(()=>{b()});const b=async()=>{_.value=!0,await X.post("servicesOPR/search",{searchBy:"",searchValue:S.value}).then(a=>{_.value=!1,D.value=a.data.data}).catch(a=>{_.value=!1})},C=a=>{const n={SRVH_DOCNO:a.SRVH_DOCNO,SRVH_ISSDT:W.formatDate(a.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:a.MCUS_CUSCD};let t=[];a.detail.map(o=>{t.push({TSRVD_ITMCD:o.TSRVD_ITMCD,TSRVD_LINE:o.TSRVD_LINE,TSRVD_QTY:o.TSRVD_QTY,TSRVD_CUSTRMK:o.TSRVD_CUSTRMK})}),I.dialog({component:ue,componentProps:{header:n,detail:t}}).onOk(async o=>{b()})};return(a,n)=>(g(),P("div",ce,[s("div",_e,[s("div",fe,[e(te,{grid:"",flat:"",bordered:"","card-container-class":a.cardContainerClass,title:"Outstanding Order",rows:D.value,columns:a.columns,"row-key":"name",filter:S.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":a.rowsPerPageOptions,loading:_.value},{"top-right":l(()=>[e(Y,{borderless:"",dense:"",debounce:"300",modelValue:S.value,"onUpdate:modelValue":n[0]||(n[0]=t=>S.value=t),placeholder:"Search"},{append:l(()=>[e(ee,{name:"search"})]),_:1},8,["modelValue"])]),item:l(t=>[s("div",me,[e(x,{flat:"",bordered:""},{default:l(()=>[e(v,{class:"text-center bg-secondary text-white"},{default:l(()=>[s("div",pe,i(t.row.SRVH_DOCNO),1)]),_:2},1024),e(le),e(v,null,{default:l(()=>[s("div",ge,i(t.row.MCUS_CUSNM),1),s("div",ve,i(t.row.SRVH_ISSDT),1)]),_:2},1024),e(v,null,{default:l(()=>[s("div",Se,i(t.row.resolve.length)+" of "+i(t.row.unresolve.length),1),Ce]),_:2},1024),e(v,null,{default:l(()=>[s("div",he,[s("div",De,[e(c,{label:"Resolve",color:"primary",outline:"",onClick:o=>C(t.row)},null,8,["onClick"])]),be])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{ye as default};
