import{c as te,s as g,a as ae,aQ as oe,F as ne,aD as se,h as U,g as ie,Q as D,o as K,B as w,C as x,D as t,E as e,J as A,K as I,I as m,R as H,aY as N,aW as P,H as S,ap as E,aU as j,aV as W,aZ as J,aX as b,P as $,L as X,M as q,O as Z,bb as ue,aa as re,S as de}from"./index.f83458f0.js";import{o as ce,u as z,b as B,Q as G,j as F,k as C,l as M,c as fe,a as ve}from"./use-dialog-plugin-component.750c8e96.js";import{d as ee}from"./date.99863dac.js";import{api_web as L}from"./axios.90929b37.js";import{Q as Y}from"./QTooltip.824dca8b.js";import{Q as _e}from"./QBadge.3eeff388.js";function Q(l,f=new WeakMap){if(Object(l)!==l)return l;if(f.has(l))return f.get(l);const i=l instanceof Date?new Date(l):l instanceof RegExp?new RegExp(l.source,l.flags):l instanceof Set?new Set:l instanceof Map?new Map:typeof l.constructor!="function"?Object.create(null):l.prototype!==void 0&&typeof l.prototype.constructor=="function"?l:new l.constructor;if(typeof l.constructor=="function"&&typeof l.valueOf=="function"){const n=l.valueOf();if(Object(n)!==n){const v=new l.constructor(n);return f.set(l,v),v}}return f.set(l,i),l instanceof Set?l.forEach(n=>{i.add(Q(n,f))}):l instanceof Map&&l.forEach((n,v)=>{i.set(v,Q(n,f))}),Object.assign(i,...Object.keys(l).map(n=>({[n]:Q(l[n],f)})))}var me=te({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(l,{slots:f,emit:i}){const{proxy:n}=ie(),{$q:v}=n,_=g(null),u=g(""),a=g("");let s=!1;const o=ae(()=>oe({initialValue:u.value,validate:l.validate,set:c,cancel:T,updatePosition:y},"value",()=>a.value,h=>{a.value=h}));function c(){l.validate(a.value)!==!1&&(V()===!0&&(i("save",a.value,u.value),i("update:modelValue",a.value)),r())}function T(){V()===!0&&i("cancel",a.value,u.value),r()}function y(){ne(()=>{_.value.updatePosition()})}function V(){return se(a.value,u.value)===!1}function r(){s=!0,_.value.hide()}function p(){s=!1,u.value=Q(l.modelValue),a.value=Q(l.modelValue),i("beforeShow")}function d(){i("show")}function R(){s===!1&&V()===!0&&(l.autoSave===!0&&l.validate(a.value)===!0?(i("save",a.value,u.value),i("update:modelValue",a.value)):i("cancel",a.value,u.value)),i("beforeHide")}function O(){i("hide")}function k(){const h=f.default!==void 0?[].concat(f.default(o.value)):[];return l.title&&h.unshift(U("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},l.title)),l.buttons===!0&&h.push(U("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[U(D,{flat:!0,color:l.color,label:l.labelCancel||v.lang.label.cancel,onClick:T}),U(D,{flat:!0,color:l.color,label:l.labelSet||v.lang.label.set,onClick:c})])),h}return Object.assign(n,{set:c,cancel:T,show(h){_.value!==null&&_.value.show(h)},hide(h){_.value!==null&&_.value.hide(h)},updatePosition:y}),()=>{if(l.disable!==!0)return U(ce,{ref:_,class:"q-popup-edit",cover:l.cover,onBeforeShow:p,onShow:d,onBeforeHide:R,onHide:O,onEscapeKey:T},k)}}});const pe={class:"row"},ge=m("div",{class:"col"},[m("div",{class:"text-h6"},"Update Used Item")],-1),Se={key:0,class:"col text-right"},be={__name:"serviceOprItemAdd",props:{mode:String,dataItem:Array},setup(l){const{dialogRef:f,onDialogHide:i,onDialogOK:n,onDialogCancel:v}=z(),_=B(),u=l;K(()=>{u.dataItem.listFixDet&&(s.value=u.dataItem.listFixDet)});const a=g([]),s=g([]),o=g(!1),c=()=>{s.value.push({TSRVD_ID:u.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},T=(p,d,R,O)=>{d(async()=>{O==="item"&&await y(p)})},y=async p=>{o.value=!0,await L.post("item/searchAPITBL",{searchValue:p}).then(d=>{o.value=!1,a.value=d.data.data}).catch(()=>{o.value=!1})},V=()=>{u.mode==="view"?n(s.value):_.dialog({title:"Confirmation",message:"Are you sure want to save this items ?",cancel:!0,persistent:!0}).onOk(async()=>{n(s.value)})},r=p=>{_.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${p+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{s.value.splice(p,1)})};return(p,d)=>(w(),x(Z,{ref_key:"dialogRef",ref:f,onHide:q(i),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:t(()=>[e(A,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:t(()=>[e(I,null,{default:t(()=>[m("div",pe,[ge,u.mode!=="view"?(w(),H("div",Se,[e(D,{icon:"add",outline:"",color:"blue",onClick:c})])):N("",!0)])]),_:1}),e(I,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:t(()=>[e(G,{bordered:""},{default:t(()=>[s.value.length===0?P((w(),x(F,{key:0,class:"q-my-sm",clickable:""},{default:t(()=>[e(C,null,{default:t(()=>[S(" No items added ")]),_:1})]),_:1})),[[E]]):N("",!0),(w(!0),H(j,null,W(s.value,(R,O)=>P((w(),x(F,{key:O,class:"q-my-sm",clickable:""},{default:t(()=>[e(C,{avatar:""},{default:t(()=>[e(J,{color:"primary","text-color":"white"},{default:t(()=>[S(b(O+1),1)]),_:2},1024)]),_:2},1024),e(C,null,{default:t(()=>[e(M,null,{default:t(()=>[e(fe,{dense:"",filled:"",label:"Item Name",modelValue:R.TSRVF_ITMCD,"onUpdate:modelValue":k=>R.TSRVF_ITMCD=k,"use-input":"","input-debounce":"500",options:a.value,onFilter:d[0]||(d[0]=(k,h,le)=>T(k,h,le,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:o.value,readonly:u.mode==="view"},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"])]),_:2},1024)]),_:2},1024),e(C,null,{default:t(()=>[e($,{label:"Price",modelValue:R.TSRVF_PRC,"onUpdate:modelValue":k=>R.TSRVF_PRC=k,filled:"",dense:"",readonly:u.mode==="view"},null,8,["modelValue","onUpdate:modelValue","readonly"])]),_:2},1024),l.mode!=="view"?(w(),x(C,{key:0,side:""},{default:t(()=>[e(D,{icon:"delete",flat:"",color:"red",onClick:k=>r(O)},null,8,["onClick"])]),_:2},1024)):N("",!0)]),_:2},1024)),[[E]])),128))]),_:1})]),_:1}),e(X,{align:"right"},{default:t(()=>[e(D,{label:"OK",color:"primary",onClick:d[1]||(d[1]=R=>V()),disable:o.value,loading:o.value},null,8,["disable","loading"]),e(D,{flat:"",label:"Cancel",color:"red",onClick:q(v),loading:o.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},he={class:"text-h6"},Ce={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(l){const{dialogRef:f,onDialogHide:i,onDialogOK:n,onDialogCancel:v}=z(),_=B(),u=l,a=g({SRVH_DOCNO:"",SRVH_ISSDT:ee.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),s=g([]),o=g(!1);K(async()=>{u.header&&(a.value=u.header,s.value=u.detail)});const c=(y,V="add")=>{_.dialog({component:be,componentProps:{mode:V,dataItem:s.value[y]}}).onOk(async r=>{s.value[y].listFixDet=r})},T=()=>{_.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{o.value=!0,await L.post("servicesOPR",{data:s.value}).then(y=>{o.value=!1,n()})})};return(y,V)=>(w(),x(Z,{ref_key:"dialogRef",ref:f,onHide:q(i),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:t(()=>[e(A,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:t(()=>[e(I,null,{default:t(()=>[m("div",he,"Update Order "+b(a.value.SRVH_DOCNO),1)]),_:1}),e(I,{class:"q-pa-sm"},{default:t(()=>[e(G,{bordered:""},{default:t(()=>[(w(!0),H(j,null,W(s.value,(r,p)=>P((w(),x(F,{key:p,class:"q-my-sm",clickable:""},{default:t(()=>[e(C,{avatar:""},{default:t(()=>[e(J,{color:"primary","text-color":"white"},{default:t(()=>[S(b(r.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),e(C,null,{default:t(()=>[e(M,null,{default:t(()=>[S(b(r.TSRVD_ITMCD),1)]),_:2},1024),e(M,{caption:"",lines:"1"},{default:t(()=>[S("Item")]),_:1})]),_:2},1024),e(C,null,{default:t(()=>[e(M,null,{default:t(()=>[S(b(r.TSRVD_CUSTRMK),1)]),_:2},1024),e(M,{caption:"",lines:"1"},{default:t(()=>[S("Customer Remarks")]),_:1})]),_:2},1024),e(C,null,{default:t(()=>[e(M,null,{default:t(()=>[S(b(r.TSRVD_REMARK)+" ",1),e(me,{modelValue:r.TSRVD_REMARK,"onUpdate:modelValue":d=>r.TSRVD_REMARK=d,"auto-save":""},{default:t(d=>[e($,{type:"textfield",modelValue:d.value,"onUpdate:modelValue":R=>d.value=R,dense:"",autofocus:"",counter:"",onKeyup:ue(d.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(M,{caption:"",lines:"1"},{default:t(()=>[S("Operator Remarks")]),_:1})]),_:2},1024),e(C,{side:""},{default:t(()=>[e(D,{icon:"construction",color:"green",flat:"",onClick:d=>c(p,"add")},{default:t(()=>[e(Y,null,{default:t(()=>[S("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(C,{side:""},{default:t(()=>[e(D,{icon:"visibility",color:"cyan",flat:"",onClick:d=>c(p,"view"),disable:!r.listFixDet},{default:t(()=>[e(Y,null,{default:t(()=>[S("View Added Item")]),_:1}),e(_e,{color:"red",floating:""},{default:t(()=>[S(b(r.listFixDet.length),1)]),_:2},1024)]),_:2},1032,["onClick","disable"])]),_:2},1024)]),_:2},1024)),[[E]])),128))]),_:1})]),_:1}),e(X,{align:"right"},{default:t(()=>[e(D,{label:"OK",color:"primary",onClick:V[0]||(V[0]=r=>T()),disable:o.value||s.value.filter(r=>r.listFixDet).length===0,loading:o.value},null,8,["disable","loading"]),e(D,{flat:"",label:"Cancel",color:"red",onClick:q(v),loading:o.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},De={class:"q-pa-md"},Ve={class:"row"},Re={class:"col"},we={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ye={class:"text-h5 text-bold"},Te={class:"text-h6 text-bold"},ke={class:"text-subtitle2"},Ie={class:"text-h6 text-bold"},Oe=m("div",{class:"text-subtitle2"},"Resolved Items",-1),Me={class:"row"},xe={class:"col"},Ue=m("div",{class:"col text-right"},null,-1),Fe={__name:"serviceOprView",setup(l){const f=B();g([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:a=>a.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:a=>a.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const i=g([]),n=g(""),v=g(!1);K(()=>{_()});const _=async()=>{v.value=!0,await L.post("servicesOPR/search",{searchBy:"",searchValue:n.value}).then(a=>{v.value=!1,i.value=a.data.data}).catch(a=>{v.value=!1})},u=a=>{const s={SRVH_DOCNO:a.SRVH_DOCNO,SRVH_ISSDT:ee.formatDate(a.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:a.MCUS_CUSCD};let o=[];a.detail.map(c=>{o.push({id:c.id,TSRVD_ITMCD:c.TSRVD_ITMCD,TSRVD_LINE:c.TSRVD_LINE,TSRVD_QTY:c.TSRVD_QTY,TSRVD_CUSTRMK:c.TSRVD_CUSTRMK,TSRVD_REMARK:c.TSRVD_REMARK})}),f.dialog({component:Ce,componentProps:{header:s,detail:o}}).onOk(async c=>{_()})};return(a,s)=>(w(),H("div",De,[m("div",Ve,[m("div",Re,[e(ve,{grid:"",flat:"",bordered:"","card-container-class":a.cardContainerClass,title:"Outstanding Order",rows:i.value,columns:a.columns,"row-key":"name",filter:n.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":a.rowsPerPageOptions,loading:v.value},{"top-right":t(()=>[e($,{borderless:"",dense:"",debounce:"300",modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=o=>n.value=o),placeholder:"Search"},{append:t(()=>[e(re,{name:"search"})]),_:1},8,["modelValue"])]),item:t(o=>[m("div",we,[e(A,{flat:"",bordered:""},{default:t(()=>[e(I,{class:"text-center bg-secondary text-white"},{default:t(()=>[m("div",ye,b(o.row.SRVH_DOCNO),1)]),_:2},1024),e(de),e(I,null,{default:t(()=>[m("div",Te,b(o.row.MCUS_CUSNM),1),m("div",ke,b(o.row.SRVH_ISSDT),1)]),_:2},1024),e(I,null,{default:t(()=>[m("div",Ie,b(o.row.resolve.length)+" of "+b(o.row.unresolve.length),1),Oe]),_:2},1024),e(I,null,{default:t(()=>[m("div",Me,[m("div",xe,[e(D,{label:"Resolve",color:"primary",outline:"",onClick:c=>u(o.row)},null,8,["onClick"])]),Ue])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{Fe as default};
