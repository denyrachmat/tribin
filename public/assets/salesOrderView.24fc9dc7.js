import{Q as h}from"./QTooltip.c6ef471d.js";import{s as r,B as m,C as g,D as l,E as e,L as j,M as k,I as o,Z as b,am as w,T as V,Q as S,O as u,P as A,R as P,S as y,U as X,H as i,V as K,X as Z,Y as z,o as J,aX as W}from"./index.2545a5bc.js";import{a as x,u as ee,l as B,Q as le,b as I,c as O,d as f,k as ae,m as R}from"./QTable.af8c6e7e.js";import{Q as M,a as q}from"./QTd.b7b8d6d0.js";import{api_web as F,api as te}from"./axios.8698ff49.js";import{Q as N,a as Y,C as $}from"./ClosePopup.d6512390.js";import"./use-cache.b0833c75.js";import"./date.85980ba0.js";const oe=o("div",{class:"text-h6"},"RO Maintenance",-1),se={style:{border:"1px black solid","border-radius":"10px"}},ne=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),de={class:"row"},ie={class:"col"},ue={class:"col q-pl-md"},re={class:"row items-center justify-end"},_e={class:"col q-pl-md"},ce={class:"row items-center justify-end"},Te={class:"row"},me={class:"col"},De={class:"col q-pl-md"},Oe={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},fe=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Detail Items")],-1),Se={class:"row q-pb-md"},ve={class:"col"},pe={class:"text-h6"},Ce={class:"col text-right"},Le={class:"row"},Qe={class:"col"},be={__name:"salesOrderCreate",setup(H){x();const n=r({TSLO_SLOCD:"",TSLO_ISSUDT:"",TSLO_PLAN_DLVDT:"",TSLO_QUOCD:"",TSLO_POCD:""});r(""),r("");const v=r([]),d=r(!1),Q=r(1),p=r([]),C=(T,t,a,L)=>{t(async()=>{L==="quotation"&&await U(T)})},U=async(T="")=>{d.value=!0,await F.post("quotation/search",{searchBy:"MCUS_CUSNM",searchValue:T}).then(t=>{d.value=!1,v.value=t.data.data}).catch(t=>{d.value=!1})},E=()=>Q.value===1?"Rental":Q.value===2?"Sales":"Service",_=async T=>{console.log(T),d.value=!0,await te.get(`transaction/quotation/view/${btoa(T)}`).then(t=>{d.value=!1,t.data.data.det.map(a=>{p.value.push({TSLODETA_ITMCD:a.TQUODETA_ITMCD,TSLODETA_ITMQT:a.TQUODETA_ITMQT,TSLODETA_USAGE:a.TQUODETA_USAGE,TSLODETA_PRC:a.TQUODETA_PRC,TSLODETA_PERIOD_FR:a.TQUODETA_PERIOD_FR,TSLODETA_PERIOD_TO:a.TQUODETA_PERIOD_TO})})}).catch(t=>{d.value=!1})},D=()=>{p.value.push({TSLODETA_ITMCD:"",TSLODETA_ITMQT:"",TSLODETA_USAGE:"",TSLODETA_PRC:0,TSLODETA_PERIOD_FR:"",TSLODETA_PERIOD_TO:""})},{dialogRef:s,onDialogHide:c,onDialogOK:we,onDialogCancel:Pe}=ee();return(T,t)=>(m(),g(z,{ref_key:"dialogRef",ref:s,onHide:Z(c),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(j,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(k,null,{default:l(()=>[oe]),_:1}),e(k,{class:"q-pa-sm"},{default:l(()=>[o("fieldset",se,[ne,o("div",de,[o("div",ie,[e(b,{label:"RO Code",dense:"",filled:"",modelValue:n.value.TSLO_SLOCD,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value.TSLO_SLOCD=a),disable:"",loading:d.value},null,8,["modelValue","loading"])]),o("div",ue,[e(b,{filled:"",modelValue:n.value.TSLO_ISSUDT,"onUpdate:modelValue":t[2]||(t[2]=a=>n.value.TSLO_ISSUDT=a),dense:"",label:"Issue Date",loading:d.value,onClick:t[3]||(t[3]=a=>T.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(w,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(Y,{modelValue:n.value.TSLO_ISSUDT,"onUpdate:modelValue":t[1]||(t[1]=a=>n.value.TSLO_ISSUDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",re,[V(e(S,{label:"Close",color:"primary",flat:""},null,512),[[$]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])]),o("div",_e,[e(b,{filled:"",modelValue:n.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":t[5]||(t[5]=a=>n.value.TSLO_PLAN_DLVDT=a),dense:"",label:"Delivery Date",loading:d.value,onClick:t[6]||(t[6]=a=>T.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(w,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(N,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(Y,{modelValue:n.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":t[4]||(t[4]=a=>n.value.TSLO_PLAN_DLVDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",ce,[V(e(S,{label:"Close",color:"primary",flat:""},null,512),[[$]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),o("div",Te,[o("div",me,[e(B,{dense:"",filled:"",label:"Sales Quotation Code",modelValue:n.value.TSLO_QUOCD,"onUpdate:modelValue":[t[7]||(t[7]=a=>n.value.TSLO_QUOCD=a),_],"use-input":"","input-debounce":"500",options:v.value,onFilter:t[8]||(t[8]=(a,L,G)=>C(a,L,G,"quotation")),behavior:"dialog","option-label":"DESCSEL","option-value":"TQUO_QUOCD","emit-value":"","map-options":"",loading:d.value},null,8,["modelValue","options","loading"])]),o("div",De,[e(b,{label:"PO Number",dense:"",filled:"",modelValue:n.value.TSLO_POCD,"onUpdate:modelValue":t[9]||(t[9]=a=>n.value.TSLO_POCD=a),loading:d.value},null,8,["modelValue","loading"])])])]),o("fieldset",Oe,[fe,o("div",Se,[o("div",ve,[o("span",pe,u(E()),1)]),o("div",Ce,[e(S,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:D,loading:d.value},null,8,["loading"])])]),o("div",Le,[o("div",Qe,[e(le,{bordered:"",dense:""},{default:l(()=>[T.listSavedItems.length>0?(m(!0),A(P,{key:0},y(p.value,(a,L)=>(m(),g(I,{key:L,class:"q-my-sm",dense:""},{default:l(()=>[e(O,{avatar:""},{default:l(()=>[e(X,{"text-color":"blue"},{default:l(()=>[i(u(L+1),1)]),_:2},1024)]),_:2},1024),e(O,null,{default:l(()=>[e(f,null,{default:l(()=>[i(u(a.TSLODETA_ITMCD),1)]),_:2},1024)]),_:2},1024),e(O,null,{default:l(()=>[e(f,null,{default:l(()=>[i(u(a.TSLODETA_ITMQT),1)]),_:2},1024)]),_:2},1024),e(O,null,{default:l(()=>[e(f,null,{default:l(()=>[i(u(a.TSLODETA_USAGE),1)]),_:2},1024)]),_:2},1024),e(O,null,{default:l(()=>[e(f,null,{default:l(()=>[i(u(a.TSLODETA_PRC),1)]),_:2},1024)]),_:2},1024),e(O,null,{default:l(()=>[e(f,null,{default:l(()=>[i(u(a.TSLODETA_PERIOD_FR),1)]),_:2},1024)]),_:2},1024),e(O,null,{default:l(()=>[e(f,null,{default:l(()=>[i(u(a.TSLODETA_PERIOD_TO),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):V((m(),g(I,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(O,null,{default:l(()=>[e(f,null,{default:l(()=>[i(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[K]])]),_:1})])])])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const ge={class:"q-pa-md"},Ue={class:"row q-pb-md"},he=o("div",{class:"col"},[o("span",{class:"text-h4"},"Sales Order / Receive Order")],-1),Ae={class:"col text-right"},Ee={class:"row q-pt-md"},Ve={class:"col"},$e={__name:"salesOrderView",setup(H){const n=x(),v=r("TQUO_QUOCD"),d=r(""),Q=r([]),p=r([{name:"TSLO_SLOCD",label:"RO. Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_ADDRESS_NAME",label:"Customer Addr.",field:"TSLO_ADDRESS_NAME",sortable:!0,align:"left"},{name:"TSLO_CUSCD",label:"Customer Code",field:"TSLO_CUSCD",sortable:!0,align:"left"},{name:"TSLO_ISSUDT",label:"Issue Date",field:"TSLO_ISSUDT",sortable:!0,align:"left"},{name:"TSLO_QUOCD",label:"Quot. Code",field:"TSLO_QUOCD",sortable:!0,align:"left"}]),C=r(!1);J(()=>{U()});const U=async()=>{C.value=!0,await F.post("receive-order/searchAPI",{searchBy:v.value,searchValue:d.value}).then(_=>{C.value=!1,Q.value=_.data.data}).catch(_=>{C.value=!1})},E=()=>{n.dialog({component:be}).onOk(async _=>{U()})};return(_,D)=>(m(),A("div",ge,[o("div",Ue,[he,o("div",Ae,[e(S,{icon:"add",color:"blue",onClick:E},{default:l(()=>[e(h,null,{default:l(()=>[i("Create New RO")]),_:1})]),_:1})])]),e(W),o("div",Ee,[o("div",Ve,[e(ae,{title:"Created RO",rows:Q.value,columns:p.value,"row-key":"name",loading:C.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(B,{outlined:"",modelValue:v.value,"onUpdate:modelValue":D[0]||(D[0]=s=>v.value=s),options:p.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(b,{borderless:"",dense:"",modelValue:d.value,"onUpdate:modelValue":[D[1]||(D[1]=s=>d.value=s),D[2]||(D[2]=s=>_.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(w,{name:"search"})]),_:1},8,["modelValue"])]),header:l(s=>[e(M,{props:s},{default:l(()=>[e(R,{"auto-width":""},{default:l(()=>[i("Action")]),_:1}),(m(!0),A(P,null,y(s.cols,c=>(m(),g(R,{key:c.name,props:s},{default:l(()=>[i(u(c.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(s=>[e(M,{props:s},{default:l(()=>[e(q,{"auto-width":""},{default:l(()=>[e(S,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"orange",icon:"edit",onClick:c=>_.onClickEdit(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(h,null,{default:l(()=>[i(u(s.row.TQUO_APPRVDT?"Quotation already approved, cannot edit !":"Edit this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(S,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"red",icon:"delete",onClick:c=>_.onClickDelete(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(h,null,{default:l(()=>[i(u(s.row.TQUO_APPRVDT?"Quotation already approved, cannot delete !":"Delete this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(S,{flat:"",color:"indigo",icon:"print",onClick:c=>_.onClickPrint(s.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(h,null,{default:l(()=>[i("Print this quotation")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(m(!0),A(P,null,y(s.cols,c=>(m(),g(q,{key:c.name,props:s},{default:l(()=>[i(u(c.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{$e as default};
