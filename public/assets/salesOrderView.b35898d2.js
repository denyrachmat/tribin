import{Q as I}from"./QTooltip.729bed62.js";import{t as _,C as p,D as A,E as l,F as e,M as oe,O as N,J as t,$ as T,an as Q,U as b,Q as c,P as g,R as k,S as R,T as M,V as te,I as r,W as ne,X as se,Y as q,Z as de,o as ie,aY as ue}from"./index.93c02276.js";import{a as j,u as re,l as Y,Q as _e,b as F,c as f,d as m,k as me,m as x}from"./QTable.05397dbd.js";import{Q as B,a as G}from"./QTd.16b32639.js";import{api_web as $,api as ce}from"./axios.9ee71b09.js";import{Q as P,a as y,C as w}from"./ClosePopup.e3fc9db4.js";import"./use-render-cache.3aae9b27.js";import"./date.41d34784.js";const Te=t("div",{class:"text-h6"},"RO Maintenance",-1),De={style:{border:"1px black solid","border-radius":"10px"}},Oe=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Header")],-1),fe={class:"row"},pe={class:"col"},ve={class:"col q-pl-md"},Se={class:"row items-center justify-end"},Ce={class:"col q-pl-md"},Ve={class:"row items-center justify-end"},Le={class:"row"},ge={class:"col"},Ue={class:"col q-pl-md"},be={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Qe=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Detail Items")],-1),Ae={class:"row q-pb-md"},Ee={class:"col"},he={class:"text-h6"},Ie={class:"col text-right"},Pe={class:"row"},ye={class:"col"},we={class:"row items-center justify-end"},ke={class:"row items-center justify-end"},Re={__name:"salesOrderCreate",setup(H){const E=j(),i=_({TSLO_SLOCD:"",TSLO_ISSUDT:"",TSLO_PLAN_DLVDT:"",TSLO_QUOCD:"",TSLO_POCD:""});_(""),_("");const L=_([]),U=_([]),d=_(!1),V=_(1),v=_([]);_({decimal:".",thousands:",",prefix:"$ ",suffix:" #",precision:2});const h=(u,o,a,C)=>{o(async()=>{C==="quotation"&&await D(u),C==="item"&&await S(u)})},D=async(u="")=>{d.value=!0,await $.post("quotation/search",{searchBy:"MCUS_CUSNM",searchValue:u}).then(o=>{d.value=!1,L.value=o.data.data}).catch(o=>{d.value=!1})},S=async u=>{d.value=!0,await $.post("item/searchAPI",{searchValue:u}).then(o=>{d.value=!1,U.value=o.data.data}).catch(()=>{d.value=!1})},s=()=>V.value===1?"Rental":V.value===2?"Sales":"Service",O=async u=>{console.log(u),d.value=!0,await ce.get(`transaction/quotation/view/${btoa(u)}`).then(o=>{d.value=!1,o.data.data.det.map(a=>{v.value.push({TSLODETA_ITMCD:a.TQUODETA_ITMCD,TSLODETA_ITMQT:a.TQUODETA_ITMQT,TSLODETA_USAGE:a.TQUODETA_USAGE,TSLODETA_PRC:a.TQUODETA_PRC,TSLODETA_PERIOD_FR:a.TQUODETA_PERIOD_FR,TSLODETA_PERIOD_TO:a.TQUODETA_PERIOD_TO})})}).catch(o=>{d.value=!1})},K=()=>{v.value.push({TSLODETA_ITMCD:"",TSLODETA_ITMQT:"",TSLODETA_USAGE:"",TSLODETA_PRC:0,TSLODETA_PERIOD_FR:"",TSLODETA_PERIOD_TO:""})},J=u=>{E.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${u+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{v.value.splice(u,1)})},W=()=>{E.dialog({title:"Confirmation",message:"Are you sure want to save this RO ?",cancel:!0,persistent:!0}).onOk(async()=>{z()})},{dialogRef:X,onDialogHide:Z,onDialogOK:z,onDialogCancel:ee}=re();return(u,o)=>(p(),A(de,{ref_key:"dialogRef",ref:X,onHide:q(Z),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(oe,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(N,null,{default:l(()=>[Te]),_:1}),e(N,{class:"q-pa-sm"},{default:l(()=>[t("fieldset",De,[Oe,t("div",fe,[t("div",pe,[e(T,{label:"RO Code",dense:"",filled:"",modelValue:i.value.TSLO_SLOCD,"onUpdate:modelValue":o[0]||(o[0]=a=>i.value.TSLO_SLOCD=a),disable:"",loading:d.value},null,8,["modelValue","loading"])]),t("div",ve,[e(T,{filled:"",modelValue:i.value.TSLO_ISSUDT,"onUpdate:modelValue":o[2]||(o[2]=a=>i.value.TSLO_ISSUDT=a),dense:"",label:"Issue Date",loading:d.value,onClick:o[3]||(o[3]=a=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(y,{modelValue:i.value.TSLO_ISSUDT,"onUpdate:modelValue":o[1]||(o[1]=a=>i.value.TSLO_ISSUDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Se,[b(e(c,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])]),t("div",Ce,[e(T,{filled:"",modelValue:i.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":o[5]||(o[5]=a=>i.value.TSLO_PLAN_DLVDT=a),dense:"",label:"Delivery Date",loading:d.value,onClick:o[6]||(o[6]=a=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(y,{modelValue:i.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":o[4]||(o[4]=a=>i.value.TSLO_PLAN_DLVDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Ve,[b(e(c,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),t("div",Le,[t("div",ge,[e(Y,{dense:"",filled:"",label:"Sales Quotation Code",modelValue:i.value.TSLO_QUOCD,"onUpdate:modelValue":[o[7]||(o[7]=a=>i.value.TSLO_QUOCD=a),O],"use-input":"","input-debounce":"500",options:L.value,onFilter:o[8]||(o[8]=(a,C,n)=>h(a,C,n,"quotation")),behavior:"dialog","option-label":"DESCSEL","option-value":"TQUO_QUOCD","emit-value":"","map-options":"",loading:d.value},null,8,["modelValue","options","loading"])]),t("div",Ue,[e(T,{label:"PO Number",dense:"",filled:"",modelValue:i.value.TSLO_POCD,"onUpdate:modelValue":o[9]||(o[9]=a=>i.value.TSLO_POCD=a),loading:d.value},null,8,["modelValue","loading"])])])]),t("fieldset",be,[Qe,t("div",Ae,[t("div",Ee,[t("span",he,g(s()),1)]),t("div",Ie,[e(c,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:K,loading:d.value},null,8,["loading"])])]),t("div",Pe,[t("div",ye,[e(_e,{bordered:"",dense:""},{default:l(()=>[v.value.length>0?(p(!0),k(R,{key:0},M(v.value,(a,C)=>(p(),A(F,{key:C,class:"q-my-sm",dense:""},{default:l(()=>[e(f,{avatar:""},{default:l(()=>[e(te,{"text-color":"blue"},{default:l(()=>[r(g(C+1),1)]),_:2},1024)]),_:2},1024),e(f,null,{default:l(()=>[e(m,{class:"text-center"},{default:l(()=>[e(T,{modelValue:a.TSLODETA_ITMCD,"onUpdate:modelValue":n=>a.TSLODETA_ITMCD=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"]),e(Y,{dense:"",filled:"",label:"Item Name",modelValue:a.TSLODETA_ITMCD,"onUpdate:modelValue":n=>a.TSLODETA_ITMCD=n,"use-input":"","input-debounce":"500",options:U.value,onFilter:o[10]||(o[10]=(n,le,ae)=>h(n,le,ae,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:d.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024),e(m,{caption:""},{default:l(()=>[r(" Item Name ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(m,null,{default:l(()=>[e(T,{modelValue:a.TSLODETA_ITMQT,"onUpdate:modelValue":n=>a.TSLODETA_ITMQT=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(m,{caption:""},{default:l(()=>[r(" Qty ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(m,null,{default:l(()=>[e(T,{modelValue:a.TSLODETA_USAGE,"onUpdate:modelValue":n=>a.TSLODETA_USAGE=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(m,{caption:""},{default:l(()=>[r(" Usage ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(m,null,{default:l(()=>[e(T,{modelValue:a.TSLODETA_PRC,"onUpdate:modelValue":n=>a.TSLODETA_PRC=n,readonly:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(m,{caption:""},{default:l(()=>[r(" Price ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(m,null,{default:l(()=>[e(T,{filled:"",modelValue:a.TSLODETA_PERIOD_FROM,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_FROM=n,dense:"",loading:d.value,onClick:o[11]||(o[11]=n=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":""},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(y,{modelValue:a.TSLODETA_PERIOD_FROM,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_FROM=n,mask:"YYYY-MM-DD"},{default:l(()=>[t("div",we,[b(e(c,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","loading"])]),_:2},1024),e(m,{caption:""},{default:l(()=>[r(" Period From ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(m,null,{default:l(()=>[e(T,{filled:"",modelValue:a.TSLODETA_PERIOD_TO,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_TO=n,dense:"",loading:d.value,onClick:o[12]||(o[12]=n=>u.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":""},{append:l(()=>[e(Q,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(y,{modelValue:a.TSLODETA_PERIOD_TO,"onUpdate:modelValue":n=>a.TSLODETA_PERIOD_TO=n,mask:"YYYY-MM-DD"},{default:l(()=>[t("div",ke,[b(e(c,{label:"Close",color:"primary",flat:""},null,512),[[w]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","loading"])]),_:2},1024),e(m,{caption:""},{default:l(()=>[r(" Period To ")]),_:1})]),_:2},1024),e(f,{side:""},{default:l(()=>[e(c,{icon:"delete",color:"red",flat:"",onClick:n=>J(C)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)):b((p(),A(F,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(f,null,{default:l(()=>[e(m,null,{default:l(()=>[r(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[ne]])]),_:1})])])])]),_:1}),e(se,{align:"right"},{default:l(()=>[e(c,{label:"OK",color:"primary",onClick:o[13]||(o[13]=a=>W()),disable:u.stateSubmit,loading:d.value},null,8,["disable","loading"]),e(c,{flat:"",label:"Cancel",color:"red",onClick:q(ee)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const Me={class:"q-pa-md"},Ye={class:"row q-pb-md"},$e=t("div",{class:"col"},[t("span",{class:"text-h4"},"Sales Order / Receive Order")],-1),Ne={class:"col text-right"},qe={class:"row q-pt-md"},Fe={class:"col"},Xe={__name:"salesOrderView",setup(H){const E=j(),i=_("TQUO_QUOCD"),L=_(""),U=_([]),d=_([{name:"TSLO_SLOCD",label:"RO. Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_ADDRESS_NAME",label:"Customer Addr.",field:"TSLO_ADDRESS_NAME",sortable:!0,align:"left"},{name:"TSLO_CUSCD",label:"Customer Code",field:"TSLO_CUSCD",sortable:!0,align:"left"},{name:"TSLO_ISSUDT",label:"Issue Date",field:"TSLO_ISSUDT",sortable:!0,align:"left"},{name:"TSLO_QUOCD",label:"Quot. Code",field:"TSLO_QUOCD",sortable:!0,align:"left"}]),V=_(!1);ie(()=>{v()});const v=async()=>{V.value=!0,await $.post("receive-order/searchAPI",{searchBy:i.value,searchValue:L.value}).then(D=>{V.value=!1,U.value=D.data.data}).catch(D=>{V.value=!1})},h=()=>{E.dialog({component:Re}).onOk(async D=>{v()})};return(D,S)=>(p(),k("div",Me,[t("div",Ye,[$e,t("div",Ne,[e(c,{icon:"add",color:"blue",onClick:h},{default:l(()=>[e(I,null,{default:l(()=>[r("Create New RO")]),_:1})]),_:1})])]),e(ue),t("div",qe,[t("div",Fe,[e(me,{title:"Created RO",rows:U.value,columns:d.value,"row-key":"name",loading:V.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(Y,{outlined:"",modelValue:i.value,"onUpdate:modelValue":S[0]||(S[0]=s=>i.value=s),options:d.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(T,{borderless:"",dense:"",modelValue:L.value,"onUpdate:modelValue":[S[1]||(S[1]=s=>L.value=s),S[2]||(S[2]=s=>D.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(Q,{name:"search"})]),_:1},8,["modelValue"])]),header:l(s=>[e(B,{props:s},{default:l(()=>[e(x,{"auto-width":""},{default:l(()=>[r("Action")]),_:1}),(p(!0),k(R,null,M(s.cols,O=>(p(),A(x,{key:O.name,props:s},{default:l(()=>[r(g(O.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(s=>[e(B,{props:s},{default:l(()=>[e(G,{"auto-width":""},{default:l(()=>[e(c,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"orange",icon:"edit",onClick:O=>D.onClickEdit(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(I,null,{default:l(()=>[r(g(s.row.TQUO_APPRVDT?"Quotation already approved, cannot edit !":"Edit this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(c,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"red",icon:"delete",onClick:O=>D.onClickDelete(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(I,null,{default:l(()=>[r(g(s.row.TQUO_APPRVDT?"Quotation already approved, cannot delete !":"Delete this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(c,{flat:"",color:"indigo",icon:"print",onClick:O=>D.onClickPrint(s.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(I,null,{default:l(()=>[r("Print this quotation")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(p(!0),k(R,null,M(s.cols,O=>(p(),A(G,{key:O.name,props:s},{default:l(()=>[r(g(O.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Xe as default};
