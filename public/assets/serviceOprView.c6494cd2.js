import{s as n,o as v,B as D,R as g,I as a,E as l,D as o,P as C,aa as V,J as b,K as _,ba as w,aX as r,S as T,Q as p}from"./index.a98e900f.js";import{b as O,a as x}from"./use-dialog-plugin-component.3206c174.js";import{d as I}from"./date.75c1eede.js";import{api_web as N}from"./axios.690689c6.js";import{_ as U}from"./serviceOprUpdateOrder.1e57ba11.js";import"./QTooltip.f1ee70c7.js";import"./QBadge.41fa7ba6.js";const H={class:"q-pa-md"},Q={class:"row"},M={class:"col"},P={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},k={class:"text-h5 text-bold"},y={class:"text-h6 text-bold"},B={class:"text-subtitle2"},E={class:"text-h6 text-bold"},K=a("div",{class:"text-subtitle2"},"Resolved Items",-1),L={class:"row"},Y={class:"col"},$=a("div",{class:"col text-right"},null,-1),W={__name:"serviceOprView",setup(q){const h=O();n([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:e=>e.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:e=>e.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const m=n([]),i=n(""),d=n(!1),f=n(null);v(()=>{S(),f.value=setInterval(()=>{S()},1e4)});const S=async()=>{d.value=!0,await N.post("servicesOPR/search",{searchBy:"",searchValue:i.value}).then(e=>{d.value=!1,m.value=e.data.data}).catch(e=>{d.value=!1})},R=(e,c)=>{const t={SRVH_DOCNO:e.SRVH_DOCNO,SRVH_ISSDT:I.formatDate(e.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:e.MCUS_CUSCD};let u=[];e.detail.map(s=>{u.push({id:s.id,TSRVD_ITMCD:s.TSRVD_ITMCD,TSRVD_FLGSTS:s.TSRVD_FLGSTS,TSRVD_LINE:s.TSRVD_LINE,TSRVD_QTY:s.TSRVD_QTY,TSRVD_CUSTRMK:s.TSRVD_CUSTRMK,TSRVD_REMARK:s.TSRVD_REMARK,listFixDet:s.list_fix_det})}),h.dialog({component:U,componentProps:{header:t,detail:u,mode:c}}).onOk(async s=>{S()})};return(e,c)=>(D(),g("div",H,[a("div",Q,[a("div",M,[l(x,{grid:"",flat:"",bordered:"","card-container-class":e.cardContainerClass,title:"Outstanding Order",rows:m.value,columns:e.columns,"row-key":"name",filter:i.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":e.rowsPerPageOptions,loading:d.value},{"top-right":o(()=>[l(C,{borderless:"",dense:"",debounce:"300",modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=t=>i.value=t),placeholder:"Search"},{append:o(()=>[l(V,{name:"search"})]),_:1},8,["modelValue"])]),item:o(t=>[a("div",P,[l(b,{flat:"",bordered:""},{default:o(()=>[l(_,{class:w(`text-center ${t.row.resolve.length==t.row.detail.length?"bg-indigo ":"bg-secondary "}text-white`)},{default:o(()=>[a("div",k,r(t.row.SRVH_DOCNO),1)]),_:2},1032,["class"]),l(T),l(_,null,{default:o(()=>[a("div",y,r(t.row.MCUS_CUSNM),1),a("div",B,r(t.row.SRVH_ISSDT),1)]),_:2},1024),l(_,null,{default:o(()=>[a("div",E,r(t.row.resolve.length)+" of "+r(t.row.detail.length),1),K]),_:2},1024),l(_,null,{default:o(()=>[a("div",L,[a("div",Y,[l(p,{label:"Resolve",color:"primary",outline:"",onClick:u=>R(t.row,t.row.resolve.length==t.row.detail.length?"approve":"edit")},null,8,["onClick"])]),$])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{W as default};
