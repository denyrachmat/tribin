import{Q as $}from"./QTooltip.addb829a.js";import{t as u,o as K,C as _,D as y,E as l,F as e,M as W,O as N,J as t,$ as w,at as F,R,S as Q,T as A,I as D,P as U,X,Q as C,Y as H,Z,U as G,a0 as ve,V as _e,W as fe,aY as De}from"./index.2cf40be4.js";import{c as P,Q as J,a as M,b as I}from"./QSelect.82ad6011.js";import{Q as ee,a as E}from"./QTable.b4fac47c.js";import{Q as q,a as B}from"./QTd.35ae6d3f.js";import{api_web as k}from"./axios.e347c637.js";import{u as Y}from"./format.801e1cf6.js";import{Q as ge,a as Ce}from"./QInnerLoading.27a2b11d.js";import{Q as Ve,a as be,C as he}from"./ClosePopup.2f353f80.js";import{Q as Se}from"./QList.6f6344b5.js";import{u as le}from"./use-dialog-plugin-component.2e02fa5a.js";import"./use-render-cache.3aae9b27.js";import"./date.5e3714df.js";const Le=t("div",{class:"text-h6"},"Sales Order Choose",-1),Oe={class:"row"},Te={class:"col"},ye={__name:"salesOrderChoose",setup(x){Y();const V=u([]),c=u([{name:"TSLO_SLOCD",label:"Sales Ord Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_PLAN_DLVDT",label:"DLV Plan Date",field:"TSLO_PLAN_DLVDT",sortable:!0,align:"left"}]),s=u(!1),p=u(""),b=u("");K(()=>{h()});const h=async()=>{s.value=!0,await k.post("delivery/outstanding-warehouse-api",{searchBy:p.value,searchValue:b.value}).then(n=>{s.value=!1,V.value=n.data.data}).catch(n=>{s.value=!1})},f=n=>{v(n)},{dialogRef:g,onDialogHide:L,onDialogOK:v,onDialogCancel:i}=le();return(n,m)=>(_(),y(Z,{ref_key:"dialogRef",ref:g,onHide:H(L),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(W,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(N,null,{default:l(()=>[Le]),_:1}),e(N,{class:"q-pa-sm"},{default:l(()=>[t("div",Oe,[t("div",Te,[e(ee,{title:"Outgoing List",rows:V.value,columns:c.value,"row-key":"TDLVORD_DLVCD",loading:s.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(P,{outlined:"",modelValue:p.value,"onUpdate:modelValue":m[0]||(m[0]=r=>p.value=r),options:c.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(w,{borderless:"",dense:"",modelValue:b.value,"onUpdate:modelValue":[m[1]||(m[1]=r=>b.value=r),m[2]||(m[2]=r=>n.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),header:l(r=>[e(q,{props:r},{default:l(()=>[(_(!0),R(Q,null,A(r.cols,S=>(_(),y(E,{key:S.name,props:r},{default:l(()=>[D(U(S.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(r=>[e(q,{props:r,onClick:S=>f(r.row)},{default:l(()=>[(_(!0),R(Q,null,A(r.cols,S=>(_(),y(B,{key:S.name,props:r},{default:l(()=>[D(U(S.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props","onClick"])]),_:1},8,["rows","columns","loading"])])])]),_:1}),e(X,{align:"right"},{default:l(()=>[e(C,{flat:"",label:"Cancel",color:"red",onClick:H(i)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},we=t("div",{class:"text-h6"},"Create Outgoing Delivery",-1),ke={style:{border:"1px black solid","border-radius":"10px"}},Me=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Header")],-1),Re={class:"row"},Ue={class:"col"},Ie={class:"col q-pl-md"},Qe={class:"row items-center justify-end"},Ae={class:"row q-pt-md"},$e={class:"col"},Ne={class:"col q-pl-md"},He={class:"row q-pt-md"},Pe={class:"col"},qe={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},xe=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"List Of Items")],-1),Ee={class:"row"},Be={class:"col"},Ke={class:"colq-pb-sm text-right"},Fe={__name:"outgoingCreate",props:{dataHeader:Array},setup(x){const V=Y(),c=x;K(async()=>{await j(c.dataHeader.TDLVORD_CUSCD),Object.values(c.dataHeader).length>0&&(console.log(c.dataHeader),p.value=c.dataHeader.TDLVORD_DLVCD,b.value=c.dataHeader.TDLVORD_INVCD,h.value=c.dataHeader.TDLVORD_CUSCD,f.value=c.dataHeader.TDLVORD_ISSUDT,g.value=c.dataHeader.TDLVORDDETA_SLOCD,L.value=c.dataHeader.MCUS_CUSNM,v.value=c.dataHeader.TDLVORD_REMARK,i.value=c.dataHeader.listItems)});const s=u(!1),p=u(""),b=u(""),h=u(""),f=u(""),g=u(""),L=u(""),v=u(""),i=u([]),n=u([]),m=u([]),r=u(!1),S=(d,a,o,O)=>{a(async()=>{O==="cust"&&j(d),O==="item"&&await de(d)})},j=async(d,a="MCUS_CUSNM")=>{s.value=!0,await k.post("customer/searchAPI",{searchValue:d,searchCol:a}).then(o=>{s.value=!1,n.value=o.data.data}).catch(()=>{s.value=!1})},ae=()=>{V.dialog({title:"Confirmation",message:`Are you sure want to save this outgoing ? ${r.value?"Split invoice has been checked, this will splitting your item to different invoice.":null}`,cancel:!0,persistent:!0}).onOk(async()=>{if(r.value)for(let d=0;d<i.value.length;d++)await z([i.value[d]]);else z()})},z=async(d=[])=>(s.value=!0,await k.post("delivery",{TDLVORD_DLVCD:p.value,TDLVORD_CUSCD:h.value,TDLVORD_ISSUDT:f.value,TDLVORDDETA_SLOCD:g.value,TDLVORD_REMARK:v.value,SO_DET:d.length>0?d:i.value,splitInvoice:r.value}).then(a=>{s.value=!1,re()}).catch(a=>{s.value=!1})),te=()=>{V.dialog({component:ye}).onOk(async d=>{g.value=d.TSLO_SLOCD,L.value=d.MCUS_CUSNM,h.value=d.TSLO_CUSCD,oe(d.TSLO_SLOCD)})},oe=async d=>{s.value=!0,await k.get(`delivery/outstanding-warehouse/${btoa(d)}`).then(a=>{s.value=!1,i.value=a.data.data}).catch(a=>{s.value=!1})},se=d=>{V.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${d+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{i.value.splice(d,1)})},ne=()=>{i.value.push({MITM_ITMNM:"",BALQT:0,TSLODETA_PRC:0})},de=async d=>{s.value=!0,await k.post("item/searchAPINameOnly",{searchValue:d}).then(a=>{s.value=!1,m.value=a.data.data}).catch(()=>{s.value=!1})},{dialogRef:ie,onDialogHide:ue,onDialogOK:re,onDialogCancel:ce}=le();return(d,a)=>(_(),y(Z,{ref_key:"dialogRef",ref:ie,onHide:H(ue),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(W,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(N,null,{default:l(()=>[we]),_:1}),e(N,{class:"q-pa-sm"},{default:l(()=>[t("fieldset",ke,[Me,e(ge,{showing:s.value,dark:""},{default:l(()=>[e(Ce,{size:"50px",color:"primary"})]),_:1},8,["showing"]),t("div",Re,[t("div",Ue,[e(w,{label:"Code",readonly:"",dense:"",filled:"",modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=o=>p.value=o)},null,8,["modelValue"])]),t("div",Ie,[e(w,{filled:"",modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=o=>f.value=o),dense:"",label:"Issue Date"},{append:l(()=>[e(F,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(Ve,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(be,{modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=o=>f.value=o),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",Qe,[G(e(C,{label:"Close",color:"primary",flat:""},null,512),[[he]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),t("div",Ae,[t("div",$e,[e(w,{modelValue:g.value,"onUpdate:modelValue":a[3]||(a[3]=o=>g.value=o),label:"Sales Order",dense:"",readonly:""},{append:l(()=>[e(C,{round:"",dense:"",flat:"",icon:"search",onClick:te})]),_:1},8,["modelValue"])]),t("div",Ne,[e(P,{dense:"",filled:"",label:"Customer Choose",modelValue:L.value,"onUpdate:modelValue":a[5]||(a[5]=o=>L.value=o),"use-input":"","input-debounce":"500",options:n.value,onFilter:a[6]||(a[6]=(o,O,T)=>S(o,O,T,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:s.value,readonly:g.value!=""},{after:l(()=>[e(C,{round:"",dense:"",flat:"",icon:"person_add",onClick:a[4]||(a[4]=o=>d.onAddCustClick()),color:"cyan"},{default:l(()=>[e($,null,{default:l(()=>[D("Add new customer")]),_:1})]),_:1})]),_:1},8,["modelValue","options","loading","readonly"])])]),t("div",He,[t("div",Pe,[e(w,{modelValue:v.value,"onUpdate:modelValue":a[7]||(a[7]=o=>v.value=o),label:"Remarks",dense:""},null,8,["modelValue"])])])]),t("fieldset",qe,[xe,t("div",Ee,[t("div",Be,[e(ve,{modelValue:r.value,"onUpdate:modelValue":a[8]||(a[8]=o=>r.value=o),label:"Item Split Invoice ?",color:"teal"},null,8,["modelValue"])]),t("div",Ke,[e(C,{icon:"add",dense:"",outline:"",onClick:a[9]||(a[9]=o=>ne()),color:"primary"})])]),e(Se,{bordered:"",dense:""},{default:l(()=>[i.value.length>0?(_(!0),R(Q,{key:0},A(i.value,(o,O)=>(_(),y(J,{key:O,class:"q-my-sm",dense:"",loading:s.value},{default:l(()=>[e(M,{avatar:""},{default:l(()=>[e(_e,{"text-color":"blue"},{default:l(()=>[D(U(O+1),1)]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(I,null,{default:l(()=>[e(P,{dense:"",filled:"",label:"Item Name",modelValue:o.MITM_ITMNM,"onUpdate:modelValue":T=>o.MITM_ITMNM=T,"use-input":"","input-debounce":"500",options:m.value,onFilter:a[10]||(a[10]=(T,me,pe)=>S(T,me,pe,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:s.value,readonly:g.value!=""},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"])]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(I,null,{default:l(()=>[e(w,{dense:"",label:"Qty",filled:"",modelValue:o.BALQT,"onUpdate:modelValue":T=>o.BALQT=T},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(M,null,{default:l(()=>[e(I,null,{default:l(()=>[D(" Rp. "+U(o.TSLODETA_PRC.toLocaleString()),1)]),_:2},1024),e(I,{caption:""},{default:l(()=>[D(" Price ")]),_:1})]),_:2},1024),e(M,{side:""},{default:l(()=>[e(C,{icon:"delete",color:"red",flat:"",onClick:T=>se(O)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["loading"]))),128)):G((_(),y(J,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(M,null,{default:l(()=>[e(I,null,{default:l(()=>[D(" Choose sales order first to access item list or Add by click + button above ")]),_:1})]),_:1})]),_:1})),[[fe]])]),_:1})])]),_:1}),e(X,{align:"right"},{default:l(()=>[e(C,{label:"OK",color:"primary",onClick:a[11]||(a[11]=o=>ae()),loading:s.value},null,8,["loading"]),e(C,{flat:"",label:"Cancel",color:"red",onClick:H(ce)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Ye={class:"q-pa-md"},je={class:"row q-pb-md"},ze=t("div",{class:"col"},[t("span",{class:"text-h4"},"Outgoing")],-1),Ge={class:"col text-right"},Je={class:"row q-pt-md"},We={class:"col"},cl={__name:"outgoingView",setup(x){const V=Y(),c=u([]),s=u([{name:"TDLVORD_DLVCD",label:"Delivery ID",field:"TDLVORD_DLVCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TDLVORD_ISSUDT",label:"Issue Date",field:"TDLVORD_ISSUDT",sortable:!0,align:"left"},{name:"TDLVORD_REMARK",label:"Remark",field:"TDLVORD_REMARK",sortable:!0,align:"left"}]),p=u(!1),b=u(""),h=u("");K(()=>{f()});const f=async()=>{p.value=!0,await k.post("delivery/searchAPI",{searchBy:b.value,searchValue:h.value}).then(v=>{p.value=!1,c.value=v.data.data}).catch(v=>{p.value=!1})},g=(v=[])=>{V.dialog({component:Fe,componentProps:{dataHeader:v}}).onOk(async i=>{f()})},L=v=>{V.dialog({title:"Confirmation",message:"Are you sure want to delete this data ?",cancel:!0,persistent:!0}).onOk(async()=>{p.value=!0,await k.delete(`delivery/${btoa(v)}`).then(i=>{p.value=!1,f()})})};return(v,i)=>(_(),R("div",Ye,[t("div",je,[ze,t("div",Ge,[e(C,{icon:"add",color:"blue",onClick:i[0]||(i[0]=n=>g([]))},{default:l(()=>[e($,null,{default:l(()=>[D("Create New Delivery")]),_:1})]),_:1})])]),e(De),t("div",Je,[t("div",We,[e(ee,{title:"Outgoing List",rows:c.value,columns:s.value,"row-key":"TDLVORD_DLVCD",loading:p.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(P,{outlined:"",modelValue:b.value,"onUpdate:modelValue":i[1]||(i[1]=n=>b.value=n),options:s.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(w,{borderless:"",dense:"",modelValue:h.value,"onUpdate:modelValue":[i[2]||(i[2]=n=>h.value=n),i[3]||(i[3]=n=>f())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),header:l(n=>[e(q,{props:n},{default:l(()=>[(_(!0),R(Q,null,A(n.cols,m=>(_(),y(E,{key:m.name,props:n},{default:l(()=>[D(U(m.label),1)]),_:2},1032,["props"]))),128)),e(E,{"auto-width":""},{default:l(()=>[D("Action")]),_:1})]),_:2},1032,["props"])]),body:l(n=>[e(q,{props:n},{default:l(()=>[(_(!0),R(Q,null,A(n.cols,m=>(_(),y(B,{key:m.name,props:n},{default:l(()=>[D(U(m.value),1)]),_:2},1032,["props"]))),128)),e(B,{"auto-width":""},{default:l(()=>[e(C,{flat:"",color:"orange",icon:"edit",onClick:m=>g(n.row),dense:""},{default:l(()=>[e($,null,{default:l(()=>[D("Edit Data")]),_:1})]),_:2},1032,["onClick"]),e(C,{flat:"",color:"red",icon:"delete",onClick:m=>L(n.row.TDLVORD_DLVCD),dense:""},{default:l(()=>[e($,null,{default:l(()=>[D("Edit Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{cl as default};
