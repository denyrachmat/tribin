import{Q as O}from"./QTooltip.f31a3b26.js";import{s as c,o as J,B as V,C as R,D as l,E as e,J as W,K as A,I as a,P as D,L as X,Q as v,M as q,O as Z,aa as z,aW as x,H as p,R as Q,aU as P,aV as Y,aZ as oe,aX as E,ap as se,S as ne}from"./index.cead2cce.js";import{u as ee,b as K,c as N,Q as de,j as L,k as w,l as B,a as ie,m as F}from"./use-dialog-plugin-component.17ea39ed.js";import{d as le,Q as j,a as G}from"./date.43779365.js";import{api_web as k}from"./axios.0fd082af.js";import{Q as ue,a as re,C as me}from"./ClosePopup.cd08e4c3.js";const ce=a("div",{class:"text-h6"},"Create Item Master",-1),_e={class:"row"},pe={class:"col"},ve={class:"col q-pl-md"},fe={class:"row q-pt-md"},Me={class:"col"},Ce={class:"col q-pl-md"},Ve={class:"row q-pt-md"},De={class:"col"},ge={class:"col q-pl-md"},Ie={class:"row q-pt-md"},Te={class:"col"},be={__name:"itemCreate",props:{ItemCat:String},setup(H){const{dialogRef:U,onDialogHide:b,onDialogOK:S,onDialogCancel:y}=ee(),T=K(),t=c({MITM_ITMCD:"",MITM_ITMNM:"",MITM_STKUOM:"",MITM_ITMTYPE:1,MITM_BRAND:"",MITM_MODEL:"",MITM_SPEC:"",MITM_ITMCAT:"",MITM_COACD:"",MITM_ITMCAT:""}),f=c(!1),h=c([]),_=c([]),o=H;J(()=>{m(),t.value.MITM_ITMCAT=o.ItemCat});const M=(g,n,u,$)=>{n(async()=>{await k.post("item/getListCoasAPI",{search:g}).then(r=>{_.value=r.data})})},d=()=>{T.dialog({title:"Confirmation",message:"Do you want to save this item ?",cancel:!0,persistent:!0}).onOk(async()=>{await k.post("item",t.value).then(g=>{S(g.data.data.value)})})},m=async()=>{f.value=!0,await k.get("item/formAPI").then(g=>{f.value=!1,h.value=g.data.uoms,_.value=g.data.coas}).catch(()=>{f.value=!1})};return(g,n)=>(V(),R(Z,{ref_key:"dialogRef",ref:U,onHide:q(b),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(W,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(A,null,{default:l(()=>[ce]),_:1}),e(A,{class:"q-pa-sm"},{default:l(()=>[a("div",_e,[a("div",pe,[e(D,{label:"Item Code",dense:"",modelValue:t.value.MITM_ITMCD,"onUpdate:modelValue":n[0]||(n[0]=u=>t.value.MITM_ITMCD=u),filled:""},null,8,["modelValue"])]),a("div",ve,[e(D,{label:"Item Name",dense:"",modelValue:t.value.MITM_ITMNM,"onUpdate:modelValue":n[1]||(n[1]=u=>t.value.MITM_ITMNM=u),filled:""},null,8,["modelValue"])])]),a("div",fe,[a("div",Me,[e(N,{dense:"",filled:"",label:"UOM",modelValue:t.value.MITM_STKUOM,"onUpdate:modelValue":n[2]||(n[2]=u=>t.value.MITM_STKUOM=u),options:h.value,behavior:"dialog","option-label":"MUOM_UOMNM","option-value":"MUOM_UOMCD","emit-value":"","map-options":"",loading:f.value},null,8,["modelValue","options","loading"])]),a("div",Ce,[e(D,{label:"Item Brand",dense:"",modelValue:t.value.MITM_BRAND,"onUpdate:modelValue":n[3]||(n[3]=u=>t.value.MITM_BRAND=u),filled:""},null,8,["modelValue"])])]),a("div",Ve,[a("div",De,[e(D,{label:"Item Model",dense:"",modelValue:t.value.MITM_MODEL,"onUpdate:modelValue":n[4]||(n[4]=u=>t.value.MITM_MODEL=u),filled:""},null,8,["modelValue"])]),a("div",ge,[e(D,{label:"Item Specification",dense:"",modelValue:t.value.MITM_SPEC,"onUpdate:modelValue":n[5]||(n[5]=u=>t.value.MITM_SPEC=u),filled:""},null,8,["modelValue"])])]),a("div",Ie,[a("div",Te,[e(N,{dense:"",filled:"",label:"COA",modelValue:t.value.MITM_COACD,"onUpdate:modelValue":n[6]||(n[6]=u=>t.value.MITM_COACD=u),options:_.value,"use-input":"",behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD",onFilter:n[7]||(n[7]=(u,$,r)=>M(u,$,r)),"emit-value":"","map-options":"",loading:f.value},null,8,["modelValue","options","loading"])])])]),_:1}),e(X,{align:"right"},{default:l(()=>[e(v,{label:"OK",color:"primary",onClick:n[8]||(n[8]=u=>d())}),e(v,{flat:"",label:"Cancel",color:"red",onClick:q(y)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Se=a("div",{class:"text-h6"},"Create Order",-1),he={style:{border:"1px black solid","border-radius":"10px"}},we=a("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[a("b",null,"Header")],-1),Oe={class:"row"},ke={class:"col"},ye={class:"col q-pl-md"},Re={class:"row items-center justify-end"},Ue={class:"row"},Ne={class:"col"},$e={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Qe=a("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[a("b",null,"Detail Items")],-1),Ae={class:"row q-pb-sm"},qe={class:"col text-right"},He={__name:"serviceCreateOrder",setup(H){const{dialogRef:U,onDialogHide:b,onDialogOK:S,onDialogCancel:y}=ee(),T=K(),t=c({SRVH_DOCNO:"",SRVH_ISSDT:le.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),f=c([]),h=c([]),_=c([]),o=c(!1),M=(r,s,i,I)=>{s(async()=>{I==="cust"&&await d(r),I==="item"&&await m(r)})},d=async r=>{o.value=!0,await k.post("customer/searchAPI",{searchValue:r}).then(s=>{o.value=!1,h.value=s.data.data}).catch(()=>{o.value=!1})},m=async r=>{o.value=!0,await k.post("item/searchAPI",{searchValue:r}).then(s=>{o.value=!1,f.value=s.data.data}).catch(()=>{o.value=!1})},g=()=>{_.value.push({TSRVD_ITMCD:"",TSRVD_LINE:_.value.length+1,TSRVD_QTY:1,TSRVD_CUSTRMK:""})},n=r=>{T.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${r+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{_.value.splice(r,1)})},u=r=>{T.dialog({component:be,componentProps:{ItemCat:"SERVICE_ITEMM"}}).onOk(async s=>{await m(""),_.value[r].TSRVD_ITMCD=s.MITM_ITMNM})},$=()=>{T.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{o.value=!0,await k.post("servicesAdmin",{header:t.value,detail:_.value}).then(r=>{o.value=!1,S()})})};return(r,s)=>(V(),R(Z,{ref_key:"dialogRef",ref:U,onHide:q(b),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(W,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(A,null,{default:l(()=>[Se]),_:1}),e(A,{class:"q-pa-sm"},{default:l(()=>[a("fieldset",he,[we,a("div",Oe,[a("div",ke,[e(D,{label:"SPK No",readonly:"",dense:"",modelValue:t.value.SRVH_DOCNO,"onUpdate:modelValue":s[0]||(s[0]=i=>t.value.SRVH_DOCNO=i),filled:""},null,8,["modelValue"])]),a("div",ye,[e(D,{filled:"",modelValue:t.value.SRVH_ISSDT,"onUpdate:modelValue":s[2]||(s[2]=i=>t.value.SRVH_ISSDT=i),dense:"",label:"Issue Date",loading:o.value,onClick:s[3]||(s[3]=i=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(z,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(ue,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(re,{modelValue:t.value.SRVH_ISSDT,"onUpdate:modelValue":s[1]||(s[1]=i=>t.value.SRVH_ISSDT=i),mask:"YYYY-MM-DD"},{default:l(()=>[a("div",Re,[x(e(v,{label:"Close",color:"primary",flat:""},null,512),[[me]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),a("div",Ue,[a("div",Ne,[e(N,{dense:"",filled:"",label:"Customer Choose",modelValue:t.value.SRVH_CUSCD,"onUpdate:modelValue":s[4]||(s[4]=i=>t.value.SRVH_CUSCD=i),"use-input":"","input-debounce":"500",options:h.value,onFilter:s[5]||(s[5]=(i,I,C)=>M(i,I,C,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:o.value},null,8,["modelValue","options","loading"])])])]),a("fieldset",$e,[Qe,a("div",Ae,[a("div",qe,[e(v,{flat:"",icon:"add",color:"blue",onClick:s[6]||(s[6]=i=>g())},{default:l(()=>[e(O,null,{default:l(()=>[p("Add lines")]),_:1})]),_:1})])]),e(de,{bordered:"",dense:""},{default:l(()=>[_.value.length>0?(V(!0),Q(P,{key:0},Y(_.value,(i,I)=>(V(),R(L,{key:I,class:"q-my-sm",dense:""},{default:l(()=>[e(w,{avatar:""},{default:l(()=>[e(oe,{"text-color":"blue"},{default:l(()=>[p(E(I+1),1)]),_:2},1024)]),_:2},1024),e(w,null,{default:l(()=>[e(B,null,{default:l(()=>[e(N,{dense:"",filled:"",label:"Item Name",modelValue:i.TSRVD_ITMCD,"onUpdate:modelValue":C=>i.TSRVD_ITMCD=C,"use-input":"","input-debounce":"500",options:f.value,onFilter:s[7]||(s[7]=(C,ae,te)=>M(C,ae,te,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:o.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),e(w,null,{default:l(()=>[e(D,{label:"Qty",filled:"",dense:"",modelValue:i.TSRVD_QTY,"onUpdate:modelValue":C=>i.TSRVD_QTY=C},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(w,null,{default:l(()=>[e(D,{label:"Problem",filled:"",dense:"",modelValue:i.TSRVD_CUSTRMK,"onUpdate:modelValue":C=>i.TSRVD_CUSTRMK=C},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(w,{side:""},{default:l(()=>[e(v,{icon:"delete",color:"red",flat:"",onClick:C=>n(I)},{default:l(()=>[e(O,null,{default:l(()=>[p("Delete line")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(w,{side:""},{default:l(()=>[e(v,{icon:"library_add",color:"indigo",flat:"",onClick:C=>u(I)},{default:l(()=>[e(O,null,{default:l(()=>[p("Add new item")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)):x((V(),R(L,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(w,null,{default:l(()=>[e(B,null,{default:l(()=>[p(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[se]])]),_:1})])]),_:1}),e(X,{align:"right"},{default:l(()=>[e(v,{label:"OK",color:"primary",onClick:s[8]||(s[8]=i=>$()),disable:o.value,loading:o.value},null,8,["disable","loading"]),e(v,{flat:"",label:"Cancel",color:"red",onClick:q(y),loading:o.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const Pe={class:"q-pa-md"},Ye={class:"row q-pb-md"},Ee=a("div",{class:"col"},[a("span",{class:"text-h4"},"Receive Order ")],-1),Ke={class:"col text-right"},xe={class:"row q-pt-md"},Le={class:"col"},Xe={__name:"serviceView",setup(H){const U=K(),b=c("SRVH_DOCNO"),S=c(""),y=c([]),T=c([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Cust",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left",format:o=>le.formatDate(new Date(o),"DD MMM YYYY")}]),t=c(!1);J(()=>{f()});const f=async()=>{t.value=!0,await k.post("servicesAdmin/search",{searchBy:b.value,searchValue:S.value}).then(o=>{t.value=!1,y.value=o.data.data}).catch(o=>{t.value=!1})},h=()=>{U.dialog({component:He}).onOk(async o=>{f()})},_=o=>{window.open("https://joss.jatpowerindo.co.id/PDF/quotation/"+btoa(o),"_blank").focus()};return(o,M)=>(V(),Q("div",Pe,[a("div",Ye,[Ee,a("div",Ke,[e(v,{icon:"add",color:"blue",onClick:h},{default:l(()=>[e(O,null,{default:l(()=>[p("Create New Order")]),_:1})]),_:1})])]),e(ne),a("div",xe,[a("div",Le,[e(ie,{title:"Created Order",rows:y.value,columns:T.value,"row-key":"name",loading:t.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(N,{outlined:"",modelValue:b.value,"onUpdate:modelValue":M[0]||(M[0]=d=>b.value=d),options:T.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(D,{borderless:"",dense:"",modelValue:S.value,"onUpdate:modelValue":[M[1]||(M[1]=d=>S.value=d),M[2]||(M[2]=d=>o.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(z,{name:"search"})]),_:1},8,["modelValue"])]),header:l(d=>[e(j,{props:d},{default:l(()=>[(V(!0),Q(P,null,Y(d.cols,m=>(V(),R(F,{key:m.name,props:d},{default:l(()=>[p(E(m.label),1)]),_:2},1032,["props"]))),128)),e(F,{"auto-width":""},{default:l(()=>[p("Action")]),_:1})]),_:2},1032,["props"])]),body:l(d=>[e(j,{props:d},{default:l(()=>[(V(!0),Q(P,null,Y(d.cols,m=>(V(),R(G,{key:m.name,props:d},{default:l(()=>[p(E(m.value),1)]),_:2},1032,["props"]))),128)),e(G,{"auto-width":""},{default:l(()=>[e(v,{flat:"",color:"orange",icon:"edit",onClick:m=>o.onClickEdit(d.row.SRVH_DOCNO),dense:""},{default:l(()=>[e(O,null,{default:l(()=>[p("Edit this Order")]),_:1})]),_:2},1032,["onClick"]),e(v,{flat:"",color:"indigo",icon:"print",onClick:m=>_(d.row.SRVH_DOCNO),dense:""},{default:l(()=>[e(O,null,{default:l(()=>[p("Print this order")]),_:1})]),_:2},1032,["onClick"]),e(v,{flat:"",color:"red",icon:"delete",onClick:m=>o.onClickDelete(d.row.SRVH_DOCNO),dense:"",disable:d.row.detail.filter(m=>m.TSRVD_FLGSTS>0).length>0},{default:l(()=>[e(O,null,{default:l(()=>[p("Delete this Order")]),_:1})]),_:2},1032,["onClick","disable"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Xe as default};
