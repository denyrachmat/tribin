import{Q as U}from"./QTooltip.49e1332f.js";import{s as c,B as O,C as g,D as l,E as e,L as K,M as I,I as o,Z as Q,am as E,T as w,Q as S,O as _,P as h,R as V,S as y,U as Z,H as n,V as z,X as J,Y as W,o as ee,aX as le}from"./index.67bb1a8a.js";import{a as B,u as ae,l as F,Q as te,b as R,c as f,d as u,k as oe,m as M}from"./QTable.95145999.js";import{Q as q,a as N}from"./QTd.02ea250b.js";import{api_web as H,api as se}from"./axios.597c00da.js";import{Q as $,a as Y,C as x}from"./ClosePopup.0dce3296.js";import"./use-cache.b0833c75.js";import"./date.8ab188f9.js";const ne=o("div",{class:"text-h6"},"RO Maintenance",-1),de={style:{border:"1px black solid","border-radius":"10px"}},ie=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),ue={class:"row"},re={class:"col"},_e={class:"col q-pl-md"},ce={class:"row items-center justify-end"},Te={class:"col q-pl-md"},me={class:"row items-center justify-end"},De={class:"row"},fe={class:"col"},Oe={class:"col q-pl-md"},ve={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Se=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Detail Items")],-1),pe={class:"row q-pb-md"},Ce={class:"col"},Le={class:"text-h6"},Qe={class:"col text-right"},ge={class:"row"},be={class:"col"},Ue={__name:"salesOrderCreate",setup(G){const A=B(),d=c({TSLO_SLOCD:"",TSLO_ISSUDT:"",TSLO_PLAN_DLVDT:"",TSLO_QUOCD:"",TSLO_POCD:""});c(""),c("");const C=c([]),i=c(!1),L=c(1),T=c([]),b=(r,t,a,p)=>{t(async()=>{p==="quotation"&&await P(r)})},P=async(r="")=>{i.value=!0,await H.post("quotation/search",{searchBy:"MCUS_CUSNM",searchValue:r}).then(t=>{i.value=!1,C.value=t.data.data}).catch(t=>{i.value=!1})},m=()=>L.value===1?"Rental":L.value===2?"Sales":"Service",v=async r=>{console.log(r),i.value=!0,await se.get(`transaction/quotation/view/${btoa(r)}`).then(t=>{i.value=!1,t.data.data.det.map(a=>{T.value.push({TSLODETA_ITMCD:a.TQUODETA_ITMCD,TSLODETA_ITMQT:a.TQUODETA_ITMQT,TSLODETA_USAGE:a.TQUODETA_USAGE,TSLODETA_PRC:a.TQUODETA_PRC,TSLODETA_PERIOD_FR:a.TQUODETA_PERIOD_FR,TSLODETA_PERIOD_TO:a.TQUODETA_PERIOD_TO})})}).catch(t=>{i.value=!1})},s=()=>{T.value.push({TSLODETA_ITMCD:"",TSLODETA_ITMQT:"",TSLODETA_USAGE:"",TSLODETA_PRC:0,TSLODETA_PERIOD_FR:"",TSLODETA_PERIOD_TO:""})},D=r=>{A.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${r+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{T.value.splice(r,1)})},{dialogRef:j,onDialogHide:X,onDialogOK:ye,onDialogCancel:ke}=ae();return(r,t)=>(O(),g(W,{ref_key:"dialogRef",ref:j,onHide:J(X),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:l(()=>[e(K,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(I,null,{default:l(()=>[ne]),_:1}),e(I,{class:"q-pa-sm"},{default:l(()=>[o("fieldset",de,[ie,o("div",ue,[o("div",re,[e(Q,{label:"RO Code",dense:"",filled:"",modelValue:d.value.TSLO_SLOCD,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value.TSLO_SLOCD=a),disable:"",loading:i.value},null,8,["modelValue","loading"])]),o("div",_e,[e(Q,{filled:"",modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":t[2]||(t[2]=a=>d.value.TSLO_ISSUDT=a),dense:"",label:"Issue Date",loading:i.value,onClick:t[3]||(t[3]=a=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(E,{name:"event",class:"cursor-pointer"},{default:l(()=>[e($,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(Y,{modelValue:d.value.TSLO_ISSUDT,"onUpdate:modelValue":t[1]||(t[1]=a=>d.value.TSLO_ISSUDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",ce,[w(e(S,{label:"Close",color:"primary",flat:""},null,512),[[x]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])]),o("div",Te,[e(Q,{filled:"",modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":t[5]||(t[5]=a=>d.value.TSLO_PLAN_DLVDT=a),dense:"",label:"Delivery Date",loading:i.value,onClick:t[6]||(t[6]=a=>r.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[e(E,{name:"event",class:"cursor-pointer"},{default:l(()=>[e($,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(Y,{modelValue:d.value.TSLO_PLAN_DLVDT,"onUpdate:modelValue":t[4]||(t[4]=a=>d.value.TSLO_PLAN_DLVDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",me,[w(e(S,{label:"Close",color:"primary",flat:""},null,512),[[x]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),o("div",De,[o("div",fe,[e(F,{dense:"",filled:"",label:"Sales Quotation Code",modelValue:d.value.TSLO_QUOCD,"onUpdate:modelValue":[t[7]||(t[7]=a=>d.value.TSLO_QUOCD=a),v],"use-input":"","input-debounce":"500",options:C.value,onFilter:t[8]||(t[8]=(a,p,k)=>b(a,p,k,"quotation")),behavior:"dialog","option-label":"DESCSEL","option-value":"TQUO_QUOCD","emit-value":"","map-options":"",loading:i.value},null,8,["modelValue","options","loading"])]),o("div",Oe,[e(Q,{label:"PO Number",dense:"",filled:"",modelValue:d.value.TSLO_POCD,"onUpdate:modelValue":t[9]||(t[9]=a=>d.value.TSLO_POCD=a),loading:i.value},null,8,["modelValue","loading"])])])]),o("fieldset",ve,[Se,o("div",pe,[o("div",Ce,[o("span",Le,_(m()),1)]),o("div",Qe,[e(S,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:s,loading:i.value},null,8,["loading"])])]),o("div",ge,[o("div",be,[e(te,{bordered:"",dense:""},{default:l(()=>[T.value.length>0?(O(!0),h(V,{key:0},y(T.value,(a,p)=>(O(),g(R,{key:p,class:"q-my-sm",dense:""},{default:l(()=>[e(f,{avatar:""},{default:l(()=>[e(Z,{"text-color":"blue"},{default:l(()=>[n(_(p+1),1)]),_:2},1024)]),_:2},1024),e(f,null,{default:l(()=>[e(u,null,{default:l(()=>[n(_(a.TSLODETA_ITMCD),1)]),_:2},1024),e(u,{caption:""},{default:l(()=>[n(" Item Name ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(u,null,{default:l(()=>[n(_(a.TSLODETA_ITMQT),1)]),_:2},1024),e(u,{caption:""},{default:l(()=>[n(" Qty ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(u,null,{default:l(()=>[n(_(a.TSLODETA_USAGE),1)]),_:2},1024),e(u,{caption:""},{default:l(()=>[n(" Usage ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(u,null,{default:l(()=>[n(_(a.TSLODETA_PRC),1)]),_:2},1024),e(u,{caption:""},{default:l(()=>[n(" Price ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(u,null,{default:l(()=>[n(_(a.TSLODETA_PERIOD_FR),1)]),_:2},1024),e(u,{caption:""},{default:l(()=>[n(" Period From ")]),_:1})]),_:2},1024),e(f,null,{default:l(()=>[e(u,null,{default:l(()=>[n(_(a.TSLODETA_PERIOD_TO),1)]),_:2},1024),e(u,{caption:""},{default:l(()=>[n(" Period To ")]),_:1})]),_:2},1024),e(f,{side:""},{default:l(()=>[e(S,{icon:"delete",color:"red",flat:"",onClick:k=>D(p)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)):w((O(),g(R,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(f,null,{default:l(()=>[e(u,null,{default:l(()=>[n(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[z]])]),_:1})])])])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const he={class:"q-pa-md"},Ae={class:"row q-pb-md"},Pe=o("div",{class:"col"},[o("span",{class:"text-h4"},"Sales Order / Receive Order")],-1),we={class:"col text-right"},Ee={class:"row q-pt-md"},Ve={class:"col"},Be={__name:"salesOrderView",setup(G){const A=B(),d=c("TQUO_QUOCD"),C=c(""),i=c([]),L=c([{name:"TSLO_SLOCD",label:"RO. Code",field:"TSLO_SLOCD",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"TSLO_ADDRESS_NAME",label:"Customer Addr.",field:"TSLO_ADDRESS_NAME",sortable:!0,align:"left"},{name:"TSLO_CUSCD",label:"Customer Code",field:"TSLO_CUSCD",sortable:!0,align:"left"},{name:"TSLO_ISSUDT",label:"Issue Date",field:"TSLO_ISSUDT",sortable:!0,align:"left"},{name:"TSLO_QUOCD",label:"Quot. Code",field:"TSLO_QUOCD",sortable:!0,align:"left"}]),T=c(!1);ee(()=>{b()});const b=async()=>{T.value=!0,await H.post("receive-order/searchAPI",{searchBy:d.value,searchValue:C.value}).then(m=>{T.value=!1,i.value=m.data.data}).catch(m=>{T.value=!1})},P=()=>{A.dialog({component:Ue}).onOk(async m=>{b()})};return(m,v)=>(O(),h("div",he,[o("div",Ae,[Pe,o("div",we,[e(S,{icon:"add",color:"blue",onClick:P},{default:l(()=>[e(U,null,{default:l(()=>[n("Create New RO")]),_:1})]),_:1})])]),e(le),o("div",Ee,[o("div",Ve,[e(oe,{title:"Created RO",rows:i.value,columns:L.value,"row-key":"name",loading:T.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(F,{outlined:"",modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=s=>d.value=s),options:L.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(Q,{borderless:"",dense:"",modelValue:C.value,"onUpdate:modelValue":[v[1]||(v[1]=s=>C.value=s),v[2]||(v[2]=s=>m.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(E,{name:"search"})]),_:1},8,["modelValue"])]),header:l(s=>[e(q,{props:s},{default:l(()=>[e(M,{"auto-width":""},{default:l(()=>[n("Action")]),_:1}),(O(!0),h(V,null,y(s.cols,D=>(O(),g(M,{key:D.name,props:s},{default:l(()=>[n(_(D.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:l(s=>[e(q,{props:s},{default:l(()=>[e(N,{"auto-width":""},{default:l(()=>[e(S,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"orange",icon:"edit",onClick:D=>m.onClickEdit(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(U,null,{default:l(()=>[n(_(s.row.TQUO_APPRVDT?"Quotation already approved, cannot edit !":"Edit this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(S,{flat:"",color:s.row.TQUO_APPRVDT!==null?"grey":"red",icon:"delete",onClick:D=>m.onClickDelete(s.row.TQUO_QUOCD),dense:"",disable:s.row.TQUO_APPRVDT!==null},{default:l(()=>[e(U,null,{default:l(()=>[n(_(s.row.TQUO_APPRVDT?"Quotation already approved, cannot delete !":"Delete this quotation"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(S,{flat:"",color:"indigo",icon:"print",onClick:D=>m.onClickPrint(s.row.TQUO_QUOCD),dense:""},{default:l(()=>[e(U,null,{default:l(()=>[n("Print this quotation")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(O(!0),h(V,null,y(s.cols,D=>(O(),g(N,{key:D.name,props:s},{default:l(()=>[n(_(D.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Be as default};
