import{Q as O}from"./QTooltip.9c4cc362.js";import{s as f,B as m,C as b,D as a,E as e,J,K as N,I as t,P as w,aa as B,aW as U,Q as v,R as y,aU as R,aV as T,aZ as W,H as p,aX as H,ap as X,L as Z,M as $,O as z,o as G,S as ee}from"./index.4486b82c.js";import{u as ae,b as L,Q as le,j as q,k,l as P,c as E,a as te,m as x}from"./use-dialog-plugin-component.9a7f8119.js";import{Q as Y,a as A}from"./date.aa5569bc.js";import{api_web as M}from"./axios.4f5aa02d.js";import{Q as oe,a as se,C as ne}from"./ClosePopup.db669138.js";const ie=t("div",{class:"text-h6"},"Create Order",-1),de={style:{border:"1px black solid","border-radius":"10px"}},ue=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Header")],-1),re={class:"row"},ce={class:"col"},me={class:"col q-pl-md"},_e={class:"row items-center justify-end"},pe={class:"row"},fe={class:"col"},ve={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Ce=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Detail Items")],-1),Ve={class:"row"},be={class:"col text-right"},ge={__name:"serviceCreateOrder",setup(K){const{dialogRef:Q,onDialogHide:V,onDialogOK:g,onDialogCancel:h}=ae(),S=L(),n=f({SRVH_DOCNO:"",SRVH_ISSDT:"",SRVH_CUSCD:""}),d=f([]),u=f(!1),I=(i,l,s,C)=>{l(async()=>{C==="cust"&&await r(i),C==="item"&&await _(i)})},r=async i=>{u.value=!0,await M.post("customer/searchAPI",{searchValue:i}).then(l=>{u.value=!1,listCustomers.value=l.data.data}).catch(()=>{u.value=!1})},_=async i=>{u.value=!0,await M.post("item/searchAPI",{searchValue:i}).then(l=>{u.value=!1,d.value=l.data.data}).catch(()=>{u.value=!1})},o=()=>{d.value.push({TSRVD_ITMCD:"",TSRVD_LINE:d.value.length+1})},c=i=>{S.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${i+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{d.value.splice(i,1)})};return(i,l)=>(m(),b(z,{ref_key:"dialogRef",ref:Q,onHide:$(V),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[e(J,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(N,null,{default:a(()=>[ie]),_:1}),e(N,{class:"q-pa-sm"},{default:a(()=>[t("fieldset",de,[ue,t("div",re,[t("div",ce,[e(w,{label:"SPK No",readonly:"",dense:"",modelValue:n.value.SRVH_DOCNO,"onUpdate:modelValue":l[0]||(l[0]=s=>n.value.SRVH_DOCNO=s),filled:""},null,8,["modelValue"])]),t("div",me,[e(w,{filled:"",modelValue:n.value.SRVH_ISSDT,"onUpdate:modelValue":l[2]||(l[2]=s=>n.value.SRVH_ISSDT=s),dense:"",label:"Issue Date",loading:u.value,onClick:l[3]||(l[3]=s=>i.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:a(()=>[e(B,{name:"event",class:"cursor-pointer"},{default:a(()=>[e(oe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(se,{modelValue:n.value.SRVH_ISSDT,"onUpdate:modelValue":l[1]||(l[1]=s=>n.value.SRVH_ISSDT=s),mask:"YYYY-MM-DD"},{default:a(()=>[t("div",_e,[U(e(v,{label:"Close",color:"primary",flat:""},null,512),[[ne]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),t("div",pe,[t("div",fe,[e(w,{label:"Customer Choose",dense:"",modelValue:n.value.SRVH_CUSCD,"onUpdate:modelValue":l[4]||(l[4]=s=>n.value.SRVH_CUSCD=s),filled:""},null,8,["modelValue"])])])]),t("fieldset",ve,[Ce,t("div",Ve,[t("div",be,[e(v,{flat:"",icon:"add",color:"blue",onClick:l[5]||(l[5]=s=>o())})])]),e(le,{bordered:"",dense:""},{default:a(()=>[d.value.length>0?(m(!0),y(R,{key:0},T(d.value,(s,C)=>(m(),b(q,{key:C,class:"q-my-sm",dense:""},{default:a(()=>[e(k,{avatar:""},{default:a(()=>[e(W,{"text-color":"blue"},{default:a(()=>[p(H(C+1),1)]),_:2},1024)]),_:2},1024),e(k,null,{default:a(()=>[e(P,null,{default:a(()=>[e(E,{dense:"",filled:"",label:"Item Name",modelValue:s.TSRVD_ITMCD,"onUpdate:modelValue":D=>s.TSRVD_ITMCD=D,"use-input":"","input-debounce":"500",options:d.value,onFilter:l[6]||(l[6]=(D,j,F)=>I(D,j,F,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:u.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),e(k,{side:""},{default:a(()=>[e(v,{icon:"delete",color:"red",flat:"",onClick:D=>c(C)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)):U((m(),b(q,{key:1,class:"q-my-sm",clickable:""},{default:a(()=>[e(k,null,{default:a(()=>[e(P,null,{default:a(()=>[p(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[X]])]),_:1})])]),_:1}),e(Z,{align:"right"},{default:a(()=>[e(v,{label:"OK",color:"primary",onClick:l[7]||(l[7]=s=>i.onSubmitData()),disable:i.stateSubmit},null,8,["disable"]),e(v,{flat:"",label:"Cancel",color:"red",onClick:$(h)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const he={class:"q-pa-md"},Se={class:"row q-pb-md"},De=t("div",{class:"col"},[t("span",{class:"text-h4"},"Receive Order ")],-1),ke={class:"col text-right"},we={class:"row q-pt-md"},ye={class:"col"},Me={__name:"serviceView",setup(K){const Q=L(),V=f("SRVH_DOCNO"),g=f(""),h=f([]),S=f([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"SRVH_CUSCD",label:"Cust",field:"SRVH_CUSCD",sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left"}]),n=f(!1);G(()=>{d()});const d=async()=>{n.value=!0,await M.post("service/search",{searchBy:V.value,searchValue:g.value}).then(r=>{n.value=!1,h.value=r.data.data}).catch(r=>{n.value=!1})},u=()=>{Q.dialog({component:ge}).onOk(async r=>{d()})},I=r=>{window.open("https://joss.jatpowerindo.co.id/PDF/quotation/"+btoa(r),"_blank").focus()};return(r,_)=>(m(),y("div",he,[t("div",Se,[De,t("div",ke,[e(v,{icon:"add",color:"blue",onClick:u},{default:a(()=>[e(O,null,{default:a(()=>[p("Create New Order")]),_:1})]),_:1})])]),e(ee),t("div",we,[t("div",ye,[e(te,{title:"Created Order",rows:h.value,columns:S.value,"row-key":"name",loading:n.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":a(()=>[e(E,{outlined:"",modelValue:V.value,"onUpdate:modelValue":_[0]||(_[0]=o=>V.value=o),options:S.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(w,{borderless:"",dense:"",modelValue:g.value,"onUpdate:modelValue":[_[1]||(_[1]=o=>g.value=o),_[2]||(_[2]=o=>r.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:a(()=>[e(B,{name:"search"})]),_:1},8,["modelValue"])]),header:a(o=>[e(Y,{props:o},{default:a(()=>[(m(!0),y(R,null,T(o.cols,c=>(m(),b(x,{key:c.name,props:o},{default:a(()=>[p(H(c.label),1)]),_:2},1032,["props"]))),128)),e(x,{"auto-width":""},{default:a(()=>[p("Action")]),_:1})]),_:2},1032,["props"])]),body:a(o=>[e(Y,{props:o},{default:a(()=>[(m(!0),y(R,null,T(o.cols,c=>(m(),b(A,{key:c.name,props:o},{default:a(()=>[p(H(c.value),1)]),_:2},1032,["props"]))),128)),e(A,{"auto-width":""},{default:a(()=>[e(v,{flat:"",color:"orange",icon:"edit",onClick:c=>r.onClickEdit(o.row.TQUO_QUOCD),dense:""},{default:a(()=>[e(O,null,{default:a(()=>[p("Edit this quotation")]),_:1})]),_:2},1032,["onClick"]),e(v,{flat:"",color:"indigo",icon:"print",onClick:c=>I(o.row.TQUO_QUOCD),dense:""},{default:a(()=>[e(O,null,{default:a(()=>[p("Print this order")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Me as default};
