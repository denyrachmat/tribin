import{o as O,s as C,B as t,C as c,D as a,E as e,L as $,M as Q,I as g,P as v,Q as I,a$ as T,T as k,H as i,V as R,R as H,S as E,U as K,O as f,Z as b,W,X as D,Y as X}from"./index.b955161a.js";import{u as Z,a as j,Q as z,b as S,c as d,d as s,l as G}from"./QTable.fe9495ba.js";import{api_web as J}from"./axios.2056a299.js";const ee={class:"row"},ae=g("div",{class:"col"},[g("div",{class:"text-h6"},"Update Used Item")],-1),le={key:0,class:"col text-right"},te={key:0},oe={key:0},ne={key:0},ie={class:"text-h5 text-bold"},re={__name:"serviceOprItemAdd",props:{mode:String,dataItem:Array},setup(y){const{dialogRef:F,onDialogHide:P,onDialogOK:L,onDialogCancel:h}=Z(),M=j(),o=y;O(async()=>{o.dataItem.listFixDet&&(_.value=o.dataItem.listFixDet,await w())});const V=C([]),_=C([]),m=C(!1),N=()=>{_.value.push({TSRVD_ID:o.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0,TSRVF_QTY:1})},x=(r,n,l,p)=>{n(async()=>{p==="item"&&await w(r)})},w=async r=>{m.value=!0,await J.post("item/searchAPITBL",{searchValue:r}).then(n=>{m.value=!1,V.value=n.data.data}).catch(()=>{m.value=!1})},U=()=>{o.mode==="view"?h():M.dialog({title:"Confirmation",message:"Are you sure want to save this items ?",cancel:!0,persistent:!0}).onOk(async()=>{L(_.value)})},q=r=>{M.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${r+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{_.value.splice(r,1)})},A=r=>{let n=0;return r.map(l=>{n+=parseInt(l.TSRVF_PRC)*parseInt(l.TSRVF_QTY)}),n.toLocaleString()};return(r,n)=>(t(),c(X,{ref_key:"dialogRef",ref:F,onHide:D(P),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(Q,null,{default:a(()=>[g("div",ee,[ae,o.mode!=="view"?(t(),v("div",le,[e(I,{icon:"add",outline:"",color:"blue",onClick:N})])):T("",!0)])]),_:1}),e(Q,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:a(()=>[e(z,{bordered:""},{default:a(()=>[_.value.length===0?k((t(),c(S,{key:0,class:"q-my-sm",clickable:""},{default:a(()=>[e(d,null,{default:a(()=>[i(" No items added ")]),_:1})]),_:1})),[[R]]):T("",!0),(t(!0),v(H,null,E(_.value,(l,p)=>k((t(),c(S,{key:p,class:"q-my-sm",clickable:""},{default:a(()=>[e(d,{avatar:""},{default:a(()=>[e(K,{color:"primary","text-color":"white"},{default:a(()=>[i(f(p+1),1)]),_:2},1024)]),_:2},1024),e(d,null,{default:a(()=>[e(s,null,{default:a(()=>[o.mode==="view"?(t(),v("div",te,[e(s,null,{default:a(()=>[i(f(l.MITM_ITMNM?l.MITM_ITMNM:V.value.filter(u=>u.MITM_ITMCD==l.TSRVF_ITMCD)[0].MITM_ITMNM),1)]),_:2},1024),e(s,{caption:""},{default:a(()=>[i(" Item ")]),_:1})])):(t(),c(G,{key:1,dense:"",filled:"",label:"Item Name",modelValue:l.TSRVF_ITMCD,"onUpdate:modelValue":u=>l.TSRVF_ITMCD=u,"use-input":"","input-debounce":"500",options:V.value,onFilter:n[0]||(n[0]=(u,B,Y)=>x(u,B,Y,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:m.value,readonly:o.mode==="view"},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"]))]),_:2},1024)]),_:2},1024),e(d,null,{default:a(()=>[o.mode==="view"?(t(),v("div",oe,[e(s,null,{default:a(()=>[i(f(l.TSRVF_PRC.toLocaleString()),1)]),_:2},1024),e(s,{caption:""},{default:a(()=>[i(" Price ")]),_:1})])):(t(),c(b,{key:1,label:"Price",modelValue:l.TSRVF_PRC,"onUpdate:modelValue":u=>l.TSRVF_PRC=u,filled:"",dense:"",readonly:o.mode==="view"},null,8,["modelValue","onUpdate:modelValue","readonly"]))]),_:2},1024),e(d,null,{default:a(()=>[o.mode==="view"?(t(),v("div",ne,[e(s,null,{default:a(()=>[i(f(l.TSRVF_QTY.toLocaleString()),1)]),_:2},1024),e(s,{caption:""},{default:a(()=>[i(" Qty ")]),_:1})])):(t(),c(b,{key:1,label:"Qty",modelValue:l.TSRVF_QTY,"onUpdate:modelValue":u=>l.TSRVF_QTY=u,filled:"",dense:"",readonly:o.mode==="view"},null,8,["modelValue","onUpdate:modelValue","readonly"]))]),_:2},1024),o.mode==="view"?(t(),c(d,{key:0},{default:a(()=>[e(s,null,{default:a(()=>[i(" Rp "+f((parseInt(l.TSRVF_PRC)*parseInt(l.TSRVF_QTY)).toLocaleString()),1)]),_:2},1024),e(s,{caption:""},{default:a(()=>[i(" Total Price ")]),_:1})]),_:2},1024)):T("",!0),y.mode!=="view"?(t(),c(d,{key:1,side:""},{default:a(()=>[e(I,{icon:"delete",flat:"",color:"red",onClick:u=>q(p)},null,8,["onClick"])]),_:2},1024)):T("",!0)]),_:2},1024)),[[R]])),128)),y.mode==="view"?k((t(),c(S,{key:1,class:"q-my-sm",clickable:""},{default:a(()=>[e(d),e(d),e(d),e(d,null,{default:a(()=>[e(s,null,{default:a(()=>[g("span",ie," Rp "+f(A(_.value)),1)]),_:1}),e(s,{caption:""},{default:a(()=>[i(" Total Price ")]),_:1})]),_:1})]),_:1})),[[R]]):T("",!0)]),_:1})]),_:1}),e(W,{align:"right"},{default:a(()=>[e(I,{label:"OK",color:"primary",onClick:n[1]||(n[1]=l=>U()),disable:m.value,loading:m.value},null,8,["disable","loading"]),e(I,{flat:"",label:"Cancel",color:"red",onClick:D(h),loading:m.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};export{re as _};
