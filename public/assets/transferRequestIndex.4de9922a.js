import{t as p,o as S,C as O,D,E as n,F as e,M as K,O as I,J as l,$ as P,R as b,S as k,T as q,a0 as W,Q as y,aZ as Z,X as z,Y as A,Z as G,aI as J,av as X,I as Q,P as w}from"./index.8532c565.js";import{Q as V}from"./QSelect.8f42933d.js";import{Q as j,a as M}from"./QTable.645b5d63.js";import{Q as N,a as B}from"./QTd.8b7c262a.js";import{Q as F}from"./QTooltip.d1b663c0.js";import{api_web as E}from"./axios.5950363f.js";import{u as $}from"./use-quasar.d0aadbe8.js";import{Q as ee,a as ae}from"./QInnerLoading.4afde69e.js";import{u as le}from"./use-dialog-plugin-component.440985e1.js";import"./QItemLabel.9aa1fc9a.js";import"./format.26cf8349.js";import"./QList.c6309999.js";const oe=l("div",{class:"text-h6"},"Request Part",-1),te={style:{border:"1px black solid","border-radius":"10px"}},ne=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Header")],-1),se={class:"row q-col-gutter-md"},ie={class:"col-12"},de={class:"row q-col-gutter-md q-pt-md"},re={class:"col-12 col-sm-6"},ue={class:"col-12 col-sm-6"},ce={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},me=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"List Of Items")],-1),pe={class:"col-12 col-sm-6"},ve={class:"col-12 col-sm-3"},fe={class:"col-12 col-sm-2"},Ce={class:"col-12 col-sm-1"},Oe={__name:"transferRequestPreview",props:{dataHeader:Array,dataDet:Array,qtyOnly:Boolean},setup(g){const R=$(),L=g,c=p({TLOCREQ_DOCNO:"",TLOCREQ_FRLOC:"",TLOCREQ_TOLOC:""}),u=p([]),_=p([]),C=p([]),s=p(!1);S(async()=>{console.log(L),await h(""),await i(""),c.value=L.dataHeader,C.value=L.dataDet});const T=(m,t,o,f)=>{t(async()=>{f==="loc"&&await h(m),f==="item"&&await i(m)})},h=async(m,t="MSUP_SUPNM")=>{s.value=!0,await E.post("location/searchAPI",{searchBy:t,searchValue:m}).then(o=>{s.value=!1,_.value=o.data.data}).catch(o=>{s.value=!1})},i=async m=>{s.value=!0,await E.post("item/searchAPITBL",{searchValue:m}).then(t=>{s.value=!1,u.value=t.data.data}).catch(()=>{s.value=!1})},d=m=>{R.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${m+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{C.value.splice(m,1)})},a=()=>{R.dialog({title:"Confirmation",message:"Are you sure want to send this request ?",cancel:!0,persistent:!0}).onOk(async()=>{s.value=!0})},{dialogRef:v,onDialogHide:U,onDialogOK:Te,onDialogCancel:x}=le();return(m,t)=>(O(),D(G,{ref_key:"dialogRef",ref:v,onHide:A(U),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:n(()=>[e(K,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:n(()=>[e(I,null,{default:n(()=>[oe]),_:1}),e(I,{class:"q-pa-sm"},{default:n(()=>[l("fieldset",te,[ne,e(ee,{showing:s.value,dark:""},{default:n(()=>[e(ae,{size:"50px",color:"primary"})]),_:1},8,["showing"]),l("div",se,[l("div",ie,[e(P,{label:"Doc No",dense:"",filled:"",modelValue:c.value.TLOCREQ_DOCNO,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value.TLOCREQ_DOCNO=o),readonly:g.qtyOnly},null,8,["modelValue","readonly"])])]),l("div",de,[l("div",re,[e(V,{dense:"",filled:"",label:"Transfer From",modelValue:c.value.TLOCREQ_FRLOC,"onUpdate:modelValue":t[1]||(t[1]=o=>c.value.TLOCREQ_FRLOC=o),"use-input":"","input-debounce":"500",options:_.value,onFilter:t[2]||(t[2]=(o,f,r)=>T(o,f,r,"loc")),behavior:"dialog","option-label":"MLOC_LOCNM","option-value":"MLOC_LOCCD","emit-value":"","map-options":"",loading:s.value,readonly:g.qtyOnly},null,8,["modelValue","options","loading","readonly"])]),l("div",ue,[e(V,{dense:"",filled:"",label:"Transfer To",modelValue:c.value.TLOCREQ_TOLOC,"onUpdate:modelValue":t[3]||(t[3]=o=>c.value.TLOCREQ_TOLOC=o),"use-input":"","input-debounce":"500",options:_.value,onFilter:t[4]||(t[4]=(o,f,r)=>T(o,f,r,"loc")),behavior:"dialog","option-label":"MLOC_LOCNM","option-value":"MLOC_LOCCD","emit-value":"","map-options":"",loading:s.value,readonly:g.qtyOnly},null,8,["modelValue","options","loading","readonly"])])])]),l("fieldset",ce,[me,C.value.length>0?(O(!0),b(k,{key:0},q(C.value,(o,f)=>(O(),b("div",{class:"row q-col-gutter-md q-pt-md",key:f},[l("div",pe,[e(V,{dense:"",filled:"",label:"Item Name",modelValue:o.TLOCREQ_ITMCD,"onUpdate:modelValue":r=>o.TLOCREQ_ITMCD=r,"use-input":"","input-debounce":"500",options:u.value,onFilter:t[5]||(t[5]=(r,Y,H)=>T(r,Y,H,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:s.value,readonly:g.qtyOnly},null,8,["modelValue","onUpdate:modelValue","options","loading","readonly"])]),l("div",ve,[e(P,{label:"Qty",dense:"",filled:"",modelValue:o.TLOCREQ_QTY,"onUpdate:modelValue":r=>o.TLOCREQ_QTY=r},null,8,["modelValue","onUpdate:modelValue"])]),l("div",fe,[e(W,{modelValue:o.TLOCREQ_ISREP,"onUpdate:modelValue":r=>o.TLOCREQ_ISREP=r,label:"Is replacement ?",color:"teal","true-value":1,"false-value":0,disable:s.value},null,8,["modelValue","onUpdate:modelValue","disable"])]),l("div",Ce,[e(y,{icon:"delete",color:"red",flat:"",onClick:r=>d(f)},null,8,["onClick"])])]))),128)):Z("",!0)])]),_:1}),e(z,{align:"right"},{default:n(()=>[e(y,{label:"approve",color:"primary",onClick:t[6]||(t[6]=o=>a()),loading:s.value},null,8,["loading"]),e(y,{flat:"",label:"Cancel",color:"red",onClick:A(x)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},_e={class:"q-pa-md"},ge=l("div",{class:"row q-pb-md"},[l("div",{class:"col"},[l("span",{class:"text-h4"},"Transfer Request")]),l("div",{class:"col text-right"})],-1),Le={class:"row q-pt-md"},Re={class:"col"},Ae={__name:"transferRequestIndex",setup(g){const R=$(),L=p([]),c=p([{name:"TLOCREQ_DOCNO",label:"Doc Np",field:"TLOCREQ_DOCNO",sortable:!0,align:"left"},{name:"TLOCREQ_FRLOC",label:"From Location",field:"TLOCREQ_FRLOC",sortable:!0,align:"left"},{name:"TLOCREQ_TOLOC",label:"To Location",field:"TLOCREQ_TOLOC",sortable:!0,align:"left"},{name:"TLOCREQ_ISREP",label:"Is Replacement ?",field:"TLOCREQ_ISREP",sortable:!0,format:i=>`${i==1?"Yes":"No"}`,align:"left"}]),u=p(!1),_=p(""),C=p("");S(()=>{s()});const s=async()=>{u.value=!0,await E.post("inventory/transferRequest/searchAPI",{searchBy:_.value,searchValue:C.value}).then(i=>{u.value=!1,L.value=i.data.data}).catch(i=>{u.value=!1})},T=i=>{R.dialog({component:Oe,componentProps:{dataHeader:i,dataDet:i.detail}}).onOk(async d=>{u.value=!1,onDialogOK()})},h=i=>{R.dialog({title:"Confirmation",message:"Are you sure want to print this transfer ?",cancel:!0,persistent:!0}).onOk(async()=>{u.value=!0,await E.post("inventory/printHandoverPDF",{data:btoa(i)}).then(d=>{u.value=!1,window.open("").document.write("<iframe width='100%' height='100%' src='data:application/pdf;base64, "+encodeURI(d.data)+"'></iframe>")}).catch(d=>{u.value=!1})})};return(i,d)=>(O(),b("div",_e,[ge,e(J),l("div",Le,[l("div",Re,[e(j,{title:"Transfer Request List",rows:L.value,columns:c.value,"row-key":"TDLVORD_DLVCD",loading:u.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":n(()=>[e(V,{outlined:"",modelValue:_.value,"onUpdate:modelValue":d[0]||(d[0]=a=>_.value=a),options:c.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(P,{borderless:"",dense:"",modelValue:C.value,"onUpdate:modelValue":[d[1]||(d[1]=a=>C.value=a),d[2]||(d[2]=a=>i.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:n(()=>[e(X,{name:"search"})]),_:1},8,["modelValue"])]),header:n(a=>[e(N,{props:a},{default:n(()=>[(O(!0),b(k,null,q(a.cols,v=>(O(),D(M,{key:v.name,props:a},{default:n(()=>[Q(w(v.label),1)]),_:2},1032,["props"]))),128)),e(M,{"auto-width":""},{default:n(()=>[Q("Action")]),_:1})]),_:2},1032,["props"])]),body:n(a=>[e(N,{props:a},{default:n(()=>[(O(!0),b(k,null,q(a.cols,v=>(O(),D(B,{key:v.name,props:a},{default:n(()=>[Q(w(v.value),1)]),_:2},1032,["props"]))),128)),e(B,{"auto-width":""},{default:n(()=>[e(y,{flat:"",color:a.row.TLOCREQ_APPRVBY!==null?"grey":"indigo",icon:"checkall",onClick:v=>T(a.row.TLOCREQ_DOCNO),dense:"",disable:a.row.TLOCREQ_APPRVBY!==null},{default:n(()=>[e(F,null,{default:n(()=>[Q(w(a.row.TLOCREQ_APPRVBY!==null?"Request has been approved":"Approve All Data"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(y,{flat:"",color:a.row.TLOCREQ_APPRVBY!==null?"cyan":"grey",icon:"print",onClick:v=>h(a.row.TLOCREQ_DOCNO),dense:"",disable:a.row.TLOCREQ_APPRVBY===null},{default:n(()=>[e(F,null,{default:n(()=>[Q(w(a.row.TLOCREQ_APPRVBY===null?"Please Aprove first":"Print handover request"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Ae as default};
