import{s as f,B as S,C as I,D as a,E as e,J as O,K as m,I as t,Q as w,R as M,aU as k,aV as x,aW as H,aZ as Q,H as u,aX as i,P as N,ap as P,M as q,O as A,o as F,aa as J,S as W}from"./index.74f5703a.js";import{u as $,b as y,Q as Y,j as L,k as _,l as b,c as X,a as Z}from"./use-dialog-plugin-component.0de4d2a6.js";import{d as B}from"./date.b76a9f5f.js";import{api_web as K}from"./axios.9bf64246.js";import{Q as U}from"./QTooltip.1cada893.js";const z={class:"row"},G=t("div",{class:"col"},[t("div",{class:"text-h6"},"Update Used Item")],-1),ee={class:"col text-right"},ae={__name:"serviceOprItemAdd",props:{dataItem:Array},setup(T){const{dialogRef:V,onDialogHide:h,onDialogOK:v,onDialogCancel:D}=$();y();const g=T,d=f([]),l=f(!1),r=()=>{d.value.push({TSRVD_ID:g.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},o=(c,n,p,C)=>{n(async()=>{C==="item"&&await s(c)})},s=async c=>{l.value=!0,await K.post("item/searchAPITBL",{searchValue:c}).then(n=>{l.value=!1,d.value=n.data.data}).catch(()=>{l.value=!1})};return(c,n)=>(S(),I(A,{ref_key:"dialogRef",ref:V,onHide:q(h),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e(O,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(m,null,{default:a(()=>[t("div",z,[G,t("div",ee,[e(w,{icon:"add",outline:"",color:"blue",onClick:r})])])]),_:1}),e(m,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:a(()=>[e(Y,{bordered:""},{default:a(()=>[(S(!0),M(k,null,x(d.value,(p,C)=>H((S(),I(L,{key:C,class:"q-my-sm",clickable:""},{default:a(()=>[e(_,{avatar:""},{default:a(()=>[e(Q,{color:"primary","text-color":"white"},{default:a(()=>[u(i(C+1),1)]),_:2},1024)]),_:2},1024),e(_,null,{default:a(()=>[e(b,null,{default:a(()=>[e(X,{dense:"",filled:"",label:"Item Name",modelValue:p.TSRVF_ITMCD,"onUpdate:modelValue":R=>p.TSRVF_ITMCD=R,"use-input":"","input-debounce":"500",options:d.value,onFilter:n[0]||(n[0]=(R,E,j)=>o(R,E,j,"item")),behavior:"dialog","option-label":"MITM_ITMCD","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:l.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),e(_,null,{default:a(()=>[e(N,{label:"Price",modelValue:p.TSRVF_PRC,"onUpdate:modelValue":R=>p.TSRVF_PRC=R,filled:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)),[[P]])),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}},le={class:"text-h6"},te={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(T){const{dialogRef:V,onDialogHide:h,onDialogOK:v,onDialogCancel:D}=$(),g=y(),d=T,l=f({SRVH_DOCNO:"",SRVH_ISSDT:B.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),r=f([]);F(async()=>{d.header&&(l.value=d.header,r.value=d.detail)});const o=s=>{g.dialog({component:ae,componentProps:{dataItem:s}}).onOk(async c=>{console.log(c)})};return(s,c)=>(S(),I(A,{ref_key:"dialogRef",ref:V,onHide:q(h),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e(O,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(m,null,{default:a(()=>[t("div",le,"Update Order "+i(l.value.SRVH_DOCNO),1)]),_:1}),e(m,{class:"q-pa-sm"},{default:a(()=>[e(Y,{bordered:""},{default:a(()=>[(S(!0),M(k,null,x(r.value,(n,p)=>H((S(),I(L,{key:p,class:"q-my-sm",clickable:""},{default:a(()=>[e(_,{avatar:""},{default:a(()=>[e(Q,{color:"primary","text-color":"white"},{default:a(()=>[u(i(n.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),e(_,null,{default:a(()=>[e(b,null,{default:a(()=>[u(i(n.TSRVD_ITMCD),1)]),_:2},1024),e(b,{caption:"",lines:"1"},{default:a(()=>[u("Item")]),_:1})]),_:2},1024),e(_,null,{default:a(()=>[e(b,null,{default:a(()=>[u(i(n.TSRVD_CUSTRMK),1)]),_:2},1024),e(b,{caption:"",lines:"1"},{default:a(()=>[u("Customer Remarks")]),_:1})]),_:2},1024),e(_,{side:""},{default:a(()=>[e(w,{icon:"construction",color:"green",flat:"",onClick:C=>o(n)},{default:a(()=>[e(U,null,{default:a(()=>[u("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(_,{side:""},{default:a(()=>[e(w,{icon:"visibility",color:"cyan",flat:"",onClick:c[0]||(c[0]=C=>s.viewAddedItem()),disable:!n.listFixDet},{default:a(()=>[e(U,null,{default:a(()=>[u("View Added Item")]),_:1})]),_:2},1032,["disable"])]),_:2},1024)]),_:2},1024)),[[P]])),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}},oe={class:"q-pa-md"},se={class:"row"},ne={class:"col"},de={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ie={class:"text-h5 text-bold"},re={class:"text-h6 text-bold"},ce={class:"text-subtitle2"},ue={class:"text-h6 text-bold"},_e=t("div",{class:"text-subtitle2"},"Resolved Items",-1),fe={class:"row"},me={class:"col"},pe=t("div",{class:"col text-right"},null,-1),Ce={__name:"serviceOprView",setup(T){const V=y();f([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:l=>l.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:l=>l.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const h=f([]),v=f(""),D=f(!1);F(()=>{g()});const g=async()=>{D.value=!0,await K.post("servicesOPR/search",{searchBy:"",searchValue:v.value}).then(l=>{D.value=!1,h.value=l.data.data}).catch(l=>{D.value=!1})},d=l=>{const r={SRVH_DOCNO:l.SRVH_DOCNO,SRVH_ISSDT:B.formatDate(l.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:l.MCUS_CUSCD};let o=[];l.detail.map(s=>{o.push({TSRVD_ITMCD:s.TSRVD_ITMCD,TSRVD_LINE:s.TSRVD_LINE,TSRVD_QTY:s.TSRVD_QTY,TSRVD_CUSTRMK:s.TSRVD_CUSTRMK})}),V.dialog({component:te,componentProps:{header:r,detail:o}}).onOk(async s=>{g()})};return(l,r)=>(S(),M("div",oe,[t("div",se,[t("div",ne,[e(Z,{grid:"",flat:"",bordered:"","card-container-class":l.cardContainerClass,title:"Outstanding Order",rows:h.value,columns:l.columns,"row-key":"name",filter:v.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":l.rowsPerPageOptions,loading:D.value},{"top-right":a(()=>[e(N,{borderless:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=o=>v.value=o),placeholder:"Search"},{append:a(()=>[e(J,{name:"search"})]),_:1},8,["modelValue"])]),item:a(o=>[t("div",de,[e(O,{flat:"",bordered:""},{default:a(()=>[e(m,{class:"text-center bg-secondary text-white"},{default:a(()=>[t("div",ie,i(o.row.SRVH_DOCNO),1)]),_:2},1024),e(W),e(m,null,{default:a(()=>[t("div",re,i(o.row.MCUS_CUSNM),1),t("div",ce,i(o.row.SRVH_ISSDT),1)]),_:2},1024),e(m,null,{default:a(()=>[t("div",ue,i(o.row.resolve.length)+" of "+i(o.row.unresolve.length),1),_e]),_:2},1024),e(m,null,{default:a(()=>[t("div",fe,[t("div",me,[e(w,{label:"Resolve",color:"primary",outline:"",onClick:s=>d(o.row)},null,8,["onClick"])]),pe])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{Ce as default};
