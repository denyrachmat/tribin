import{Q as b}from"./QTooltip.ee8f8141.js";import{s as c,o as B,B as f,C as h,D as l,E as e,J as ee,K as Y,I as o,P as V,L as le,Q as C,M as q,O as ae,aa as te,aW as j,R as $,H as p,aY as P,aU as E,aV as L,aZ as de,aX as K,ap as ie,S as ue}from"./index.93ddd96d.js";import{u as oe,b as F,c as Q,Q as re,j as G,k as R,l as J,a as me,m as W}from"./use-dialog-plugin-component.d3193f33.js";import{Q as X,a as Z}from"./use-cache.b0c9bfbc.js";import{d as x}from"./date.b75d9522.js";import{api_web as k}from"./axios.a98c9a66.js";import{Q as ce,a as _e,C as ve}from"./ClosePopup.7dc81c91.js";const pe=o("div",{class:"text-h6"},"Create Item Master",-1),fe={class:"row"},Ce={class:"col"},Me={class:"col q-pl-md"},De={class:"row q-pt-md"},Se={class:"col"},Ve={class:"col q-pl-md"},Te={class:"row q-pt-md"},Ie={class:"col"},ge={class:"col q-pl-md"},be={class:"row q-pt-md"},he={class:"col"},we={__name:"itemCreate",props:{ItemCat:String},setup(A){const{dialogRef:y,onDialogHide:w,onDialogOK:O,onDialogCancel:U}=oe(),I=F(),n=c({MITM_ITMCD:"",MITM_ITMNM:"",MITM_STKUOM:"",MITM_ITMTYPE:1,MITM_BRAND:"",MITM_MODEL:"",MITM_SPEC:"",MITM_ITMCAT:"",MITM_COACD:"",MITM_ITMCAT:""}),r=c(!1),S=c([]),g=c([]),M=A;B(()=>{v(),n.value.MITM_ITMCAT=M.ItemCat});const m=(t,a,u,H)=>{a(async()=>{await k.post("item/getListCoasAPI",{search:t}).then(N=>{g.value=N.data})})},d=()=>{I.dialog({title:"Confirmation",message:"Do you want to save this item ?",cancel:!0,persistent:!0}).onOk(async()=>{await k.post("item",n.value).then(t=>{O(t.data.data.value)})})},v=async()=>{r.value=!0,await k.get("item/formAPI").then(t=>{r.value=!1,S.value=t.data.uoms,g.value=t.data.coas}).catch(()=>{r.value=!1})};return(t,a)=>(f(),h(ae,{ref_key:"dialogRef",ref:y,onHide:q(w),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(ee,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(Y,null,{default:l(()=>[pe]),_:1}),e(Y,{class:"q-pa-sm"},{default:l(()=>[o("div",fe,[o("div",Ce,[e(V,{label:"Item Code",dense:"",modelValue:n.value.MITM_ITMCD,"onUpdate:modelValue":a[0]||(a[0]=u=>n.value.MITM_ITMCD=u),filled:""},null,8,["modelValue"])]),o("div",Me,[e(V,{label:"Item Name",dense:"",modelValue:n.value.MITM_ITMNM,"onUpdate:modelValue":a[1]||(a[1]=u=>n.value.MITM_ITMNM=u),filled:""},null,8,["modelValue"])])]),o("div",De,[o("div",Se,[e(Q,{dense:"",filled:"",label:"UOM",modelValue:n.value.MITM_STKUOM,"onUpdate:modelValue":a[2]||(a[2]=u=>n.value.MITM_STKUOM=u),options:S.value,behavior:"dialog","option-label":"MUOM_UOMNM","option-value":"MUOM_UOMCD","emit-value":"","map-options":"",loading:r.value},null,8,["modelValue","options","loading"])]),o("div",Ve,[e(V,{label:"Item Brand",dense:"",modelValue:n.value.MITM_BRAND,"onUpdate:modelValue":a[3]||(a[3]=u=>n.value.MITM_BRAND=u),filled:""},null,8,["modelValue"])])]),o("div",Te,[o("div",Ie,[e(V,{label:"Item Model",dense:"",modelValue:n.value.MITM_MODEL,"onUpdate:modelValue":a[4]||(a[4]=u=>n.value.MITM_MODEL=u),filled:""},null,8,["modelValue"])]),o("div",ge,[e(V,{label:"Item Specification",dense:"",modelValue:n.value.MITM_SPEC,"onUpdate:modelValue":a[5]||(a[5]=u=>n.value.MITM_SPEC=u),filled:""},null,8,["modelValue"])])]),o("div",be,[o("div",he,[e(Q,{dense:"",filled:"",label:"COA",modelValue:n.value.MITM_COACD,"onUpdate:modelValue":a[6]||(a[6]=u=>n.value.MITM_COACD=u),options:g.value,"use-input":"",behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD",onFilter:a[7]||(a[7]=(u,H,N)=>m(u,H,N)),"emit-value":"","map-options":"",loading:r.value},null,8,["modelValue","options","loading"])])])]),_:1}),e(le,{align:"right"},{default:l(()=>[e(C,{label:"OK",color:"primary",onClick:a[8]||(a[8]=u=>d())}),e(C,{flat:"",label:"Cancel",color:"red",onClick:q(U)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Oe=o("div",{class:"text-h6"},"Create Order",-1),Re={style:{border:"1px black solid","border-radius":"10px"}},ke=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),ye={class:"row"},Ue={class:"col"},Ne={class:"col q-pl-md"},$e={class:"row items-center justify-end"},Qe={class:"row"},Ae={class:"col"},He={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},Ye=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Detail Items")],-1),qe={key:0,class:"row q-pb-sm"},Pe={class:"col text-right"},z={__name:"serviceCreateOrder",props:{header:Array,detail:Array,mode:String},setup(A){const{dialogRef:y,onDialogHide:w,onDialogOK:O,onDialogCancel:U}=oe(),I=F(),n=A;B(async()=>{n.header&&(await v(),await t(),r.value=n.header,M.value=n.detail)});const r=c({SRVH_DOCNO:"",SRVH_ISSDT:x.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),S=c([]),g=c([]),M=c([]),m=c(!1),d=(_,s,i,T)=>{s(async()=>{T==="cust"&&await v(_),T==="item"&&await t(_)})},v=async _=>{m.value=!0,await k.post("customer/searchAPI",{searchValue:_}).then(s=>{m.value=!1,g.value=s.data.data}).catch(()=>{m.value=!1})},t=async _=>{m.value=!0,await k.post("item/searchAPI",{searchValue:_}).then(s=>{m.value=!1,S.value=s.data.data}).catch(()=>{m.value=!1})},a=()=>{M.value.push({TSRVD_ITMCD:"",TSRVD_LINE:M.value.length+1,TSRVD_QTY:1,TSRVD_CUSTRMK:""})},u=_=>{I.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${_+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{M.value.splice(_,1)})},H=_=>{I.dialog({component:we,componentProps:{ItemCat:"SERVICE_ITEMM"}}).onOk(async s=>{await t(""),M.value[_].TSRVD_ITMCD=s.MITM_ITMNM})},N=()=>{I.dialog({title:"Confirmation",message:"Do you want to submit this data ?",cancel:!0,persistent:!0}).onOk(async()=>{m.value=!0,await k.post("servicesAdmin",{header:r.value,detail:M.value}).then(_=>{m.value=!1,O()})})};return(_,s)=>(f(),h(ae,{ref_key:"dialogRef",ref:y,onHide:q(w),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(ee,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(Y,null,{default:l(()=>[Oe]),_:1}),e(Y,{class:"q-pa-sm"},{default:l(()=>[o("fieldset",Re,[ke,o("div",ye,[o("div",Ue,[e(V,{label:"SPK No",readonly:"",dense:"",modelValue:r.value.SRVH_DOCNO,"onUpdate:modelValue":s[0]||(s[0]=i=>r.value.SRVH_DOCNO=i),filled:""},null,8,["modelValue"])]),o("div",Ne,[e(V,{filled:"",modelValue:r.value.SRVH_ISSDT,"onUpdate:modelValue":s[2]||(s[2]=i=>r.value.SRVH_ISSDT=i),dense:"",label:"Issue Date",loading:m.value,onClick:s[3]||(s[3]=i=>_.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD",readonly:n.mode==="view"},{append:l(()=>[e(te,{name:"event",class:"cursor-pointer",disable:n.mode==="view"},{default:l(()=>[e(ce,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(_e,{modelValue:r.value.SRVH_ISSDT,"onUpdate:modelValue":s[1]||(s[1]=i=>r.value.SRVH_ISSDT=i),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",$e,[j(e(C,{label:"Close",color:"primary",flat:""},null,512),[[ve]])])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["disable"])]),_:1},8,["modelValue","loading","readonly"])])]),o("div",Qe,[o("div",Ae,[e(Q,{dense:"",filled:"",label:"Customer Choose",modelValue:r.value.SRVH_CUSCD,"onUpdate:modelValue":s[4]||(s[4]=i=>r.value.SRVH_CUSCD=i),"use-input":"","input-debounce":"500",options:g.value,onFilter:s[5]||(s[5]=(i,T,D)=>d(i,T,D,"cust")),behavior:"dialog","option-label":"MCUS_CUSNM","option-value":"MCUS_CUSCD","emit-value":"","map-options":"",loading:m.value,readonly:n.mode==="view"},null,8,["modelValue","options","loading","readonly"])])])]),o("fieldset",He,[Ye,n.mode!=="view"?(f(),$("div",qe,[o("div",Pe,[e(C,{flat:"",icon:"add",color:"blue",onClick:s[6]||(s[6]=i=>a())},{default:l(()=>[e(b,null,{default:l(()=>[p("Add lines")]),_:1})]),_:1})])])):P("",!0),e(re,{bordered:"",dense:""},{default:l(()=>[M.value.length>0?(f(!0),$(E,{key:0},L(M.value,(i,T)=>(f(),h(G,{key:T,class:"q-my-sm",dense:""},{default:l(()=>[e(R,{avatar:""},{default:l(()=>[e(de,{"text-color":"blue"},{default:l(()=>[p(K(T+1),1)]),_:2},1024)]),_:2},1024),e(R,null,{default:l(()=>[e(J,null,{default:l(()=>[e(Q,{dense:"",filled:"",label:"Item Name",modelValue:i.TSRVD_ITMCD,"onUpdate:modelValue":D=>i.TSRVD_ITMCD=D,"use-input":"","input-debounce":"500",options:S.value,onFilter:s[7]||(s[7]=(D,ne,se)=>d(D,ne,se,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:m.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),e(R,null,{default:l(()=>[e(V,{label:"Qty",filled:"",dense:"",modelValue:i.TSRVD_QTY,"onUpdate:modelValue":D=>i.TSRVD_QTY=D},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(R,null,{default:l(()=>[e(V,{label:"Problem",filled:"",dense:"",modelValue:i.TSRVD_CUSTRMK,"onUpdate:modelValue":D=>i.TSRVD_CUSTRMK=D},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),n.mode!=="view"?(f(),h(R,{key:0,side:""},{default:l(()=>[e(C,{icon:"delete",color:"red",flat:"",onClick:D=>u(T)},{default:l(()=>[e(b,null,{default:l(()=>[p("Delete line")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):P("",!0),n.mode!=="view"?(f(),h(R,{key:1,side:""},{default:l(()=>[e(C,{icon:"library_add",color:"indigo",flat:"",onClick:D=>H(T)},{default:l(()=>[e(b,null,{default:l(()=>[p("Add new item")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)):P("",!0)]),_:2},1024))),128)):j((f(),h(G,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(R,null,{default:l(()=>[e(J,null,{default:l(()=>[p(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[ie]])]),_:1})])]),_:1}),e(le,{align:"right"},{default:l(()=>[e(C,{label:"OK",color:"primary",onClick:s[8]||(s[8]=i=>N()),disable:m.value,loading:m.value},null,8,["disable","loading"]),e(C,{flat:"",label:"Cancel",color:"red",onClick:q(U),loading:m.value},null,8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const Ee={class:"q-pa-md"},Le={class:"row q-pb-md"},Ke=o("div",{class:"col"},[o("span",{class:"text-h4"},"Receive Order ")],-1),xe={class:"col text-right"},Be={class:"row q-pt-md"},Fe={class:"col"},el={__name:"serviceView",setup(A){const y=F(),w=c("SRVH_DOCNO"),O=c(""),U=c([]),I=c([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Cust",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left",format:d=>x.formatDate(new Date(d),"DD MMM YYYY")}]),n=c(!1),r=c(null);B(()=>{S(),r.value=setInterval(()=>{S()},1e4)});const S=async()=>{n.value=!0,await k.post("servicesAdmin/search",{searchBy:w.value,searchValue:O.value}).then(d=>{n.value=!1,U.value=d.data.data}).catch(d=>{n.value=!1})},g=()=>{y.dialog({component:z}).onOk(async d=>{S()})},M=d=>{window.open("https://joss.jatpowerindo.co.id/PDF/quotation/"+btoa(d),"_blank").focus()},m=d=>{const v={SRVH_DOCNO:d.SRVH_DOCNO,SRVH_ISSDT:x.formatDate(d.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:d.MCUS_CUSCD};let t=[];d.detail.map(a=>{t.push({TSRVD_ITMCD:a.TSRVD_ITMCD,TSRVD_LINE:a.TSRVD_LINE,TSRVD_QTY:a.TSRVD_QTY,TSRVD_CUSTRMK:a.TSRVD_CUSTRMK})}),y.dialog({component:z,componentProps:{header:v,detail:t}}).onOk(async a=>{S()})};return(d,v)=>(f(),$("div",Ee,[o("div",Le,[Ke,o("div",xe,[e(C,{icon:"add",color:"blue",onClick:g},{default:l(()=>[e(b,null,{default:l(()=>[p("Create New Order")]),_:1})]),_:1})])]),e(ue),o("div",Be,[o("div",Fe,[e(me,{title:"Created Order",rows:U.value,columns:I.value,"row-key":"name",loading:n.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(Q,{outlined:"",modelValue:w.value,"onUpdate:modelValue":v[0]||(v[0]=t=>w.value=t),options:I.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(V,{borderless:"",dense:"",modelValue:O.value,"onUpdate:modelValue":[v[1]||(v[1]=t=>O.value=t),v[2]||(v[2]=t=>d.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(te,{name:"search"})]),_:1},8,["modelValue"])]),header:l(t=>[e(X,{props:t},{default:l(()=>[(f(!0),$(E,null,L(t.cols,a=>(f(),h(W,{key:a.name,props:t},{default:l(()=>[p(K(a.label),1)]),_:2},1032,["props"]))),128)),e(W,{"auto-width":""},{default:l(()=>[p("Action")]),_:1})]),_:2},1032,["props"])]),body:l(t=>[e(X,{props:t},{default:l(()=>[(f(!0),$(E,null,L(t.cols,a=>(f(),h(Z,{key:a.name,props:t},{default:l(()=>[p(K(a.value),1)]),_:2},1032,["props"]))),128)),e(Z,{"auto-width":""},{default:l(()=>[e(C,{flat:"",color:"orange",icon:"edit",onClick:a=>m(t.row),dense:"",disable:t.row.detail.filter(a=>a.TSRVD_FLGSTS>0).length>0},{default:l(()=>[e(b,null,{default:l(()=>[p("Edit this Order")]),_:1})]),_:2},1032,["onClick","disable"]),e(C,{flat:"",color:"indigo",icon:"print",onClick:a=>M(t.row.SRVH_DOCNO),dense:"",disable:t.row.detail.filter(a=>a.TSRVD_FLGSTS>0).length>0},{default:l(()=>[e(b,null,{default:l(()=>[p("Print this order")]),_:1})]),_:2},1032,["onClick","disable"]),e(C,{flat:"",color:"red",icon:"delete",onClick:a=>d.onClickDelete(t.row.SRVH_DOCNO),dense:"",disable:t.row.detail.filter(a=>a.TSRVD_FLGSTS>0).length>0},{default:l(()=>[e(b,null,{default:l(()=>[p("Delete this Order")]),_:1})]),_:2},1032,["onClick","disable"]),e(C,{flat:"",color:"red",icon:"delete",onClick:a=>d.onClickView(t.row.SRVH_DOCNO),dense:"",disable:t.row.detail.filter(a=>a.TSRVD_FLGSTS>0).length===0},{default:l(()=>[e(b,null,{default:l(()=>[p("View this Order")]),_:1})]),_:2},1032,["onClick","disable"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{el as default};
