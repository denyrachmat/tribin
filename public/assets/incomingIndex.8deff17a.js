import{Q as U}from"./QTooltip.14f8cf64.js";import{t as c,C,D as S,E as l,F as e,M as J,O as N,J as t,$ as y,an as x,U as q,Q as g,R as w,S as k,T as O,V as K,I as _,P as M,W,X,Z,o as ee,aY as le}from"./index.2b6ccfed.js";import{a as B,l as I,Q as ae,b as $,c as V,d as T,k as oe,m as L}from"./QTable.138991fc.js";import{Q as A,a as H}from"./QTd.c33a93db.js";import{api_web as P}from"./axios.a9555440.js";import{Q as te,a as se}from"./QInnerLoading.d95b1885.js";import{Q as ne,a as ie,C as de}from"./ClosePopup.e0a558d8.js";import{Q as ue}from"./QBtnToggle.8b654a8d.js";import"./use-render-cache.3aae9b27.js";import"./date.6e44ef68.js";import"./QBtnGroup.82df59ef.js";const re=t("div",{class:"text-h6"},"Create Incoming",-1),ce={style:{border:"1px black solid","border-radius":"10px"}},pe=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"Header")],-1),me={class:"row q-col-gutter-md"},_e={class:"col-12 col-sm-6"},ve={class:"col-12 col-sm-6"},fe={class:"row items-center justify-end"},Ce={class:"row q-col-gutter-md"},ge={class:"col-12 col-sm-6"},Ve={class:"col-12 col-sm-6"},be={class:"row q-py-md"},Te={class:"col"},De={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},he=t("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[t("b",null,"List Of Items")],-1),ye={class:"row q-pb-sm"},Se={class:"col text-right"},Re={__name:"incomingCreate",props:{dataHeader:Array},setup(F){const Q=B(),n=c({TRCV_RCVCD:"",TRCV_SUPCD:"",TRCV_ISSUDT:""}),D=c(1),v=c([]),s=c(!1),b=c([]),R=c([]),h=c([]),u=(d,o,a,m)=>{o(async()=>{m==="cust"&&i(d),m==="item"&&await p(d),m==="po"&&await f(d)})},p=async d=>{s.value=!0,await P.post("item/searchAPI",{searchValue:d}).then(o=>{s.value=!1,h.value=o.data.data}).catch(()=>{s.value=!1})},i=async(d,o="MSUP_SUPNM")=>{s.value=!0,await P.post("supplier/searchAPI",{searchValue:d,searchCol:o}).then(a=>{s.value=!1,b.value=a.data.data}).catch(()=>{s.value=!1})},f=async(d,o="TPCHORD_PCHCD")=>{s.value=!0,await P.post("purchase-order/searchApprovedPO",{searchValue:d,searchCol:o}).then(a=>{s.value=!1,R.value=a.data.data}).catch(()=>{s.value=!1})},E=d=>{Q.dialog({title:"Confirmation",message:`Do you want to delete this lines no ${d+1} ?`,cancel:!0,persistent:!0}).onOk(async()=>{v.value.splice(d,1)})},Y=()=>{v.value.push({item_code:"",MITM_ITMNM:"",quantity:"",unit_price:""})},j=()=>{};return(d,o)=>(C(),S(Z,{ref:"dialogRef",onHide:d.onDialogHide,"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(J,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(N,null,{default:l(()=>[re]),_:1}),e(N,{class:"q-pa-sm"},{default:l(()=>[t("fieldset",ce,[pe,e(te,{showing:s.value,dark:""},{default:l(()=>[e(se,{size:"50px",color:"primary"})]),_:1},8,["showing"]),t("div",me,[t("div",_e,[e(y,{label:"Code",readonly:"",dense:"",filled:"",modelValue:n.value.TRCV_RCVCD,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value.TRCV_RCVCD=a)},null,8,["modelValue"])]),t("div",ve,[e(y,{filled:"",modelValue:n.value.TRCV_ISSUDT,"onUpdate:modelValue":o[2]||(o[2]=a=>n.value.TRCV_ISSUDT=a),dense:"",label:"Receive Date"},{append:l(()=>[e(x,{name:"event",class:"cursor-pointer"},{default:l(()=>[e(ne,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[e(ie,{modelValue:n.value.TRCV_ISSUDT,"onUpdate:modelValue":o[1]||(o[1]=a=>n.value.TRCV_ISSUDT=a),mask:"YYYY-MM-DD"},{default:l(()=>[t("div",fe,[q(e(g,{label:"Close",color:"primary",flat:""},null,512),[[de]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),t("div",Ce,[t("div",ge,[e(I,{dense:"",filled:"",label:"Supplier Name",modelValue:n.value.TRCV_SUPCD,"onUpdate:modelValue":o[3]||(o[3]=a=>n.value.TRCV_SUPCD=a),"use-input":"","input-debounce":"500",options:b.value,onFilter:o[4]||(o[4]=(a,m,r)=>u(a,m,r,"cust")),behavior:"dialog","option-label":"MSUP_SUPNM","option-value":"MSUP_SUPCD","emit-value":"","map-options":"",loading:s.value,disable:n.value.TRCV_RCVCD!==""||D.value==1},null,8,["modelValue","options","loading","disable"])]),t("div",Ve,[e(I,{dense:"",filled:"",label:"PO Number",modelValue:n.value.PO_NO,"onUpdate:modelValue":o[5]||(o[5]=a=>n.value.PO_NO=a),"use-input":"","input-debounce":"500",options:R.value,onFilter:o[6]||(o[6]=(a,m,r)=>u(a,m,r,"po")),behavior:"dialog","option-label":"PO_CUSTDESC","option-value":"TPCHORD_PCHCD","emit-value":"","map-options":"",loading:s.value,disable:n.value.TRCV_RCVCD!==""},null,8,["modelValue","options","loading","disable"])])])]),t("div",be,[t("div",Te,[e(ue,{modelValue:D.value,"onUpdate:modelValue":o[7]||(o[7]=a=>D.value=a),spread:"","no-caps":"","toggle-color":"purple",color:"white","text-color":"black",options:[{label:"From PO",value:1},{label:"Return",value:2}],disable:n.value.TRCV_RCVCD!==""},null,8,["modelValue","disable"])])]),t("fieldset",De,[he,t("div",ye,[t("div",Se,[e(g,{flat:"",icon:"add",color:"blue",label:"Add Lines",onClick:Y,loading:s.value},null,8,["loading"])])]),e(ae,{bordered:"",dense:""},{default:l(()=>[v.value.length>0?(C(!0),w(k,{key:0},O(v.value,(a,m)=>(C(),S($,{key:m,class:"q-my-sm",dense:"",loading:s.value},{default:l(()=>[e(V,{avatar:""},{default:l(()=>[e(K,{"text-color":"blue"},{default:l(()=>[_(M(m+1),1)]),_:2},1024)]),_:2},1024),e(V,null,{default:l(()=>[e(T,null,{default:l(()=>[e(I,{dense:"",filled:"",label:"Item Code",modelValue:a.item_code,"onUpdate:modelValue":r=>a.item_code=r,"use-input":"","input-debounce":"500",options:h.value,onFilter:o[8]||(o[8]=(r,z,G)=>u(r,z,G,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:s.value,disable:n.value.TRCV_RCVCD!==""},null,8,["modelValue","onUpdate:modelValue","options","loading","disable"])]),_:2},1024)]),_:2},1024),e(V,null,{default:l(()=>[e(T,null,{default:l(()=>[e(y,{dense:"",label:"Item Name",filled:"",modelValue:a.MITM_ITMNM,"onUpdate:modelValue":r=>a.MITM_ITMNM=r,readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(V,null,{default:l(()=>[e(T,null,{default:l(()=>[e(y,{dense:"",label:"Qty",filled:"",modelValue:a.quantity,"onUpdate:modelValue":r=>a.quantity=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(V,null,{default:l(()=>[e(T,null,{default:l(()=>[_(" Rp. "+M(a.unit_price.toLocaleString()),1)]),_:2},1024),e(T,{caption:""},{default:l(()=>[_(" Price ")]),_:1})]),_:2},1024),e(V,{side:""},{default:l(()=>[e(g,{icon:"delete",color:"red",flat:"",onClick:r=>E(m)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["loading"]))),128)):q((C(),S($,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[e(V,null,{default:l(()=>[e(T,null,{default:l(()=>[_(" Choose sales order first to access item list ")]),_:1})]),_:1})]),_:1})),[[W]])]),_:1})])]),_:1}),e(X,{align:"right"},{default:l(()=>[e(g,{label:"OK",color:"primary",onClick:o[9]||(o[9]=a=>j()),disable:d.stateSubmit,loading:s.value},null,8,["disable","loading"]),e(g,{flat:"",label:"Cancel",color:"red",onClick:d.onDialogCancel},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},we={class:"q-pa-md"},Ie={class:"row q-pb-md"},Pe=t("div",{class:"col"},[t("span",{class:"text-h4"},"Incoming")],-1),Me={class:"col text-right"},Qe={class:"row q-pt-md"},Ue={class:"col"},Ee={__name:"incomingIndex",setup(F){const Q=B(),n=c([]),D=c([{name:"TRCV_RCVCD",label:"Receive ID",field:"TRCV_RCVCD",sortable:!0,align:"left"},{name:"MSUP_SUPNM",label:"Supplier Name",field:"MSUP_SUPNM",sortable:!0,align:"left"},{name:"TOT_RCV",label:"Total Qty",field:"TOT_RCV",sortable:!0,align:"left"},{name:"TOT_AMT",label:"Total Amount",field:"TOT_AMT",sortable:!0,align:"left"}]),v=c(!1),s=c(""),b=c("");ee(()=>{R()});const R=async()=>{v.value=!0,await P.post("receive/searchAPI",{searchBy:s.value,searchValue:b.value}).then(u=>{v.value=!1,n.value=u.data.data}).catch(u=>{v.value=!1})},h=(u=[])=>{Q.dialog({component:Re,componentProps:{dataHeader:u}}).onOk(async p=>{getOutgoingData()})};return(u,p)=>(C(),w("div",we,[t("div",Ie,[Pe,t("div",Me,[e(g,{icon:"add",color:"blue",onClick:p[0]||(p[0]=i=>h())},{default:l(()=>[e(U,null,{default:l(()=>[_("Create New Delivery")]),_:1})]),_:1})])]),e(le),t("div",Qe,[t("div",Ue,[e(oe,{title:"Outgoing List",rows:n.value,columns:D.value,"row-key":"TDLVORD_DLVCD",loading:v.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(I,{outlined:"",modelValue:s.value,"onUpdate:modelValue":p[1]||(p[1]=i=>s.value=i),options:u.columns,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(y,{borderless:"",dense:"",modelValue:b.value,"onUpdate:modelValue":[p[2]||(p[2]=i=>b.value=i),p[3]||(p[3]=i=>u.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(x,{name:"search"})]),_:1},8,["modelValue"])]),header:l(i=>[e(A,{props:i},{default:l(()=>[(C(!0),w(k,null,O(i.cols,f=>(C(),S(L,{key:f.name,props:i},{default:l(()=>[_(M(f.label),1)]),_:2},1032,["props"]))),128)),e(L,{"auto-width":""},{default:l(()=>[_("Action")]),_:1})]),_:2},1032,["props"])]),body:l(i=>[e(A,{props:i},{default:l(()=>[(C(!0),w(k,null,O(i.cols,f=>(C(),S(H,{key:f.name,props:i},{default:l(()=>[_(M(f.value),1)]),_:2},1032,["props"]))),128)),e(H,{"auto-width":""},{default:l(()=>[e(g,{flat:"",color:"orange",icon:"edit",onClick:f=>h(i.row),dense:""},{default:l(()=>[e(U,null,{default:l(()=>[_("Edit Data")]),_:1})]),_:2},1032,["onClick"]),e(g,{flat:"",color:"red",icon:"delete",onClick:f=>u.onDelete(i.row.TDLVORD_DLVCD),dense:""},{default:l(()=>[e(U,null,{default:l(()=>[_("Edit Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Ee as default};
