import{t as m,o as F,C,D as I,E as l,F as e,M as K,O as S,J as o,$ as P,R,S as k,T as M,a0 as z,aZ as W,X,Q as V,Y as A,Z,aI as G,av as J,I as L,P as y}from"./index.fbaa8e6e.js";import{Q as E}from"./QSelect.3af19949.js";import{Q as j,a as N}from"./QTable.d4d8b0c1.js";import{Q as x,a as U}from"./QTd.82d7d05a.js";import{Q as B}from"./QTooltip.38cb899f.js";import{api_web as D}from"./axios.482bf1c0.js";import{u as Y}from"./use-quasar.c13079c3.js";import{Q as ee,a as ae}from"./QInnerLoading.6d459b73.js";import{u as le}from"./use-dialog-plugin-component.b5c304fd.js";import"./QItemLabel.2bebefc9.js";import"./format.be99eea1.js";import"./QList.cfa77c5b.js";const oe=o("div",{class:"text-h6"},"Request Part",-1),te={style:{border:"1px black solid","border-radius":"10px"}},ne=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),se={class:"row q-col-gutter-md"},ie={class:"col-12"},re={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},de=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"List Of Items")],-1),ue={class:"col-12 col-sm-3"},ce={class:"col-12 col-sm-3"},me={class:"col-12 col-sm-3"},pe={class:"col-12 col-sm-2"},Ce={class:"col-12 col-sm-1"},_e={__name:"transferRequestPreview",props:{dataHeader:Array,dataDet:Array,qtyOnly:Boolean},setup(q){const h=Y(),O=q,v=m({TLOCREQ_DOCNO:"",TLOCREQ_FRLOC:"",TLOCREQ_TOLOC:""}),u=m([]),_=m([]),f=m([]),r=m(!1);F(async()=>{console.log(O),await b(""),await d(""),v.value=O.dataHeader,O.dataDet.map(n=>{f.value.push({...n,TLOCREQ_QTY:a(n.TLOCREQ_ITMCD).STOCK>=n.TLOCREQ_QTY?n.TLOCREQ_QTY:a(n.TLOCREQ_ITMCD).STOCK,IS_STOCK_EX:a(n.TLOCREQ_ITMCD).STOCK>=n.TLOCREQ_QTY})})});const T=(n,t,s,w)=>{t(async()=>{w==="loc"&&await b(n),w==="item"&&await d(n)})},b=async(n,t="MSUP_SUPNM")=>{r.value=!0,await D.post("location/searchAPI",{searchBy:t,searchValue:n}).then(s=>{r.value=!1,_.value=s.data.data}).catch(s=>{r.value=!1})},d=async n=>{r.value=!0,await D.post("item/searchAPITBL",{searchValue:n}).then(t=>{r.value=!1,u.value=t.data.data}).catch(()=>{r.value=!1})},c=()=>{h.dialog({title:"Confirmation",message:"Are you sure want to send this request ?",cancel:!0,persistent:!0}).onOk(async()=>{r.value=!0})},a=n=>u.value.filter(t=>t.MITM_ITMCD==n)[0],{dialogRef:p,onDialogHide:$,onDialogOK:ge,onDialogCancel:H}=le();return(n,t)=>(C(),I(Z,{ref_key:"dialogRef",ref:p,onHide:A($),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[e(K,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[e(S,null,{default:l(()=>[oe]),_:1}),e(S,{class:"q-pa-sm"},{default:l(()=>[o("fieldset",te,[ne,e(ee,{showing:r.value,dark:""},{default:l(()=>[e(ae,{size:"50px",color:"primary"})]),_:1},8,["showing"]),o("div",se,[o("div",ie,[e(P,{label:"Doc No",dense:"",filled:"",modelValue:v.value.TLOCREQ_DOCNO,"onUpdate:modelValue":t[0]||(t[0]=s=>v.value.TLOCREQ_DOCNO=s),readonly:!0},null,8,["modelValue"])])])]),o("fieldset",re,[de,f.value.length>0?(C(!0),R(k,{key:0},M(f.value,(s,w)=>(C(),R("div",{class:"row q-col-gutter-md q-pt-md",key:w,style:{"font-size":"10px"}},[o("div",ue,[e(E,{dense:"",filled:"",label:"Item Name",modelValue:s.TLOCREQ_ITMCD,"onUpdate:modelValue":i=>s.TLOCREQ_ITMCD=i,"use-input":"","input-debounce":"500",options:u.value,onFilter:t[1]||(t[1]=(i,g,Q)=>T(i,g,Q,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:r.value,readonly:!0,"input-style":"font-size:11px"},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),o("div",ce,[e(E,{dense:"",filled:"",label:"Transfer From",modelValue:s.TLOCREQ_FRLOC,"onUpdate:modelValue":i=>s.TLOCREQ_FRLOC=i,"use-input":"","input-debounce":"500",options:_.value,onFilter:t[2]||(t[2]=(i,g,Q)=>T(i,g,Q,"loc")),behavior:"dialog","option-label":"MLOC_LOCNM","option-value":"MLOC_LOCCD","emit-value":"","map-options":"",loading:r.value,readonly:!0},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),o("div",me,[e(E,{dense:"",filled:"",label:"Transfer To",modelValue:s.TLOCREQ_TOLOC,"onUpdate:modelValue":i=>s.TLOCREQ_TOLOC=i,"use-input":"","input-debounce":"500",options:_.value,onFilter:t[3]||(t[3]=(i,g,Q)=>T(i,g,Q,"loc")),behavior:"dialog","option-label":"MLOC_LOCNM","option-value":"MLOC_LOCCD","emit-value":"","map-options":"",loading:r.value,readonly:!0},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),o("div",pe,[e(P,{label:"Qty",dense:"",filled:"",modelValue:s.TLOCREQ_QTY,"onUpdate:modelValue":i=>s.TLOCREQ_QTY=i},null,8,["modelValue","onUpdate:modelValue"])]),o("div",Ce,[e(z,{modelValue:s.TLOCREQ_ISREP,"onUpdate:modelValue":i=>s.TLOCREQ_ISREP=i,label:"Is replacement ?",color:"teal","true-value":1,"false-value":0,disable:!0},null,8,["modelValue","onUpdate:modelValue"])])]))),128)):W("",!0)])]),_:1}),e(X,{align:"right"},{default:l(()=>[e(V,{label:"approve",color:"primary",onClick:t[4]||(t[4]=s=>c()),loading:r.value},null,8,["loading"]),e(V,{flat:"",label:"Cancel",color:"red",onClick:A(H)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},fe={class:"q-pa-md"},Oe=o("div",{class:"row q-pb-md"},[o("div",{class:"col"},[o("span",{class:"text-h4"},"Transfer Request")]),o("div",{class:"col text-right"})],-1),ve={class:"row q-pt-md"},Te={class:"col"},ke={__name:"transferRequestIndex",setup(q){const h=Y(),O=m([]),v=m([{name:"TLOCREQ_DOCNO",label:"Doc Np",field:"TLOCREQ_DOCNO",sortable:!0,align:"left"},{name:"TLOCREQ_FRLOC",label:"From Location",field:"TLOCREQ_FRLOC",sortable:!0,align:"left"},{name:"TLOCREQ_TOLOC",label:"To Location",field:"TLOCREQ_TOLOC",sortable:!0,align:"left"},{name:"TLOCREQ_ISREP",label:"Is Replacement ?",field:"TLOCREQ_ISREP",sortable:!0,format:d=>`${d==1?"Yes":"No"}`,align:"left"}]),u=m(!1),_=m(""),f=m("");F(()=>{r()});const r=async()=>{u.value=!0,await D.post("inventory/transferRequest/searchAPI",{searchBy:_.value,searchValue:f.value}).then(d=>{u.value=!1,O.value=d.data.data}).catch(d=>{u.value=!1})},T=d=>{h.dialog({component:_e,componentProps:{dataHeader:d,dataDet:d.detail}}).onOk(async c=>{u.value=!1,onDialogOK()})},b=d=>{h.dialog({title:"Confirmation",message:"Are you sure want to print this transfer ?",cancel:!0,persistent:!0}).onOk(async()=>{u.value=!0,await D.post("inventory/printHandoverPDF",{data:btoa(d)}).then(c=>{u.value=!1,window.open("").document.write("<iframe width='100%' height='100%' src='data:application/pdf;base64, "+encodeURI(c.data)+"'></iframe>")}).catch(c=>{u.value=!1})})};return(d,c)=>(C(),R("div",fe,[Oe,e(G),o("div",ve,[o("div",Te,[e(j,{title:"Transfer Request List",rows:O.value,columns:v.value,"row-key":"TDLVORD_DLVCD",loading:u.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[e(E,{outlined:"",modelValue:_.value,"onUpdate:modelValue":c[0]||(c[0]=a=>_.value=a),options:v.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(P,{borderless:"",dense:"",modelValue:f.value,"onUpdate:modelValue":[c[1]||(c[1]=a=>f.value=a),c[2]||(c[2]=a=>d.getOutgoingData())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[e(J,{name:"search"})]),_:1},8,["modelValue"])]),header:l(a=>[e(x,{props:a},{default:l(()=>[(C(!0),R(k,null,M(a.cols,p=>(C(),I(N,{key:p.name,props:a},{default:l(()=>[L(y(p.label),1)]),_:2},1032,["props"]))),128)),e(N,{"auto-width":""},{default:l(()=>[L("Action")]),_:1})]),_:2},1032,["props"])]),body:l(a=>[e(x,{props:a},{default:l(()=>[(C(!0),R(k,null,M(a.cols,p=>(C(),I(U,{key:p.name,props:a},{default:l(()=>[L(y(p.value),1)]),_:2},1032,["props"]))),128)),e(U,{"auto-width":""},{default:l(()=>[e(V,{flat:"",color:a.row.TLOCREQ_APPRVBY!==null?"grey":"indigo",icon:"done_all",onClick:p=>T(a.row),dense:"",disable:a.row.TLOCREQ_APPRVBY!==null},{default:l(()=>[e(B,null,{default:l(()=>[L(y(a.row.TLOCREQ_APPRVBY!==null?"Request has been approved":"Approve All Data"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"]),e(V,{flat:"",color:a.row.TLOCREQ_APPRVBY!==null?"cyan":"grey",icon:"print",onClick:p=>b(a.row.TLOCREQ_DOCNO),dense:"",disable:a.row.TLOCREQ_APPRVBY===null},{default:l(()=>[e(B,null,{default:l(()=>[L(y(a.row.TLOCREQ_APPRVBY===null?"Please Aprove first":"Print handover request"),1)]),_:2},1024)]),_:2},1032,["color","onClick","disable"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{ke as default};
