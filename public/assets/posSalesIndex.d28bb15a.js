import{h as i,c as B,K as $,L as E,t as h,o as K,a as z,C as c,R as p,J as a,F as e,E as l,P as d,aI as F,Q as f,$ as j,S as k,T as x,U as H,D as T,V as U,I as u,av as M,O as G,M as J,W}from"./index.9b86ae71.js";import{a as v,b as w,Q as S}from"./QItemLabel.724c72cc.js";import{Q as X}from"./QBtnGroup.6545da82.js";import{Q as q}from"./QList.62f06fa3.js";import{Q as Y}from"./QBadge.a50dfa55.js";import{u as Z}from"./use-quasar.83f70ce9.js";import{api_web as ee}from"./axios.3b96d7c1.js";const te=[i("circle",{cx:"15",cy:"15",r:"15"},[i("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),i("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),i("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[i("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),i("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),i("circle",{cx:"105",cy:"15",r:"15"},[i("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),i("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])];var ae=B({name:"QSpinnerDots",props:$,setup(Q){const{cSize:r,classes:g}=E(Q);return()=>i("svg",{class:g.value,fill:"currentColor",width:r.value,height:r.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},te)}});const se={class:"q-pa-md"},le=a("div",{class:"row q-pb-md"},[a("div",{class:"col"},[a("span",{class:"text-h4"},"POS")]),a("div",{class:"col text-right"})],-1),oe={class:"row bg-grey q-pa-md full-width",style:{height:"86vh"}},ne={class:"col-4 q-pa-xs"},ie={class:"row bg-white"},re={class:"col",style:{height:"50vh",overflow:"auto"}},ce={class:"row q-pt-xs",style:{height:"30vh"}},de={class:"col bg-white vertical-middle"},ue={class:"row"},me={class:"col q-pa-sm",style:{height:"20vh"}},pe={class:"text-h6 text-bold"},ve={class:"row",style:{height:"10vh"}},_e={class:"col-sm-6 col-12 q-pa-sm"},he={class:"col-sm-6 col-12 q-pa-sm"},fe={class:"col q-pa-xs q-gutter-sm"},ge={class:"row bg-white",style:{height:"10vh",overflow:"auto"}},ye={class:"col"},we={class:"row bg-white",style:{height:"70vh",overflow:"auto"}},Ce={class:"col"},be={class:"row q-col-gutter-sm"},Se={class:"text-center"},Qe={class:"row items-center"},Ie={class:"col text-bold ellipsis"},ke={key:0,class:"row justify-center q-my-md"},xe={key:1,class:"row justify-center q-my-md"},Pe={__name:"posSalesIndex",setup(Q){const r=Z(),g=h([]),n=h([]),_=h(!1),C=h(0),I=h("");K(()=>{b("")});const L=z(()=>n.value.length>0?n.value.reduce((o,s)=>o+parseFloat(s.LATEST_PRC)*parseInt(s.sellQty),0):0),b=async o=>{_.value=!0,C.value=C.value+1,await ee.post("item/searchAPIStockAndPriceOnly",{searchValue:o,page:C.value}).then(s=>{_.value=!1,s.data.data.data.map(t=>{let m=n.value.findIndex(y=>y.MITM_ITMCD===t.MITM_ITMCD);console.log(m),m===-1&&g.value.push(t)})}).catch(()=>{_.value=!1})},A=(o,s)=>{r.dialog({dark:!0,title:"Prompt",message:"How many qty?",prompt:{model:0,type:"number",isValid:t=>t>0&&t<=n.value[s].STOCK},cancel:!0,persistent:!0}).onOk(t=>{n.value.push({...o,sellQty:t})}).onCancel(()=>{}).onDismiss(()=>{})},N=async(o,s)=>{await b(""),s()},O=o=>{b(o)},P=o=>{r.dialog({dark:!0,title:"Prompt",message:"How many qty?",prompt:{model:n.value[o].sellQty,type:"number",isValid:s=>s>0&&s<=n.value[o].STOCK},cancel:!0,persistent:!0}).onOk(s=>{n.value[o].sellQty=s})},V=o=>{r.dialog({title:"Confirmation",message:"Are you sure want to delete this line ??",cancel:!0,persistent:!0}).onOk(async()=>{n.value.splice(o,1)})},D=()=>{r.dialog({title:"Confirmation",message:"Are you sure want to cancel sales ??",cancel:!0,persistent:!0}).onOk(async()=>{n.value=[]})},R=()=>{r.dialog({title:"Confirmation",message:"Are you sure want to process this sales ??",cancel:!0,persistent:!0}).onOk(async()=>{n.value=[]})};return(o,s)=>(c(),p("div",se,[le,a("div",oe,[a("div",ne,[a("div",ie,[a("div",re,[e(q,{bordered:"",loading:_.value},{default:l(()=>[n.value.length>0?(c(!0),p(k,{key:0},x(n.value,(t,m)=>H((c(),T(S,{key:t.id,class:"q-my-sm"},{default:l(()=>[e(v,{avatar:""},{default:l(()=>[e(U,{color:"primary","text-color":"white",icon:"category"})]),_:1}),e(v,null,{default:l(()=>[e(w,null,{default:l(()=>[u(d(t.MITM_ITMNM),1)]),_:2},1024),e(w,{lines:"1"},{default:l(()=>[u(" Rp "+d(t.LATEST_PRC.toLocaleString())+" x "+d(t.sellQty.toLocaleString())+" = ",1),a("b",null,d((t.LATEST_PRC*t.sellQty).toLocaleString()),1)]),_:2},1024)]),_:2},1024),e(v,{side:""},{default:l(()=>[e(X,{flat:""},{default:l(()=>[e(f,{icon:"edit",color:"orange",onClick:y=>P(m),dense:""},null,8,["onClick"]),e(f,{icon:"delete",color:"red",onClick:y=>V(m),dense:""},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[W]])),128)):(c(),T(S,{key:1},{default:l(()=>[e(v,null,{default:l(()=>[u(" No item selected!! ")]),_:1})]),_:1}))]),_:1},8,["loading"])])]),a("div",ce,[a("div",de,[a("div",ue,[a("div",me,[a("div",pe," Total : Rp. "+d(L.value.toLocaleString()),1)])]),e(F),a("div",ve,[a("div",_e,[e(f,{color:"primary",class:"full-width",onClick:s[0]||(s[0]=t=>R())},{default:l(()=>[u(" Submit ")]),_:1})]),a("div",he,[e(f,{color:"red",class:"full-width",onClick:s[1]||(s[1]=t=>D())},{default:l(()=>[u(" Cancel ")]),_:1})])])])])]),a("div",fe,[a("div",ge,[a("div",ye,[e(j,{filled:"",modelValue:I.value,"onUpdate:modelValue":[s[2]||(s[2]=t=>I.value=t),s[3]||(s[3]=t=>O(t))],label:"Search Item",dense:"",debounce:1e3},null,8,["modelValue"])])]),a("div",we,[a("div",Ce,[a("div",be,[(c(!0),p(k,null,x(g.value,(t,m)=>(c(),p("div",{class:"col-6 q-pa-sm",key:`sm-${m}`},[e(J,{flat:"",bordered:""},{default:l(()=>[e(Y,{color:"orange",floating:""},{default:l(()=>[u(d(parseInt(t.STOCK-(t.sellQty?parseInt(t.sellQty):0)).toLocaleString()),1)]),_:2},1024),a("div",Se,[e(M,{name:"category",size:"8em"})]),e(G,null,{default:l(()=>[a("div",Qe,[a("div",Ie,d(t.MITM_ITMNM),1)])]),_:2},1024),e(q,null,{default:l(()=>[e(S,{clickable:"",onClick:y=>A(t,o.idx)},{default:l(()=>[e(v,{avatar:""},{default:l(()=>[e(M,{color:"primary",name:"add"})]),_:1}),e(v,null,{default:l(()=>[e(w,null,{default:l(()=>[u("Add Item")]),_:1}),e(w,{caption:"",lines:"2"},{default:l(()=>[u(" Rp. "+d(parseInt(t.LATEST_PRC).toLocaleString()),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))]),_.value?(c(),p("div",ke,[e(ae,{color:"primary",size:"40px"})])):(c(),p("div",xe,[e(f,{color:"primary",label:"Load more",onClick:N})]))])])])])]))}};export{Pe as default};
