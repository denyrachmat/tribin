import{s as u,B as f,C as I,D as e,E as a,J as U,K as p,I as t,Q as O,aW as y,H as r,ap as M,aY as W,R as x,aU as Q,aV as P,aZ as q,aX as i,P as A,M as F,O as Y,o as $,aa as X,S as Z}from"./index.2b377879.js";import{u as L,b as H,Q as B,j as k,k as c,l as b,c as z,a as G}from"./use-dialog-plugin-component.90559460.js";import{d as K}from"./date.37428cf0.js";import{api_web as E}from"./axios.dc90d955.js";import{Q as N}from"./QTooltip.af4104e9.js";const ee={class:"row"},ae=t("div",{class:"col"},[t("div",{class:"text-h6"},"Update Used Item")],-1),le={class:"col text-right"},te={__name:"serviceOprItemAdd",props:{dataItem:Array},setup(T){const{dialogRef:V,onDialogHide:h,onDialogOK:v,onDialogCancel:D}=L();H();const g=T,_=u([]),l=u([]),s=u(!1),o=()=>{l.value.push({TSRVD_ID:g.dataItem.id,TSRVF_ITMCD:"",TSRVF_PRC:0})},n=(d,m,S,w)=>{m(async()=>{w==="item"&&await C(d)})},C=async d=>{s.value=!0,await E.post("item/searchAPITBL",{searchValue:d}).then(m=>{s.value=!1,_.value=m.data.data}).catch(()=>{s.value=!1})};return(d,m)=>(f(),I(Y,{ref_key:"dialogRef",ref:V,onHide:F(h),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:e(()=>[a(U,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:e(()=>[a(p,null,{default:e(()=>[t("div",ee,[ae,t("div",le,[a(O,{icon:"add",outline:"",color:"blue",onClick:o})])])]),_:1}),a(p,{class:"q-pa-sm",style:{"max-height":"50vh"}},{default:e(()=>[a(B,{bordered:""},{default:e(()=>[l.value.length===0?y((f(),I(k,{key:0,class:"q-my-sm",clickable:""},{default:e(()=>[a(c,null,{default:e(()=>[r(" No items added ")]),_:1})]),_:1})),[[M]]):W("",!0),(f(!0),x(Q,null,P(l.value,(S,w)=>y((f(),I(k,{key:w,class:"q-my-sm",clickable:""},{default:e(()=>[a(c,{avatar:""},{default:e(()=>[a(q,{color:"primary","text-color":"white"},{default:e(()=>[r(i(w+1),1)]),_:2},1024)]),_:2},1024),a(c,null,{default:e(()=>[a(b,null,{default:e(()=>[a(z,{dense:"",filled:"",label:"Item Name",modelValue:S.TSRVF_ITMCD,"onUpdate:modelValue":R=>S.TSRVF_ITMCD=R,"use-input":"","input-debounce":"500",options:_.value,onFilter:m[0]||(m[0]=(R,j,J)=>n(R,j,J,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMCD","emit-value":"","map-options":"",loading:s.value},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024),a(c,null,{default:e(()=>[a(A,{label:"Price",modelValue:S.TSRVF_PRC,"onUpdate:modelValue":R=>S.TSRVF_PRC=R,filled:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)),[[M]])),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}},oe={class:"text-h6"},se={__name:"serviceOprUpdateOrder",props:{header:Array,detail:Array},setup(T){const{dialogRef:V,onDialogHide:h,onDialogOK:v,onDialogCancel:D}=L(),g=H(),_=T,l=u({SRVH_DOCNO:"",SRVH_ISSDT:K.formatDate(Date.now(),"YYYY-MM-DD"),SRVH_CUSCD:""}),s=u([]);$(async()=>{_.header&&(l.value=_.header,s.value=_.detail)});const o=n=>{g.dialog({component:te,componentProps:{dataItem:n}}).onOk(async C=>{console.log(C)})};return(n,C)=>(f(),I(Y,{ref_key:"dialogRef",ref:V,onHide:F(h),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:e(()=>[a(U,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:e(()=>[a(p,null,{default:e(()=>[t("div",oe,"Update Order "+i(l.value.SRVH_DOCNO),1)]),_:1}),a(p,{class:"q-pa-sm"},{default:e(()=>[a(B,{bordered:""},{default:e(()=>[(f(!0),x(Q,null,P(s.value,(d,m)=>y((f(),I(k,{key:m,class:"q-my-sm",clickable:""},{default:e(()=>[a(c,{avatar:""},{default:e(()=>[a(q,{color:"primary","text-color":"white"},{default:e(()=>[r(i(d.TSRVD_LINE),1)]),_:2},1024)]),_:2},1024),a(c,null,{default:e(()=>[a(b,null,{default:e(()=>[r(i(d.TSRVD_ITMCD),1)]),_:2},1024),a(b,{caption:"",lines:"1"},{default:e(()=>[r("Item")]),_:1})]),_:2},1024),a(c,null,{default:e(()=>[a(b,null,{default:e(()=>[r(i(d.TSRVD_CUSTRMK),1)]),_:2},1024),a(b,{caption:"",lines:"1"},{default:e(()=>[r("Customer Remarks")]),_:1})]),_:2},1024),a(c,{side:""},{default:e(()=>[a(O,{icon:"construction",color:"green",flat:"",onClick:S=>o(d)},{default:e(()=>[a(N,null,{default:e(()=>[r("Update Fix Data")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),a(c,{side:""},{default:e(()=>[a(O,{icon:"visibility",color:"cyan",flat:"",onClick:C[0]||(C[0]=S=>n.viewAddedItem()),disable:!d.listFixDet},{default:e(()=>[a(N,null,{default:e(()=>[r("View Added Item")]),_:1})]),_:2},1032,["disable"])]),_:2},1024)]),_:2},1024)),[[M]])),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}},ne={class:"q-pa-md"},de={class:"row"},ie={class:"col"},re={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},ce={class:"text-h5 text-bold"},ue={class:"text-h6 text-bold"},_e={class:"text-subtitle2"},me={class:"text-h6 text-bold"},fe=t("div",{class:"text-subtitle2"},"Resolved Items",-1),pe={class:"row"},Se={class:"col"},he=t("div",{class:"col text-right"},null,-1),Re={__name:"serviceOprView",setup(T){const V=H();u([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:l=>l.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:l=>l.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const h=u([]),v=u(""),D=u(!1);$(()=>{g()});const g=async()=>{D.value=!0,await E.post("servicesOPR/search",{searchBy:"",searchValue:v.value}).then(l=>{D.value=!1,h.value=l.data.data}).catch(l=>{D.value=!1})},_=l=>{const s={SRVH_DOCNO:l.SRVH_DOCNO,SRVH_ISSDT:K.formatDate(l.SRVH_ISSDT,"YYYY-MM-DD"),SRVH_CUSCD:l.MCUS_CUSCD};let o=[];l.detail.map(n=>{o.push({TSRVD_ITMCD:n.TSRVD_ITMCD,TSRVD_LINE:n.TSRVD_LINE,TSRVD_QTY:n.TSRVD_QTY,TSRVD_CUSTRMK:n.TSRVD_CUSTRMK})}),V.dialog({component:se,componentProps:{header:s,detail:o}}).onOk(async n=>{g()})};return(l,s)=>(f(),x("div",ne,[t("div",de,[t("div",ie,[a(G,{grid:"",flat:"",bordered:"","card-container-class":l.cardContainerClass,title:"Outstanding Order",rows:h.value,columns:l.columns,"row-key":"name",filter:v.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":l.rowsPerPageOptions,loading:D.value},{"top-right":e(()=>[a(A,{borderless:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=o=>v.value=o),placeholder:"Search"},{append:e(()=>[a(X,{name:"search"})]),_:1},8,["modelValue"])]),item:e(o=>[t("div",re,[a(U,{flat:"",bordered:""},{default:e(()=>[a(p,{class:"text-center bg-secondary text-white"},{default:e(()=>[t("div",ce,i(o.row.SRVH_DOCNO),1)]),_:2},1024),a(Z),a(p,null,{default:e(()=>[t("div",ue,i(o.row.MCUS_CUSNM),1),t("div",_e,i(o.row.SRVH_ISSDT),1)]),_:2},1024),a(p,null,{default:e(()=>[t("div",me,i(o.row.resolve.length)+" of "+i(o.row.unresolve.length),1),fe]),_:2},1024),a(p,null,{default:e(()=>[t("div",pe,[t("div",Se,[a(O,{label:"Resolve",color:"primary",outline:"",onClick:n=>_(o.row)},null,8,["onClick"])]),he])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{Re as default};
