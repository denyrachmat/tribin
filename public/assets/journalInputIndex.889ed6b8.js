import{t as c,o as U,C as m,D as V,E as a,F as e,M as B,O as w,J as l,$ as f,at as F,U as N,Q as g,R as T,S as H,T as L,P as y,X as j,Y as M,Z as J,aM as K,I}from"./index.9d3e151d.js";import{e as q}from"./QSelect.3ecc382e.js";import{u as X,a as Z,b as k}from"./QTable.a30592ed.js";import{Q as E,a as Q}from"./QTd.3668a0b6.js";import{Q as z}from"./QTooltip.4c1b303f.js";import{u as x}from"./format.7a9943a6.js";import{api_web as O}from"./axios.a3133970.js";import{Q as W}from"./QBtnToggle.29003590.js";import{Q as ee,a as le,C as ae}from"./ClosePopup.87b2a25a.js";import"./QBtnGroup.fee78e27.js";import"./use-render-cache.3aae9b27.js";import"./date.b32a460f.js";const oe=l("div",{class:"text-h6"},"Closing Period",-1),te={style:{border:"1px black solid","border-radius":"10px"}},se=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Header")],-1),ne={class:"row q-col-gutter-sm"},de={class:"col-12 col-sm-6"},ie={class:"row q-col-gutter-sm"},ue={class:"col-12 col-sm-6"},re={class:"col-12 col-sm-6"},ce={class:"row items-center justify-end"},me={style:{border:"1px black solid","border-radius":"10px"}},pe=l("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[l("b",null,"Detail")],-1),_e={class:"row q-col-gutter-sm q-pt-sm"},Ce={class:"col-12 col-sm-6 text-right"},ve={class:"col-12 col-sm-3"},fe={class:"col-12 col-sm-3"},ge={class:"col-12 col-sm-3"},Te={class:"col-12 col-sm-3"},be={key:1,class:"row q-col-gutter-sm q-pt-sm"},he={class:"col-12"},Se={__name:"journalInputCreate",props:{header:String},setup(G){const S=x(),t=c({GLHIST_ACC:"",GLHIST_DOC:"",GLHIST_EFFDT:"",MCOA_TYPE:"INC"}),p=c([]),d=c(!1),b=c([]),_=G;U(async()=>{_.header&&_.header!==""&&console.log(_.header)});const{dialogRef:h,onDialogHide:A,onDialogOK:i,onDialogCancel:u}=X(),s=(v,n,o,D)=>{n(async()=>{D==="coa"&&await C(v)})},C=async(v,n="MCOA_COACD")=>{d.value=!0,await O.post("coa/searchAPI",{searchValue:v,searchCol:n}).then(o=>{d.value=!1,b.value=o.data.data}).catch(()=>{d.value=!1})},P=()=>{p.value.push({GLHIST_ACC:t.value.GLHIST_ACC,GLHIST_DOC:t.value.GLHIST_DOC,GLHIST_AMT:0,GLHIST_DESC:"",GLHIST_EFFDT:t.value.GLHIST_EFFDT,MCOA_TYPE:t.value.MCOA_TYPE})},$=()=>{S.dialog({title:"Confirmation",message:"Are you sure want to save this journal ?",cancel:!0,persistent:!0}).onOk(async()=>{d.value=!0,await O.post("acc/journal",{...t.value,det:p.value}).then(v=>{d.value=!1,S.notify({color:"green",message:`${v.data.msg}`}),i()}).catch(v=>{d.value=!1})})};return(v,n)=>(m(),V(J,{ref_key:"dialogRef",ref:h,onHide:M(A),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:a(()=>[e(B,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(w,null,{default:a(()=>[oe]),_:1}),e(w,{class:"q-pa-sm"},{default:a(()=>[l("fieldset",te,[se,l("div",ne,[l("div",de,[e(W,{modelValue:t.value.MCOA_TYPE,"onUpdate:modelValue":n[0]||(n[0]=o=>t.value.MCOA_TYPE=o),spread:"",class:"my-custom-toggle","no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Income",value:"INC"},{label:"Expense",value:"OUT"}]},null,8,["modelValue"])])]),l("div",ie,[l("div",ue,[e(f,{filled:"",label:"Doc Reference",modelValue:t.value.GLHIST_DOC,"onUpdate:modelValue":n[1]||(n[1]=o=>t.value.GLHIST_DOC=o),readonly:""},null,8,["modelValue"])]),l("div",re,[e(f,{filled:"",modelValue:t.value.GLHIST_EFFDT,"onUpdate:modelValue":n[3]||(n[3]=o=>t.value.GLHIST_EFFDT=o),label:"Eff Date"},{prepend:a(()=>[e(F,{name:"event",class:"cursor-pointer"},{default:a(()=>[e(ee,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:a(()=>[e(le,{modelValue:t.value.GLHIST_EFFDT,"onUpdate:modelValue":n[2]||(n[2]=o=>t.value.GLHIST_EFFDT=o),mask:"YYYY-MM-DD"},{default:a(()=>[l("div",ce,[N(e(g,{label:"Close",color:"primary",flat:""},null,512),[[ae]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])]),l("fieldset",me,[pe,l("div",_e,[l("div",Ce,[e(g,{flat:"",color:"primary",icon:"add",onClick:P})])]),p.value.length>0?(m(!0),T(H,{key:0},L(p.value,(o,D)=>(m(),T("div",{class:"row q-col-gutter-sm q-pt-sm",key:D},[l("div",ve,[e(q,{filled:"",label:"Account Code",modelValue:o.GLHIST_ACC,"onUpdate:modelValue":r=>o.GLHIST_ACC=r,"use-input":"","input-debounce":"500",options:b.value,onFilter:n[4]||(n[4]=(r,R,Y)=>s(r,R,Y,"coa")),behavior:"dialog","option-label":"MCOA_COANM","option-value":"MCOA_COACD","emit-value":"","map-options":"",loading:d.value,dense:""},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),l("div",fe,[e(f,{filled:"",label:"Valuta",modelValue:o.GLHIST_CURR,"onUpdate:modelValue":r=>o.GLHIST_CURR=r},null,8,["modelValue","onUpdate:modelValue"])]),l("div",ge,[e(f,{filled:"",label:"Description",modelValue:o.GLHIST_DESC,"onUpdate:modelValue":r=>o.GLHIST_DESC=r},null,8,["modelValue","onUpdate:modelValue"])]),l("div",Te,[e(f,{filled:"",label:"Amount",modelValue:o.GLHIST_AMT,"onUpdate:modelValue":r=>o.GLHIST_AMT=r},null,8,["modelValue","onUpdate:modelValue"])])]))),128)):(m(),T("div",be,[l("div",he," Click + button to add "+y(t.value.MCOA_TYPE==="INC"?"Income":"Expense"),1)]))])]),_:1}),e(j,{align:"right"},{default:a(()=>[e(g,{label:"OK",color:"primary",onClick:n[5]||(n[5]=o=>$()),disable:v.stateSubmit,loading:d.value},null,8,["disable","loading"]),e(g,{flat:"",label:"Cancel",color:"red",onClick:M(u)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},Ie={class:"q-pa-md"},Ae={class:"row q-pb-md"},De=l("div",{class:"col"},[l("span",{class:"text-h4"},"Journal Input")],-1),Ve={class:"col text-right"},He={class:"row q-pt-md"},Le={class:"col"},Pe={__name:"journalInputIndex",setup(G){const S=x(),t=c("DOCCD"),p=c(""),d=c([]),b=c([{name:"GLHIST_ACC",label:"COA Code",field:"GLHIST_ACC",sortable:!0,align:"left"},{name:"MCOA_COANM",label:"COA Desc",field:"MCOA_COANM",sortable:!0,align:"left"},{name:"GLHIST_DESC",label:"Description",field:"GLHIST_DESC",sortable:!0,align:"left"},{name:"CURR",label:"Valuta",field:"CURR",sortable:!0,align:"left"},{name:"GLHIST_AMT_DB",label:"Amount",field:"GLHIST_AMT_DB",sortable:!0,format:i=>i.toLocaleString(),align:"left"},{name:"GLHIST_AMT_CR",label:"Amount",field:"GLHIST_AMT_CR",sortable:!0,format:i=>i.toLocaleString(),align:"left"}]),_=c(!1);U(()=>{h()});const h=async()=>{_.value=!0,await O.post("acc/journal/searchAPI",{searchBy:t.value,searchValue:p.value}).then(i=>{_.value=!1,d.value=i.data.data}).catch(i=>{_.value=!1})},A=(i=null)=>{S.dialog({component:Se}).onOk(async u=>{h()})};return(i,u)=>(m(),T("div",Ie,[l("div",Ae,[De,l("div",Ve,[e(g,{icon:"add",color:"primary",onClick:u[0]||(u[0]=s=>A())})])]),e(K),l("div",He,[l("div",Le,[e(Z,{title:"Journal History",rows:d.value,columns:b.value,"row-key":"name",loading:_.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":a(()=>[e(q,{outlined:"",modelValue:t.value,"onUpdate:modelValue":u[1]||(u[1]=s=>t.value=s),options:b.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),e(f,{borderless:"",dense:"",modelValue:p.value,"onUpdate:modelValue":[u[2]||(u[2]=s=>p.value=s),u[3]||(u[3]=s=>h())],placeholder:"Search",outlined:"",debounce:"1000"},{append:a(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"])]),header:a(s=>[e(E,{props:s},{default:a(()=>[e(k,{"auto-width":""},{default:a(()=>[I("Action")]),_:1}),(m(!0),T(H,null,L(s.cols,C=>(m(),V(k,{key:C.name,props:s},{default:a(()=>[I(y(C.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(s=>[e(E,{props:s},{default:a(()=>[e(Q,{"auto-width":""},{default:a(()=>[e(g,{flat:"",color:"orange",icon:"edit",onClick:C=>i.onClickEdit(s.row.TQUO_QUOCD),dense:""},{default:a(()=>[e(z,null,{default:a(()=>[I("Journal Edit")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),(m(!0),T(H,null,L(s.cols,C=>(m(),V(Q,{key:C.name,props:s},{default:a(()=>[I(y(C.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Pe as default};
