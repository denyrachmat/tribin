import{s as d,o as Q,B as n,C as T,D as a,E as o,J as D,K as m,b0 as N,L as M,Q as A,M as w,O as R,I as l,P as x,aa as q,a$ as u,S as L,R as _,aY as C,aZ as O,b4 as H,H as I}from"./index.9d829338.js";import{u as $,b as S,a as E,o as V}from"./use-dialog-plugin-component.8d28c430.js";import{d as K,Q as U,b as G}from"./date.6654b590.js";import{api_web as B}from"./axios.3341694d.js";const J=l("div",{class:"text-h6"},"Review Item List",-1),z={__name:"viewListApprovalItem",props:{cd:String,typeCD:String},setup(P){const{dialogRef:h,onDialogHide:p,onDialogOK:y,onDialogCancel:f}=$();S();const i=P,g=d(!1),b=d([{name:"MITM_ITMNM",label:"Item Name",field:"MITM_ITMNM",sortable:!0,align:"left"},{name:"TQUODETA_USAGE_DESCRIPTION",label:"Usage",field:"TQUODETA_USAGE_DESCRIPTION",sortable:!0,align:"left"},{name:"TQUODETA_PRC",label:"Price",field:"TQUODETA_PRC",sortable:!0,align:"left",format:e=>e.toLocaleString("en-US",{style:"currency",currency:"USD"})},{name:"TQUODETA_OPRPRC",label:"Operator",field:"TQUODETA_OPRPRC",sortable:!0,align:"left",format:e=>e.toLocaleString("en-US",{style:"currency",currency:"USD"})},{name:"TQUODETA_MOBDEMOB",label:"MOB DEMOB",field:"TQUODETA_MOBDEMOB",sortable:!0,align:"left",format:e=>e.toLocaleString("en-US",{style:"currency",currency:"USD"})},{name:"SUBTOT",label:"MOB DEMOB",sortable:!0,field:e=>e.TQUODETA_PRC+e.TQUODETA_OPRPRC+e.TQUODETA_MOBDEMOB,align:"left",format:e=>e.toLocaleString("en-US",{style:"currency",currency:"USD"})}]),c=d([]);Q(()=>{v()});const v=async()=>{await B.get(`${i.typeCD}/${btoa(i.cd)}`).then(e=>{g.value=!1,c.value=e.data}).catch(e=>{g.value=!1})};return(e,t)=>(n(),T(R,{ref_key:"dialogRef",ref:h,onHide:w(p),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[o(D,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[o(m,null,{default:a(()=>[J]),_:1}),o(m,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[i.typeCD=="quotation"?(n(),T(E,{key:0,title:"Item List",rows:c.value.dataItem,columns:b.value,"row-key":"name",dense:""},null,8,["rows","columns"])):N("",!0)]),_:1}),o(M,{align:"center"},{default:a(()=>[o(A,{label:"OK",color:"primary",onClick:t[0]||(t[0]=r=>w(y)()),disable:e.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},j=l("div",{class:"text-h6"},"Approval List",-1),F={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Y={class:"text-h5 text-bold"},Z={class:"text-h6 text-bold"},W={class:"text-subtitle2"},X={class:"row"},ee={class:"col"},te={class:"col text-right"},ae={__name:"viewListApproval",props:{listApprv:Array,typeAPI:String},setup(P){const h=S(),p=P,y=d([{name:"APP_CD",label:"Doc Code",field:"APP_CD"},{name:"APP_CUSNM",label:"Customer",field:"APP_CUSNM"},{name:"APP_SBJCT",label:"Subject",field:"APP_SBJCT"},{name:"APP_ATTN",label:"Attn",field:"APP_ATTN"},{name:"CREATED_AT",label:"Created Date",field:"CREATED_AT"}]),f=d(""),i=(t,r="days")=>{const s=new Date,k=new Date(t);return K.getDateDiff(s,k,r)},g=t=>{let r="";p.typeAPI=="quot"?r="quotation":p.typeAPI=="pr"?r="purchase-request-approval":p.typeAPI=="po"&&(r="purchase-order/approval-document"),h.dialog({component:z,componentProps:{cd:t,typeCD:r}}).onOk(async s=>{quotationGroupConditions.value=s.MCONDITION_RPT_STAT,quotationConditions.value=s.group})},{dialogRef:b,onDialogHide:c,onDialogOK:v,onDialogCancel:e}=$();return(t,r)=>(n(),T(R,{ref_key:"dialogRef",ref:b,onHide:w(c),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[o(D,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[o(m,null,{default:a(()=>[j]),_:1}),o(m,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[o(E,{grid:"",flat:"",bordered:"","card-container-class":t.cardContainerClass,title:"Outstanding Approval",rows:p.listApprv,columns:y.value,"row-key":"name",filter:f.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":t.rowsPerPageOptions},{"top-right":a(()=>[o(x,{borderless:"",dense:"",debounce:"300",modelValue:f.value,"onUpdate:modelValue":r[0]||(r[0]=s=>f.value=s),placeholder:"Search"},{append:a(()=>[o(q,{name:"search"})]),_:1},8,["modelValue"])]),item:a(s=>[l("div",F,[o(D,{flat:"",bordered:""},{default:a(()=>[o(m,{class:"text-center bg-secondary text-white"},{default:a(()=>[l("div",Y,u(s.row.APP_CUSNM),1)]),_:2},1024),o(L),o(m,null,{default:a(()=>[l("div",Z,u(s.row.APP_CD),1),l("div",W,u(s.row.APP_SBJCT),1)]),_:2},1024),o(m,null,{default:a(()=>[l("div",X,[l("div",ee,[o(A,{label:"Preview",color:"primary",outline:"",onClick:k=>g(s.row.APP_CD)},null,8,["onClick"])]),l("div",te,u(i(s.row.CREATED_AT)<30?`${i(s.row.CREATED_AT)} Days Ago`:`${i(s.row.CREATED_AT,"months")} Month ago`),1)])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options"])]),_:1}),o(M,{align:"right"},{default:a(()=>[o(A,{label:"OK",color:"primary",onClick:r[1]||(r[1]=s=>w(v)()),disable:t.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},oe={class:"q-pa-md bg-grey-5 window-height"},le={class:"row"},se={class:"row"},ne={class:"col"},re={class:"text-h3 text-cyan"},ie={class:"text-subtitle2 text-cyan"},ce={class:"col text-right"},ue={class:"row q-pa-sm"},de={class:"col"},pe={key:1},Te={__name:"dashboardView",setup(P){const h=S(),p=d([{total:900,title:"Total Sales",icon:"shopping_cart",color:"cyan"},{total:900,title:"Total Purchase",icon:"shopping_bag",color:"cyan"},{total:900,title:"Total Profit",icon:"payments",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"}]),y=d([{name:"name",label:"Business",field:"name",sortable:!0,align:"left"},{name:"quot",label:"Quotation",field:"quot_count",sortable:!0,align:"center"},{name:"pr",label:"Purchase Request",field:"pr_count",sortable:!0,align:"center"},{name:"po",label:"Purchase Order",field:"po_count",sortable:!0,align:"center"}]),f=d([]),i=d(!1);d(null),Q(async()=>{await g()});const g=async()=>{i.value=!0,await B.get("/approval/notificationsAPI/top-user").then(c=>{i.value=!1,f.value=c.data}).catch(c=>{i.value=!1})},b=(c,v)=>{h.dialog({component:ae,componentProps:{listApprv:c,typeAPI:v}}).onOk(async e=>{quotationGroupConditions.value=e.MCONDITION_RPT_STAT,quotationConditions.value=e.group})};return(c,v)=>(n(),_("div",oe,[l("div",le,[(n(!0),_(C,null,O(p.value,(e,t)=>(n(),_("div",{class:H("col-3 q-pa-sm"),key:t},[o(D,null,{default:a(()=>[o(m,null,{default:a(()=>[l("div",se,[l("div",ne,[l("div",re,u(e.total),1),l("div",ie,u(e.title),1)]),l("div",ce,[o(q,{name:e.icon,size:"4.4em",color:e.color},null,8,["name","color"])])])]),_:2},1024)]),_:2},1024)]))),128))]),l("div",ue,[l("div",de,[o(E,{flat:"",bordered:"",title:"Approval List",rows:f.value,columns:y.value,"row-key":"name",loading:i.value},{"top-right":a(()=>[o(A,{flat:"",icon:"refresh",color:"cyan",onClick:g})]),header:a(e=>[o(U,{props:e},{default:a(()=>[(n(!0),_(C,null,O(e.cols,t=>(n(),T(V,{key:t.name,props:e},{default:a(()=>[I(u(t.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(e=>[o(U,{props:e},{default:a(()=>[(n(!0),_(C,null,O(e.cols,t=>(n(),T(G,{key:t.name,props:e},{default:a(()=>[t.name==="quot"||t.name==="pr"||t.name==="po"||t.name==="spk"?(n(),_(C,{key:0},[t.value>0?(n(),T(A,{key:0,flat:"",color:"blue",onClick:r=>b(e.row[t.name.split("_")[0]],t.name)},{default:a(()=>[l("b",null,u(t.value),1)]),_:2},1032,["onClick"])):(n(),_("span",pe,u(t.value),1))],64)):(n(),_(C,{key:1},[I(u(t.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Te as default};
