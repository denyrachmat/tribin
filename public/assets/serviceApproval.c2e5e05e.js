import{s as v,o as H,B as f,C as h,D as e,E as a,L as $,M as m,T as N,H as n,V as L,P as M,R as A,S as U,bc as P,U as q,O as c,I as o,Q as S,W as B,X as Q,Y as F,Z as j,am as E,aX as K}from"./index.6e3cc70d.js";import{a as I,u as Y,Q as G,b as T,c as u,d as _,k as X}from"./QTable.b18f0a13.js";import{api_web as R}from"./axios.918b3aaa.js";import{Q as z}from"./QTooltip.5bfa7bbd.js";import{_ as W}from"./serviceOprItemAdd.1c9e530a.js";const Z=o("div",{class:"text-h6"},"View List Price",-1),J=["innerHTML"],ee={class:"row"},ae={class:"col"},le={class:"col text-right"},te={__name:"serviceApprovalDetView",props:{idHeader:String},setup(V){const b=I(),{dialogRef:w,onDialogHide:g,onDialogOK:p,onDialogCancel:C}=Y(),D=V,t=v([]),l=v(!1);H(()=>{r()});const r=async()=>{l.value=!0,await R.get(`servicesAdmins/viewUnapproveMgrDet/${btoa(D.idHeader.SRVH_DOCNO)}`).then(i=>{l.value=!1,t.value=i.data}).catch(i=>{l.value=!1})},k=i=>{let d=0;return i.map(s=>{d+=s.TSRVF_QTY*s.TSRVF_PRC}),d},O=i=>{i.listFixDet=i.list_fix_det,b.dialog({component:W,componentProps:{mode:"view",dataItem:i}}).onOk(async d=>{})},y=(i=!1)=>{b.dialog({title:`${i?"Approval Message Confirmation":"Rejection Message Confirmation"}`,message:`Please add message before ${i?"approve":"reject"} this service.`,cancel:!0,persistent:!0,prompt:{model:"",type:"text"}}).onOk(async d=>{l.value=!0,await R.put(`servicesAdmins/updateByDet/${btoa(D.idHeader.id)}`,{TSRVD_FLGSTS:1}).then(s=>{l.value=!1,p()}).catch(s=>{l.value=!1})})};return(i,d)=>(f(),h(F,{ref_key:"dialogRef",ref:w,onHide:Q(g),"transition-show":"slide-up","transition-hide":"slide-down","full-width":""},{default:e(()=>[a($,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:e(()=>[a(m,null,{default:e(()=>[Z]),_:1}),a(m,{class:"q-pa-sm"},{default:e(()=>[a(G,{bordered:"",loading:l.value},{default:e(()=>[t.value.length===0?N((f(),h(T,{key:0,class:"q-my-sm",clickable:""},{default:e(()=>[l.value?(f(),h(u,{key:1},{default:e(()=>[n("Please wait, loading data... ")]),_:1})):(f(),h(u,{key:0},{default:e(()=>[n(" No items added ")]),_:1}))]),_:1})),[[L]]):(f(!0),M(A,{key:1},U(t.value,(s,x)=>(f(),h(T,{key:x,class:P("q-my-sm")},{default:e(()=>[a(u,{avatar:""},{default:e(()=>[a(q,{color:s.TSRVD_FLGSTS===0?"red":"primary","text-color":"white"},{default:e(()=>[n(c(x+1),1)]),_:2},1032,["color"])]),_:2},1024),a(u,null,{default:e(()=>[a(_,null,{default:e(()=>[n(c(s.TSRVD_ITMCD),1)]),_:2},1024),a(_,{caption:""},{default:e(()=>[n(" Item ")]),_:1})]),_:2},1024),a(u,null,{default:e(()=>[a(_,null,{default:e(()=>[n(c(s.TSRVD_QTY),1)]),_:2},1024),a(_,{caption:""},{default:e(()=>[n(" Qty ")]),_:1})]),_:2},1024),a(u,null,{default:e(()=>[a(_,null,{default:e(()=>[o("div",{innerHTML:s.TSRVD_REMARK},null,8,J)]),_:2},1024),a(_,{caption:""},{default:e(()=>[n(" Remarks ")]),_:1})]),_:2},1024),a(u,null,{default:e(()=>[a(_,null,{default:e(()=>[n("Rp. "+c(k(s.list_fix_det).toLocaleString()),1)]),_:2},1024),a(_,{caption:""},{default:e(()=>[n(" Total Fix Price ")]),_:1})]),_:2},1024),a(u,{side:""},{default:e(()=>[a(S,{icon:"visibility",flat:"",color:"primary",onClick:pe=>O(s)},{default:e(()=>[a(z,null,{default:e(()=>[n("View list fix items")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["loading"])]),_:1}),a(B,null,{default:e(()=>[o("div",ee,[o("div",ae,[a(S,{label:"Approve",color:"primary",onClick:d[0]||(d[0]=s=>y(!0)),disable:l.value,loading:l.value},null,8,["disable","loading"]),a(S,{flat:"",label:"Reject",color:"red",onClick:d[1]||(d[1]=s=>y(!0)),loading:l.value},null,8,["loading"])]),o("div",le,[a(S,{label:"Cancel",color:"red",onClick:Q(C),disable:l.value,loading:l.value,flat:""},null,8,["onClick","disable","loading"])])])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},oe={class:"q-pa-md"},se={class:"row"},ie={class:"col"},ne={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},re={class:"text-h5 text-bold"},de={class:"text-h6 text-bold"},ce={class:"text-subtitle2"},ue={class:"text-h6 text-bold"},_e=o("div",{class:"text-subtitle2"},"Resolved Items",-1),fe={class:"row"},ve={class:"col"},we={__name:"serviceApproval",setup(V){const b=I();v([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"MCUS_CUSNM",label:"Customer Name",field:"MCUS_CUSNM",sortable:!0,align:"left"},{name:"resolve",label:"Resolved Line",sortable:!0,align:"left",field:t=>t.resolve.length},{name:"unresolve",label:"Unresolved Line",sortable:!0,align:"left",field:t=>t.unresolve.length},{name:"SRVH_ISSDT",label:"Submited Date",field:"SRVH_ISSDT",sortable:!0,align:"left"}]);const w=v([]),g=v(""),p=v(!1);v(null),H(()=>{C()});const C=async()=>{p.value=!0,await R.get("servicesAdmins/listUnapproveMgr").then(t=>{p.value=!1,w.value=t.data}).catch(t=>{p.value=!1})},D=t=>{b.dialog({component:te,componentProps:{idHeader:t}}).onOk(async l=>{C()})};return(t,l)=>(f(),M("div",oe,[o("div",se,[o("div",ie,[a(X,{grid:"",flat:"",bordered:"","card-container-class":t.cardContainerClass,title:"Approve Service Pricing",rows:w.value,columns:t.columns,"row-key":"name",filter:g.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":t.rowsPerPageOptions,loading:p.value},{"top-right":e(()=>[a(j,{borderless:"",dense:"",debounce:"300",modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=r=>g.value=r),placeholder:"Search"},{append:e(()=>[a(E,{name:"search"})]),_:1},8,["modelValue"])]),item:e(r=>[o("div",ne,[a($,{flat:"",bordered:""},{default:e(()=>[a(m,{class:P("text-center bg-green text-white")},{default:e(()=>[o("div",re,c(r.row.SRVH_DOCNO),1)]),_:2},1024),a(K),a(m,null,{default:e(()=>[o("div",de,c(r.row.MCUS_CUSNM),1),o("div",ce,c(r.row.SRVH_ISSDT),1)]),_:2},1024),a(m,null,{default:e(()=>[o("div",ue,c(r.row.resolve.length)+" of "+c(r.row.detail.length),1),_e]),_:2},1024),a(m,null,{default:e(()=>[o("div",fe,[o("div",ve,[a(S,{color:"primary",label:"View Data",onClick:k=>D(r.row)},null,8,["onClick"])])])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options","loading"])])])]))}};export{we as default};
