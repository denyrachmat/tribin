import{Q as k}from"./QTooltip.d3503419.js";import{s as c,B as u,C as f,D as l,E as a,J as K,K as H,I as o,P as b,aa as x,aW as T,Q as m,R as h,aU as y,aV as I,aZ as j,H as r,aX as O,ap as F,L as J,M as N,O as W,o as X,S as Z}from"./index.5510f7e8.js";import{u as z,b as Y,Q as G,j as U,k as Q,l as M,c as A,a as ee,m as P}from"./use-dialog-plugin-component.ca705b1f.js";import{Q as q,a as $}from"./date.31787f55.js";import{api_web as R}from"./axios.6ca37ef3.js";import{Q as ae,a as le,C as te}from"./ClosePopup.e84a7df9.js";const oe=o("div",{class:"text-h6"},"Create Order",-1),se={style:{border:"1px black solid","border-radius":"10px"}},ne=o("legend",{style:{"margin-left":"1em",padding:"0.2em 0.8em"}},[o("b",null,"Header")],-1),de={class:"row"},ie={class:"col"},ue={class:"col q-pl-md"},re={class:"row items-center justify-end"},ce={class:"row"},me={class:"col"},_e={style:{border:"1px black solid","border-radius":"10px",height:"35vh",overflow:"auto"}},pe={style:{"margin-left":"1em",padding:"0.2em 0.8em"}},fe=o("b",null,"Detail Items",-1),ve={class:"row"},Ce={class:"col text-right"},ge={__name:"serviceCreateOrder",setup(B){const{dialogRef:V,onDialogHide:_,onDialogOK:v,onDialogCancel:C}=z();Y();const n=c({SRVH_DOCNO:"",SRVH_ISSDT:"",SRVH_CUSCD:""}),d=c([]),g=(s,e,t,p)=>{e(async()=>{p==="cust"&&await S(s),p==="item"&&await D(s)})},S=async s=>{loading.value=!0,await R.post("customer/searchAPI",{searchValue:s}).then(e=>{loading.value=!1,listCustomers.value=e.data.data}).catch(()=>{loading.value=!1})},D=async s=>{loading.value=!0,await R.post("item/searchAPI",{searchValue:s}).then(e=>{loading.value=!1,d.value=e.data.data}).catch(()=>{loading.value=!1})},i=()=>{d.value.push({TSRVD_ITMCD:"",TSRVD_LINE:d.value.length+1})};return(s,e)=>(u(),f(W,{ref_key:"dialogRef",ref:V,onHide:N(_),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:l(()=>[a(K,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:l(()=>[a(H,null,{default:l(()=>[oe]),_:1}),a(H,{class:"q-pa-sm"},{default:l(()=>[o("fieldset",se,[ne,o("div",de,[o("div",ie,[a(b,{label:"SPK No",readonly:"",dense:"",modelValue:n.value.SRVH_DOCNO,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value.SRVH_DOCNO=t),filled:""},null,8,["modelValue"])]),o("div",ue,[a(b,{filled:"",modelValue:n.value.SRVH_ISSDT,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.SRVH_ISSDT=t),dense:"",label:"Issue Date",loading:s.loading,onClick:e[3]||(e[3]=t=>s.quotationIssueDate.qDateProxy.show()),mask:"####-##-##","fill-mask":"",hint:"Mask: YYYY-MM-DD"},{append:l(()=>[a(x,{name:"event",class:"cursor-pointer"},{default:l(()=>[a(ae,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:l(()=>[a(le,{modelValue:n.value.SRVH_ISSDT,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.SRVH_ISSDT=t),mask:"YYYY-MM-DD"},{default:l(()=>[o("div",re,[T(a(m,{label:"Close",color:"primary",flat:""},null,512),[[te]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","loading"])])]),o("div",ce,[o("div",me,[a(b,{label:"Customer Choose",dense:"",modelValue:n.value.SRVH_CUSCD,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.SRVH_CUSCD=t),filled:""},null,8,["modelValue"])])])]),o("fieldset",_e,[o("legend",pe,[fe,o("div",ve,[o("div",Ce,[a(m,{flat:"",icon:"add",color:"blue",onClick:e[5]||(e[5]=t=>i())})])]),a(G,{bordered:"",dense:""},{default:l(()=>[d.value.length>0?(u(!0),h(y,{key:0},I(d.value,(t,p)=>(u(),f(U,{key:p,class:"q-my-sm",dense:""},{default:l(()=>[a(Q,{avatar:""},{default:l(()=>[a(j,{"text-color":"blue"},{default:l(()=>[r(O(p+1),1)]),_:2},1024)]),_:2},1024),a(Q,null,{default:l(()=>[a(M,null,{default:l(()=>[a(A,{dense:"",filled:"",label:"Item Name",modelValue:t.item,"onUpdate:modelValue":w=>t.item=w,"use-input":"","input-debounce":"500",options:d.value,onFilter:e[6]||(e[6]=(w,L,E)=>g(w,L,E,"item")),behavior:"dialog","option-label":"MITM_ITMNM","option-value":"MITM_ITMNM","emit-value":"","map-options":"",loading:s.loading},null,8,["modelValue","onUpdate:modelValue","options","loading"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):T((u(),f(U,{key:1,class:"q-my-sm",clickable:""},{default:l(()=>[a(Q,null,{default:l(()=>[a(M,null,{default:l(()=>[r(" No Items Added ")]),_:1})]),_:1})]),_:1})),[[F]])]),_:1})])])]),_:1}),a(J,{align:"right"},{default:l(()=>[a(m,{label:"OK",color:"primary",onClick:e[7]||(e[7]=t=>s.onSubmitData()),disable:s.stateSubmit},null,8,["disable"]),a(m,{flat:"",label:"Cancel",color:"red",onClick:N(C)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}};const be={class:"q-pa-md"},he={class:"row q-pb-md"},Ve=o("div",{class:"col"},[o("span",{class:"text-h4"},"Receive Order ")],-1),Se={class:"col text-right"},De={class:"row q-pt-md"},we={class:"col"},He={__name:"serviceView",setup(B){const V=Y(),_=c("SRVH_DOCNO"),v=c(""),C=c([]),n=c([{name:"SRVH_DOCNO",label:"SPK No",field:"SRVH_DOCNO",sortable:!0,align:"left"},{name:"SRVH_CUSCD",label:"Cust",field:"SRVH_CUSCD",sortable:!0,align:"left"},{name:"created_at",label:"Created Date",field:"created_at",sortable:!0,align:"left"}]),d=c(!1);X(()=>{g()});const g=async()=>{d.value=!0,await R.post("service/search",{searchBy:_.value,searchValue:v.value}).then(i=>{d.value=!1,C.value=i.data.data}).catch(i=>{d.value=!1})},S=()=>{V.dialog({component:ge}).onOk(async i=>{g()})},D=i=>{window.open("https://joss.jatpowerindo.co.id/PDF/quotation/"+btoa(i),"_blank").focus()};return(i,s)=>(u(),h("div",be,[o("div",he,[Ve,o("div",Se,[a(m,{icon:"add",color:"blue",onClick:S},{default:l(()=>[a(k,null,{default:l(()=>[r("Create New Order")]),_:1})]),_:1})])]),a(Z),o("div",De,[o("div",we,[a(ee,{title:"Created Order",rows:C.value,columns:n.value,"row-key":"name",loading:d.value,dense:"",pagination:{rowsPerPage:20},class:"my-sticky-header-column-table"},{"top-right":l(()=>[a(A,{outlined:"",modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=e=>_.value=e),options:n.value,label:"Search Columns","option-value":"name","option-label":"label","emit-value":"",dense:"","map-options":""},null,8,["modelValue","options"]),a(b,{borderless:"",dense:"",modelValue:v.value,"onUpdate:modelValue":[s[1]||(s[1]=e=>v.value=e),s[2]||(s[2]=e=>i.dataQuo())],placeholder:"Search",outlined:"",debounce:"1000"},{append:l(()=>[a(x,{name:"search"})]),_:1},8,["modelValue"])]),header:l(e=>[a(q,{props:e},{default:l(()=>[(u(!0),h(y,null,I(e.cols,t=>(u(),f(P,{key:t.name,props:e},{default:l(()=>[r(O(t.label),1)]),_:2},1032,["props"]))),128)),a(P,{"auto-width":""},{default:l(()=>[r("Action")]),_:1})]),_:2},1032,["props"])]),body:l(e=>[a(q,{props:e},{default:l(()=>[(u(!0),h(y,null,I(e.cols,t=>(u(),f($,{key:t.name,props:e},{default:l(()=>[r(O(t.value),1)]),_:2},1032,["props"]))),128)),a($,{"auto-width":""},{default:l(()=>[a(m,{flat:"",color:"orange",icon:"edit",onClick:t=>i.onClickEdit(e.row.TQUO_QUOCD),dense:""},{default:l(()=>[a(k,null,{default:l(()=>[r("Edit this quotation")]),_:1})]),_:2},1032,["onClick"]),a(m,{flat:"",color:"indigo",icon:"print",onClick:t=>D(e.row.TQUO_QUOCD),dense:""},{default:l(()=>[a(k,null,{default:l(()=>[r("Print this order")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{He as default};
