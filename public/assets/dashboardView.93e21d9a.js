import{s as u,o as R,B as i,C as T,D as a,E as e,J as w,K as g,b0 as N,L as M,Q as v,M as O,O as q,I as s,P as U,aa as $,a$ as d,S as L,R as f,aY as A,aZ as k,b4 as H,H as Q}from"./index.646ce5e8.js";import{u as B,b as E,a as I,c as V,q as G}from"./use-dialog-plugin-component.bf35631f.js";import{d as J,Q as S,b as K}from"./date.ebd6a4b6.js";import{api_web as x}from"./axios.14c4c616.js";const j=s("div",{class:"text-h6"},"Review Item List",-1),z={__name:"viewListApprovalItem",props:{cd:String,typeCD:String},setup(P){const{dialogRef:b,onDialogHide:_,onDialogOK:D,onDialogCancel:m}=B();E();const r=P,p=u(!1),C=u([{name:"MITM_ITMNM",label:"Item Name",field:"MITM_ITMNM",sortable:!0,align:"left"},{name:"TQUODETA_USAGE_DESCRIPTION",label:"Usage",field:"TQUODETA_USAGE_DESCRIPTION",sortable:!0,align:"left"},{name:"TQUODETA_PRC",label:"Price",field:"TQUODETA_PRC",sortable:!0,align:"left",format:t=>t.toLocaleString()},{name:"TQUODETA_OPRPRC",label:"Operator",field:"TQUODETA_OPRPRC",sortable:!0,align:"left",format:t=>t.toLocaleString()},{name:"TQUODETA_MOBDEMOB",label:"MOB DEMOB",field:"TQUODETA_MOBDEMOB",sortable:!0,align:"left",format:t=>t.toLocaleString()},{name:"SUBTOT",label:"MOB DEMOB",sortable:!0,field:t=>t.TQUODETA_PRC+t.TQUODETA_OPRPRC+t.TQUODETA_MOBDEMOB,align:"left",format:t=>t.toLocaleString()}]),c=u([]);R(()=>{h()});const h=async()=>{p.value=!0,await x.get(`${r.typeCD}/${btoa(r.cd)}`).then(t=>{p.value=!1,c.value=t.data}).catch(t=>{p.value=!1})},n=()=>{},o=()=>{};return(t,l)=>(i(),T(q,{ref_key:"dialogRef",ref:b,onHide:O(_),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[e(w,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(g,null,{default:a(()=>[j]),_:1}),e(g,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[r.typeCD=="quotation"?(i(),T(I,{key:0,title:"Item List",rows:c.value.dataItem,columns:C.value,"row-key":"name",dense:"",loading:p.value},null,8,["rows","columns","loading"])):N("",!0)]),_:1}),e(M,{align:"center"},{default:a(()=>[e(V,null,{default:a(()=>[e(v,{color:"primary",icon:"check",label:"Approve",disable:c.value.length>0,onClick:l[0]||(l[0]=y=>n())},null,8,["disable"]),e(v,{color:"red",icon:"cancel",label:"Reject",disable:c.value.length>0,onClick:l[1]||(l[1]=y=>o())},null,8,["disable"]),e(v,{color:"orange",flat:"",label:"cancel",onClick:O(m)},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["onHide"]))}},F=s("div",{class:"text-h6"},"Approval List",-1),Y={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Z={class:"text-h5 text-bold"},W={class:"text-h6 text-bold"},X={class:"text-subtitle2"},ee={class:"row"},te={class:"col"},ae={class:"col text-right"},oe={__name:"viewListApproval",props:{listApprv:Array,typeAPI:String},setup(P){const b=E(),_=P,D=u([{name:"APP_CD",label:"Doc Code",field:"APP_CD"},{name:"APP_CUSNM",label:"Customer",field:"APP_CUSNM"},{name:"APP_SBJCT",label:"Subject",field:"APP_SBJCT"},{name:"APP_ATTN",label:"Attn",field:"APP_ATTN"},{name:"CREATED_AT",label:"Created Date",field:"CREATED_AT"}]),m=u(""),r=(o,t="days")=>{const l=new Date,y=new Date(o);return J.getDateDiff(l,y,t)},p=o=>{let t="";_.typeAPI=="quot"?t="quotation":_.typeAPI=="pr"?t="purchase-request-approval":_.typeAPI=="po"&&(t="purchase-order/approval-document"),b.dialog({component:z,componentProps:{cd:o,typeCD:t}}).onOk(async l=>{quotationGroupConditions.value=l.MCONDITION_RPT_STAT,quotationConditions.value=l.group})},{dialogRef:C,onDialogHide:c,onDialogOK:h,onDialogCancel:n}=B();return(o,t)=>(i(),T(q,{ref_key:"dialogRef",ref:C,onHide:O(c),"transition-show":"slide-up","transition-hide":"slide-down","full-width":"",persistent:""},{default:a(()=>[e(w,{class:"q-dialog-plugin bg-white q-pa-sm"},{default:a(()=>[e(g,null,{default:a(()=>[F]),_:1}),e(g,{class:"q-pa-sm",style:{height:"70vh",overflow:"auto"}},{default:a(()=>[e(I,{grid:"",flat:"",bordered:"","card-container-class":o.cardContainerClass,title:"Outstanding Approval",rows:_.listApprv,columns:D.value,"row-key":"name",filter:m.value,"hide-header":"",pagination:{rowsPerPage:50},"rows-per-page-options":o.rowsPerPageOptions},{"top-right":a(()=>[e(U,{borderless:"",dense:"",debounce:"300",modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),placeholder:"Search"},{append:a(()=>[e($,{name:"search"})]),_:1},8,["modelValue"])]),item:a(l=>[s("div",Y,[e(w,{flat:"",bordered:""},{default:a(()=>[e(g,{class:"text-center bg-secondary text-white"},{default:a(()=>[s("div",Z,d(l.row.APP_CUSNM),1)]),_:2},1024),e(L),e(g,null,{default:a(()=>[s("div",W,d(l.row.APP_CD),1),s("div",X,d(l.row.APP_SBJCT),1)]),_:2},1024),e(g,null,{default:a(()=>[s("div",ee,[s("div",te,[e(v,{label:"Preview",color:"primary",outline:"",onClick:y=>p(l.row.APP_CD)},null,8,["onClick"])]),s("div",ae,d(r(l.row.CREATED_AT)<30?`${r(l.row.CREATED_AT)} Days Ago`:`${r(l.row.CREATED_AT,"months")} Month ago`),1)])]),_:2},1024)]),_:2},1024)])]),_:1},8,["card-container-class","rows","columns","filter","rows-per-page-options"])]),_:1}),e(M,{align:"right"},{default:a(()=>[e(v,{label:"OK",color:"primary",onClick:t[1]||(t[1]=l=>O(h)()),disable:o.stateSubmit},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["onHide"]))}},le={class:"q-pa-md bg-grey-5 window-height"},ne={class:"row"},se={class:"row"},ie={class:"col"},re={class:"text-h3 text-cyan"},ce={class:"text-subtitle2 text-cyan"},de={class:"col text-right"},ue={class:"row q-pa-sm"},pe={class:"col"},_e={key:1},Te={__name:"dashboardView",setup(P){const b=E(),_=u([{total:900,title:"Total Sales",icon:"shopping_cart",color:"cyan"},{total:900,title:"Total Purchase",icon:"shopping_bag",color:"cyan"},{total:900,title:"Total Profit",icon:"payments",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"},{total:15,title:"Total Customer",icon:"group",color:"cyan"}]),D=u([{name:"name",label:"Business",field:"name",sortable:!0,align:"left"},{name:"quot",label:"Quotation",field:"quot_count",sortable:!0,align:"center"},{name:"pr",label:"Purchase Request",field:"pr_count",sortable:!0,align:"center"},{name:"po",label:"Purchase Order",field:"po_count",sortable:!0,align:"center"}]),m=u([]),r=u(!1);u(null),R(async()=>{await p()});const p=async()=>{r.value=!0,await x.get("/approval/notificationsAPI/top-user").then(c=>{r.value=!1,m.value=c.data}).catch(c=>{r.value=!1})},C=(c,h)=>{b.dialog({component:oe,componentProps:{listApprv:c,typeAPI:h}}).onOk(async n=>{quotationGroupConditions.value=n.MCONDITION_RPT_STAT,quotationConditions.value=n.group})};return(c,h)=>(i(),f("div",le,[s("div",ne,[(i(!0),f(A,null,k(_.value,(n,o)=>(i(),f("div",{class:H("col-3 q-pa-sm"),key:o},[e(w,null,{default:a(()=>[e(g,null,{default:a(()=>[s("div",se,[s("div",ie,[s("div",re,d(n.total),1),s("div",ce,d(n.title),1)]),s("div",de,[e($,{name:n.icon,size:"4.4em",color:n.color},null,8,["name","color"])])])]),_:2},1024)]),_:2},1024)]))),128))]),s("div",ue,[s("div",pe,[e(I,{flat:"",bordered:"",title:"Approval List",rows:m.value,columns:D.value,"row-key":"name",loading:r.value},{"top-right":a(()=>[e(v,{flat:"",icon:"refresh",color:"cyan",onClick:p})]),header:a(n=>[e(S,{props:n},{default:a(()=>[(i(!0),f(A,null,k(n.cols,o=>(i(),T(G,{key:o.name,props:n},{default:a(()=>[Q(d(o.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:a(n=>[e(S,{props:n},{default:a(()=>[(i(!0),f(A,null,k(n.cols,o=>(i(),T(K,{key:o.name,props:n},{default:a(()=>[o.name==="quot"||o.name==="pr"||o.name==="po"||o.name==="spk"?(i(),f(A,{key:0},[o.value>0?(i(),T(v,{key:0,flat:"",color:"blue",onClick:t=>C(n.row[o.name.split("_")[0]],o.name)},{default:a(()=>[s("b",null,d(o.value),1)]),_:2},1032,["onClick"])):(i(),f("span",_e,d(o.value),1))],64)):(i(),f(A,{key:1},[Q(d(o.value),1)],64))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading"])])])]))}};export{Te as default};
